{"ast":null,"code":"var _jsxFileName = \"C:\\\\CA\\\\Billing\\\\dev\\\\billing-pks\\\\src\\\\InventoryPanel.jsx\",\n  _s = $RefreshSig$();\n// src/InventoryPanel.jsx\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { apiGetInventory, apiSuggestNames, apiAddItem, apiAddPurchase } from \"./api\";\nimport \"./InventoryPanel.css\";\n\n// Format number as Indian currency (for display only)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst toINR = n => Number(n || 0).toLocaleString(\"en-IN\", {\n  maximumFractionDigits: 2\n});\nexport default function InventoryPanel() {\n  _s();\n  // ==============================\n  // 0. TAB STATE\n  // ==============================\n  const [activeTab, setActiveTab] = useState(\"purchase\"); // \"purchase\" | \"item\"\n\n  // ==============================\n  // 1. INVENTORY GRID (items table)\n  // ==============================\n  const [rows, setRows] = useState([]);\n\n  // ==============================\n  // 2. ADD ITEM FORM (items table)\n  // ==============================\n  const [name, setName] = useState(\"\");\n  const [groupName, setGroupName] = useState(\"\");\n  const [hsnCode, setHsnCode] = useState(\"\");\n  const [suggest, setSuggest] = useState([]);\n  const debRef = useRef();\n\n  // ==============================\n  // 3. PURCHASE CONTEXT\n  // ==============================\n  const [pDate, setPDate] = useState(() => new Date().toISOString().slice(0, 10));\n  const [pBill, setPBill] = useState(\"\");\n  const [pParty, setPParty] = useState(\"\"); // Party Name\n  const [pGstNo, setPGstNo] = useState(\"\"); // GST Number (GSTIN)\n  const [pGst, setPGst] = useState(\"\"); // GST Number (GSTIN)\n\n  // ==============================\n  // 4. PURCHASE LINES\n  // ==============================\n  const makeEmptyLine = () => ({\n    item: \"\",\n    qty: \"\",\n    purchase_state: \"\",\n    purchase_price: \"\",\n    purchase_discount: \"\",\n    // ✅ NEW: discount amount\n    gst: pGst || \"18\",\n    // selling GST\n    price: \"\" // selling price\n  });\n  const [lines, setLines] = useState([makeEmptyLine()]);\n  const [pSuggest, setPSuggest] = useState([]);\n  const pDebRef = useRef();\n\n  // ------------------------------\n  // Initial load of inventory from DB\n  // ------------------------------\n  useEffect(() => {\n    apiGetInventory().then(setRows).catch(() => {});\n  }, []);\n\n  // ------------------------------\n  // Keep new line GST in sync with context GST\n  // (only updates the trailing empty line's GST)\n  // ------------------------------\n  useEffect(() => {\n    setLines(prev => {\n      if (!prev.length) return [makeEmptyLine()];\n      const next = [...prev];\n      const lastIdx = next.length - 1;\n      const last = next[lastIdx] || {};\n      const isLastFilled = (last.item || \"\").trim() !== \"\" || (last.qty || \"\") !== \"\" || (last.purchase_state || \"\") !== \"\" || (last.purchase_price || \"\") !== \"\" || (last.purchase_discount || \"\") !== \"\" || (last.gst || \"\") !== \"\" || (last.price || \"\") !== \"\";\n      if (!isLastFilled) {\n        next[lastIdx] = {\n          ...last,\n          gst: pGst || \"18\"\n        };\n      }\n      return next;\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pGst]);\n\n  // ------------------------------\n  // Suggestions for \"Add Item\"\n  // ------------------------------\n  useEffect(() => {\n    clearTimeout(debRef.current);\n    debRef.current = setTimeout(async () => {\n      if (!name) {\n        setSuggest([]);\n        return;\n      }\n      try {\n        setSuggest(await apiSuggestNames(name, 25));\n      } catch {\n        // ignore\n      }\n    }, 180);\n    return () => clearTimeout(debRef.current);\n  }, [name]);\n\n  // ------------------------------\n  // Suggestions for purchase lines\n  // ------------------------------\n  const fetchItemSuggestions = q => {\n    clearTimeout(pDebRef.current);\n    pDebRef.current = setTimeout(async () => {\n      if (!q) {\n        setPSuggest([]);\n        return;\n      }\n      try {\n        setPSuggest(await apiSuggestNames(q, 25));\n      } catch {\n        // ignore\n      }\n    }, 180);\n  };\n\n  // ------------------------------\n  // Add new item (with Group + HSN)\n  // ------------------------------\n  const addItem = async () => {\n    const n = (name || \"\").trim();\n    const g = (groupName || \"\").trim();\n    const h = (hsnCode || \"\").trim();\n    if (!n) return alert(\"Enter item name\");\n    if (!g) return alert(\"Enter item group\");\n    try {\n      await apiAddItem(n, h, g);\n      const fresh = await apiGetInventory();\n      setRows(fresh);\n      setName(\"\");\n      setGroupName(\"\");\n      setHsnCode(\"\");\n      setSuggest([]);\n    } catch (e) {\n      alert(\"Error while adding item:\\n\" + e);\n    }\n  };\n\n  // ------------------------------\n  // Update a field within one purchase line\n  // ------------------------------\n  const updateLine = (idx, key, val) => {\n    setLines(prev => {\n      const next = [...prev];\n      const row = {\n        ...next[idx]\n      };\n\n      // For numeric-ish fields, allow only digits and dot\n      const numericKeys = [\"qty\", \"purchase_price\", \"purchase_discount\", \"gst\", \"price\"];\n      if (numericKeys.includes(key)) {\n        val = String(val).replace(/[^0-9.]/g, \"\");\n      }\n      row[key] = val;\n      next[idx] = row;\n      return next;\n    });\n    if (key === \"item\") fetchItemSuggestions(val);\n  };\n\n  // ------------------------------\n  // Ensure there is always a trailing empty row\n  // ------------------------------\n  const ensureTrailingEmptyRow = () => {\n    setLines(prev => {\n      const last = prev[prev.length - 1] || {};\n      const isLastFilled = (last.item || \"\").trim() !== \"\" || (last.qty || \"\") !== \"\" || (last.purchase_state || \"\") !== \"\" || (last.purchase_price || \"\") !== \"\" || (last.purchase_discount || \"\") !== \"\" || (last.gst || \"\") !== \"\" || (last.price || \"\") !== \"\";\n      return isLastFilled ? [...prev, makeEmptyLine()] : prev;\n    });\n  };\n\n  // ------------------------------\n  // Called after purchase_price is entered (blur/Enter)\n  // (kept same behavior as your original)\n  // ------------------------------\n  const onPurchasePriceDone = idx => {\n    const r = lines[idx] || {};\n    if ((r.item || \"\").trim() && Number(r.qty) > 0) {\n      ensureTrailingEmptyRow();\n      setTimeout(() => {\n        const el = document.getElementById(`pitem-${idx + 1}`);\n        el === null || el === void 0 ? void 0 : el.focus();\n      }, 0);\n    }\n  };\n\n  // ------------------------------\n  // Remove a purchase line row\n  // ------------------------------\n  const removeLine = idx => {\n    setLines(prev => {\n      const next = prev.filter((_, i) => i !== idx);\n      return next.length ? next : [makeEmptyLine()];\n    });\n  };\n\n  // ------------------------------\n  // Reset purchase context\n  // ------------------------------\n  const resetPurchaseContext = () => {\n    setPDate(new Date().toISOString().slice(0, 10));\n    setPBill(\"\");\n    setPParty(\"\");\n    setPGstNo(\"\");\n  };\n\n  // ------------------------------\n  // SUBMIT ALL PURCHASE LINES\n  // ------------------------------\n  const submitAllPurchases = async () => {\n    if (!pBill.trim()) return alert(\"Enter Purchase Bill No.\");\n    const payloads = lines.map(l => {\n      const item_name = (l.item || \"\").trim();\n      const qty = Number(l.qty);\n\n      // discount amount: stored by reducing purchase_price (no backend change needed)\n      const gross = l.purchase_price === \"\" ? null : Number(l.purchase_price);\n      const disc = l.purchase_discount === \"\" ? 0 : Number(l.purchase_discount);\n      const netPurchase = gross === null ? null : Math.max(0, (gross || 0) - (disc || 0));\n      return {\n        item_name,\n        qty,\n        // purchase fields\n        purchase_state: (l.purchase_state || \"\").trim() || null,\n        purchase_price: netPurchase,\n        // selling fields\n        gst_percent: l.gst === \"\" ? null : Number(l.gst),\n        selling_price: l.price === \"\" ? null : Number(l.price),\n        // context fields\n        date: pDate,\n        bill_no: pBill,\n        party_name: (pParty || \"\").trim() || null,\n        gst_no: (pGstNo || \"\").trim() || null\n      };\n    }).filter(p => p.item_name && Number.isFinite(p.qty) && p.qty > 0);\n    if (!payloads.length) return alert(\"Add at least one valid line.\");\n    try {\n      for (const p of payloads) {\n        // eslint-disable-next-line no-await-in-loop\n        await apiAddPurchase(p);\n      }\n      const fresh = await apiGetInventory();\n      setRows(fresh);\n      setLines([makeEmptyLine()]);\n    } catch (e) {\n      alert(\"Error while saving purchases:\\n\" + e);\n    }\n  };\n\n  // ==============================\n  // RENDER\n  // ==============================\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inv-tabs\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: activeTab === \"purchase\" ? \"inv-tab active\" : \"inv-tab\",\n        onClick: () => setActiveTab(\"purchase\"),\n        children: \"Add Purchase\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: activeTab === \"item\" ? \"inv-tab active\" : \"inv-tab\",\n        onClick: () => setActiveTab(\"item\"),\n        children: \"Add Item\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 7\n    }, this), activeTab === \"purchase\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"small\",\n        style: {\n          marginBottom: 6\n        },\n        children: \"Add Purchase (updates stock & logs in purchases table)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"grid\",\n          gridTemplateColumns: \"1fr 1fr 1fr 140px auto\",\n          gap: 12,\n          alignItems: \"end\",\n          marginBottom: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Date of Purchase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: pDate,\n            onChange: e => setPDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Purchase Bill No.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: pBill,\n            onChange: e => setPBill(e.target.value),\n            placeholder: \"PB/1234\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Party Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: pParty,\n            onChange: e => setPParty(e.target.value),\n            placeholder: \"Supplier / Party name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"GST No\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: pGstNo,\n            onChange: e => setPGstNo(e.target.value.toUpperCase()),\n            placeholder: \"33ABCDE1234F1Z5\",\n            maxLength: 15\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stack\",\n          style: {\n            alignSelf: \"end\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: resetPurchaseContext,\n            children: \"Reset\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"table\", {\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 36\n                },\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Item (from items table)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 110\n                },\n                children: \"Quantity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 394,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 130\n                },\n                children: \"Purchase State\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 140\n                },\n                children: \"Purchase Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 120\n                },\n                children: \"Discount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 110\n                },\n                children: \"GST %\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 140\n                },\n                children: \"Selling Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                style: {\n                  width: 60\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: [lines.map((r, i) => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: i + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  id: `pitem-${i}`,\n                  list: \"inv-suggest-purchase\",\n                  value: r.item,\n                  onChange: e => updateLine(i, \"item\", e.target.value),\n                  placeholder: \"Start typing to search\\u2026\",\n                  autoComplete: \"off\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 410,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 409,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.qty,\n                  onChange: e => updateLine(i, \"qty\", e.target.value),\n                  placeholder: \"0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.purchase_state,\n                  onChange: e => updateLine(i, \"purchase_state\", e.target.value.toUpperCase()),\n                  placeholder: \"00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 429,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.purchase_price,\n                  onChange: e => updateLine(i, \"purchase_price\", e.target.value),\n                  placeholder: \"0.00\",\n                  onBlur: () => onPurchasePriceDone(i),\n                  onKeyDown: e => {\n                    if (e.key === \"Enter\") onPurchasePriceDone(i);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 443,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.purchase_discount,\n                  onChange: e => updateLine(i, \"purchase_discount\", e.target.value),\n                  placeholder: \"0.00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 457,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.gst,\n                  onChange: e => updateLine(i, \"gst\", e.target.value),\n                  placeholder: \"18\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 467,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: r.price,\n                  onChange: e => updateLine(i, \"price\", e.target.value),\n                  placeholder: \"0.00\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 474,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"center\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn\",\n                  onClick: () => removeLine(i),\n                  title: \"Remove row\",\n                  children: \"\\u2715\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 483,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 21\n              }, this)]\n            }, `line-${i}`, true, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: /*#__PURE__*/_jsxDEV(\"td\", {\n                colSpan: 9,\n                className: \"small\",\n                children: [\"Tip: After entering \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Purchase Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 496,\n                  columnNumber: 41\n                }, this), \", press\", \" \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Enter\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 497,\n                  columnNumber: 21\n                }, this), \" to create the next row automatically.\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n          id: \"inv-suggest-purchase\",\n          children: pSuggest.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: s.name\n          }, s.name, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stack\",\n          style: {\n            marginTop: 10\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn primary\",\n            onClick: submitAllPurchases,\n            children: \"Add Purchase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 9\n    }, this), activeTab === \"item\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Add New Item (or select existing)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            list: \"inv-suggest\",\n            value: name,\n            onChange: e => setName(e.target.value),\n            placeholder: \"e.g., TMT BARS 8MM JSW TMT\",\n            autoComplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n            id: \"inv-suggest\",\n            children: suggest.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: s.name\n            }, s.name, false, {\n              fileName: _jsxFileName,\n              lineNumber: 534,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Group\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: groupName,\n            onChange: e => setGroupName(e.target.value),\n            placeholder: \"e.g., TMT, MS, CHANNEL, ANGLE\",\n            autoComplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 541,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"HSN Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: hsnCode,\n            onChange: e => setHsnCode(e.target.value.replace(/[^\\d]/g, \"\")),\n            placeholder: \"e.g., 7214\",\n            inputMode: \"numeric\",\n            autoComplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 551,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stack\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn primary\",\n            onClick: addItem,\n            children: \"Add Item\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: async () => setRows(await apiGetInventory()),\n            children: \"Reload from DB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 522,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                width: 40\n              },\n              children: \"#\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 580,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Item\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"GST %\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 582,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Unit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 583,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"HSN Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Price\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 585,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Stock\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 586,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 579,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: [rows.map((r, i) => {\n            var _ref, _r$GST, _ref2, _r$HSNCODE;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: i + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 592,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r[\"ITEM NAME\"] || r[\"ITEM NAM\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 593,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: Number((_ref = (_r$GST = r[\"GST %\"]) !== null && _r$GST !== void 0 ? _r$GST : r[\"GST\"]) !== null && _ref !== void 0 ? _ref : 0)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 594,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r[\"UNIT\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 595,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (_ref2 = (_r$HSNCODE = r[\"HSN CODE\"]) !== null && _r$HSNCODE !== void 0 ? _r$HSNCODE : r[\"HSN\"]) !== null && _ref2 !== void 0 ? _ref2 : \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 596,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: toINR(r[\"PRICE\"])\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 597,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: toINR(r[\"STOCK QTY\"])\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 598,\n                columnNumber: 17\n              }, this)]\n            }, `${r.ID || r[\"ITEM NAME\"]}-${i}`, true, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 15\n            }, this);\n          }), rows.length === 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 7,\n              className: \"center small\",\n              children: \"No items\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 603,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 602,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 308,\n    columnNumber: 5\n  }, this);\n}\n_s(InventoryPanel, \"GW4mMfwG1rV9Tr7OEyzXYdxpskA=\");\n_c = InventoryPanel;\nvar _c;\n$RefreshReg$(_c, \"InventoryPanel\");","map":{"version":3,"names":["React","useEffect","useRef","useState","apiGetInventory","apiSuggestNames","apiAddItem","apiAddPurchase","jsxDEV","_jsxDEV","toINR","n","Number","toLocaleString","maximumFractionDigits","InventoryPanel","_s","activeTab","setActiveTab","rows","setRows","name","setName","groupName","setGroupName","hsnCode","setHsnCode","suggest","setSuggest","debRef","pDate","setPDate","Date","toISOString","slice","pBill","setPBill","pParty","setPParty","pGstNo","setPGstNo","pGst","setPGst","makeEmptyLine","item","qty","purchase_state","purchase_price","purchase_discount","gst","price","lines","setLines","pSuggest","setPSuggest","pDebRef","then","catch","prev","length","next","lastIdx","last","isLastFilled","trim","clearTimeout","current","setTimeout","fetchItemSuggestions","q","addItem","g","h","alert","fresh","e","updateLine","idx","key","val","row","numericKeys","includes","String","replace","ensureTrailingEmptyRow","onPurchasePriceDone","r","el","document","getElementById","focus","removeLine","filter","_","i","resetPurchaseContext","submitAllPurchases","payloads","map","l","item_name","gross","disc","netPurchase","Math","max","gst_percent","selling_price","date","bill_no","party_name","gst_no","p","isFinite","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","style","marginTop","marginBottom","display","gridTemplateColumns","gap","alignItems","type","value","onChange","target","placeholder","toUpperCase","maxLength","alignSelf","width","id","list","autoComplete","onBlur","onKeyDown","title","colSpan","s","inputMode","_ref","_r$GST","_ref2","_r$HSNCODE","ID","_c","$RefreshReg$"],"sources":["C:/CA/Billing/dev/billing-pks/src/InventoryPanel.jsx"],"sourcesContent":["// src/InventoryPanel.jsx\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  apiGetInventory,\r\n  apiSuggestNames,\r\n  apiAddItem,\r\n  apiAddPurchase,\r\n} from \"./api\";\r\nimport \"./InventoryPanel.css\";\r\n\r\n// Format number as Indian currency (for display only)\r\nconst toINR = (n) =>\r\n  Number(n || 0).toLocaleString(\"en-IN\", { maximumFractionDigits: 2 });\r\n\r\nexport default function InventoryPanel() {\r\n  // ==============================\r\n  // 0. TAB STATE\r\n  // ==============================\r\n  const [activeTab, setActiveTab] = useState(\"purchase\"); // \"purchase\" | \"item\"\r\n\r\n  // ==============================\r\n  // 1. INVENTORY GRID (items table)\r\n  // ==============================\r\n  const [rows, setRows] = useState([]);\r\n\r\n  // ==============================\r\n  // 2. ADD ITEM FORM (items table)\r\n  // ==============================\r\n  const [name, setName] = useState(\"\");\r\n  const [groupName, setGroupName] = useState(\"\");\r\n  const [hsnCode, setHsnCode] = useState(\"\");\r\n  const [suggest, setSuggest] = useState([]);\r\n  const debRef = useRef();\r\n\r\n  // ==============================\r\n  // 3. PURCHASE CONTEXT\r\n  // ==============================\r\n  const [pDate, setPDate] = useState(() =>\r\n    new Date().toISOString().slice(0, 10)\r\n  );\r\n  const [pBill, setPBill] = useState(\"\");\r\n  const [pParty, setPParty] = useState(\"\"); // Party Name\r\n  const [pGstNo, setPGstNo] = useState(\"\"); // GST Number (GSTIN)\r\n    const [pGst, setPGst] = useState(\"\"); // GST Number (GSTIN)\r\n\r\n\r\n  // ==============================\r\n  // 4. PURCHASE LINES\r\n  // ==============================\r\n  const makeEmptyLine = () => ({\r\n    item: \"\",\r\n    qty: \"\",\r\n    purchase_state: \"\",\r\n    purchase_price: \"\",\r\n    purchase_discount: \"\", // ✅ NEW: discount amount\r\n    gst: pGst || \"18\", // selling GST\r\n    price: \"\", // selling price\r\n  });\r\n\r\n  const [lines, setLines] = useState([makeEmptyLine()]);\r\n  const [pSuggest, setPSuggest] = useState([]);\r\n  const pDebRef = useRef();\r\n\r\n  // ------------------------------\r\n  // Initial load of inventory from DB\r\n  // ------------------------------\r\n  useEffect(() => {\r\n    apiGetInventory()\r\n      .then(setRows)\r\n      .catch(() => {});\r\n  }, []);\r\n\r\n  // ------------------------------\r\n  // Keep new line GST in sync with context GST\r\n  // (only updates the trailing empty line's GST)\r\n  // ------------------------------\r\n  useEffect(() => {\r\n    setLines((prev) => {\r\n      if (!prev.length) return [makeEmptyLine()];\r\n      const next = [...prev];\r\n      const lastIdx = next.length - 1;\r\n      const last = next[lastIdx] || {};\r\n\r\n      const isLastFilled =\r\n        (last.item || \"\").trim() !== \"\" ||\r\n        (last.qty || \"\") !== \"\" ||\r\n        (last.purchase_state || \"\") !== \"\" ||\r\n        (last.purchase_price || \"\") !== \"\" ||\r\n        (last.purchase_discount || \"\") !== \"\" ||\r\n        (last.gst || \"\") !== \"\" ||\r\n        (last.price || \"\") !== \"\";\r\n\r\n      if (!isLastFilled) {\r\n        next[lastIdx] = { ...last, gst: pGst || \"18\" };\r\n      }\r\n      return next;\r\n    });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [pGst]);\r\n\r\n  // ------------------------------\r\n  // Suggestions for \"Add Item\"\r\n  // ------------------------------\r\n  useEffect(() => {\r\n    clearTimeout(debRef.current);\r\n    debRef.current = setTimeout(async () => {\r\n      if (!name) {\r\n        setSuggest([]);\r\n        return;\r\n      }\r\n      try {\r\n        setSuggest(await apiSuggestNames(name, 25));\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }, 180);\r\n\r\n    return () => clearTimeout(debRef.current);\r\n  }, [name]);\r\n\r\n  // ------------------------------\r\n  // Suggestions for purchase lines\r\n  // ------------------------------\r\n  const fetchItemSuggestions = (q) => {\r\n    clearTimeout(pDebRef.current);\r\n    pDebRef.current = setTimeout(async () => {\r\n      if (!q) {\r\n        setPSuggest([]);\r\n        return;\r\n      }\r\n      try {\r\n        setPSuggest(await apiSuggestNames(q, 25));\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }, 180);\r\n  };\r\n\r\n  // ------------------------------\r\n  // Add new item (with Group + HSN)\r\n  // ------------------------------\r\n  const addItem = async () => {\r\n    const n = (name || \"\").trim();\r\n    const g = (groupName || \"\").trim();\r\n    const h = (hsnCode || \"\").trim();\r\n    if (!n) return alert(\"Enter item name\");\r\n    if (!g) return alert(\"Enter item group\");\r\n\r\n    try {\r\n      await apiAddItem(n, h, g);\r\n\r\n      const fresh = await apiGetInventory();\r\n      setRows(fresh);\r\n\r\n      setName(\"\");\r\n      setGroupName(\"\");\r\n      setHsnCode(\"\");\r\n      setSuggest([]);\r\n    } catch (e) {\r\n      alert(\"Error while adding item:\\n\" + e);\r\n    }\r\n  };\r\n\r\n  // ------------------------------\r\n  // Update a field within one purchase line\r\n  // ------------------------------\r\n  const updateLine = (idx, key, val) => {\r\n    setLines((prev) => {\r\n      const next = [...prev];\r\n      const row = { ...next[idx] };\r\n\r\n      // For numeric-ish fields, allow only digits and dot\r\n      const numericKeys = [\r\n        \"qty\",\r\n        \"purchase_price\",\r\n        \"purchase_discount\",\r\n        \"gst\",\r\n        \"price\",\r\n      ];\r\n      if (numericKeys.includes(key)) {\r\n        val = String(val).replace(/[^0-9.]/g, \"\");\r\n      }\r\n\r\n      row[key] = val;\r\n      next[idx] = row;\r\n      return next;\r\n    });\r\n\r\n    if (key === \"item\") fetchItemSuggestions(val);\r\n  };\r\n\r\n  // ------------------------------\r\n  // Ensure there is always a trailing empty row\r\n  // ------------------------------\r\n  const ensureTrailingEmptyRow = () => {\r\n    setLines((prev) => {\r\n      const last = prev[prev.length - 1] || {};\r\n      const isLastFilled =\r\n        (last.item || \"\").trim() !== \"\" ||\r\n        (last.qty || \"\") !== \"\" ||\r\n        (last.purchase_state || \"\") !== \"\" ||\r\n        (last.purchase_price || \"\") !== \"\" ||\r\n        (last.purchase_discount || \"\") !== \"\" ||\r\n        (last.gst || \"\") !== \"\" ||\r\n        (last.price || \"\") !== \"\";\r\n\r\n      return isLastFilled ? [...prev, makeEmptyLine()] : prev;\r\n    });\r\n  };\r\n\r\n  // ------------------------------\r\n  // Called after purchase_price is entered (blur/Enter)\r\n  // (kept same behavior as your original)\r\n  // ------------------------------\r\n  const onPurchasePriceDone = (idx) => {\r\n    const r = lines[idx] || {};\r\n    if ((r.item || \"\").trim() && Number(r.qty) > 0) {\r\n      ensureTrailingEmptyRow();\r\n      setTimeout(() => {\r\n        const el = document.getElementById(`pitem-${idx + 1}`);\r\n        el?.focus();\r\n      }, 0);\r\n    }\r\n  };\r\n\r\n  // ------------------------------\r\n  // Remove a purchase line row\r\n  // ------------------------------\r\n  const removeLine = (idx) => {\r\n    setLines((prev) => {\r\n      const next = prev.filter((_, i) => i !== idx);\r\n      return next.length ? next : [makeEmptyLine()];\r\n    });\r\n  };\r\n\r\n  // ------------------------------\r\n  // Reset purchase context\r\n  // ------------------------------\r\n  const resetPurchaseContext = () => {\r\n    setPDate(new Date().toISOString().slice(0, 10));\r\n    setPBill(\"\");\r\n    setPParty(\"\");\r\n    setPGstNo(\"\");\r\n  };\r\n\r\n  // ------------------------------\r\n  // SUBMIT ALL PURCHASE LINES\r\n  // ------------------------------\r\n  const submitAllPurchases = async () => {\r\n    if (!pBill.trim()) return alert(\"Enter Purchase Bill No.\");\r\n\r\n    const payloads = lines\r\n      .map((l) => {\r\n        const item_name = (l.item || \"\").trim();\r\n        const qty = Number(l.qty);\r\n\r\n        // discount amount: stored by reducing purchase_price (no backend change needed)\r\n        const gross = l.purchase_price === \"\" ? null : Number(l.purchase_price);\r\n        const disc =\r\n          l.purchase_discount === \"\" ? 0 : Number(l.purchase_discount);\r\n\r\n        const netPurchase =\r\n          gross === null ? null : Math.max(0, (gross || 0) - (disc || 0));\r\n\r\n        return {\r\n          item_name,\r\n          qty,\r\n\r\n          // purchase fields\r\n          purchase_state: (l.purchase_state || \"\").trim() || null,\r\n          purchase_price: netPurchase,\r\n\r\n          // selling fields\r\n          gst_percent: l.gst === \"\" ? null : Number(l.gst),\r\n          selling_price: l.price === \"\" ? null : Number(l.price),\r\n\r\n          // context fields\r\n          date: pDate,\r\n          bill_no: pBill,\r\n          party_name: (pParty || \"\").trim() || null,\r\n          gst_no: (pGstNo || \"\").trim() || null,\r\n\r\n        };\r\n      })\r\n      .filter((p) => p.item_name && Number.isFinite(p.qty) && p.qty > 0);\r\n\r\n    if (!payloads.length) return alert(\"Add at least one valid line.\");\r\n\r\n    try {\r\n      for (const p of payloads) {\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await apiAddPurchase(p);\r\n      }\r\n\r\n      const fresh = await apiGetInventory();\r\n      setRows(fresh);\r\n\r\n      setLines([makeEmptyLine()]);\r\n    } catch (e) {\r\n      alert(\"Error while saving purchases:\\n\" + e);\r\n    }\r\n  };\r\n\r\n  // ==============================\r\n  // RENDER\r\n  // ==============================\r\n  return (\r\n    <div className=\"card\">\r\n      {/* === Tabs Header === */}\r\n      <div className=\"inv-tabs\">\r\n        <button\r\n          className={activeTab === \"purchase\" ? \"inv-tab active\" : \"inv-tab\"}\r\n          onClick={() => setActiveTab(\"purchase\")}\r\n        >\r\n          Add Purchase\r\n        </button>\r\n        <button\r\n          className={activeTab === \"item\" ? \"inv-tab active\" : \"inv-tab\"}\r\n          onClick={() => setActiveTab(\"item\")}\r\n        >\r\n          Add Item\r\n        </button>\r\n      </div>\r\n\r\n      {/* === TAB: Add Purchase === */}\r\n      {activeTab === \"purchase\" && (\r\n        <div style={{ marginTop: 12 }}>\r\n          <div className=\"small\" style={{ marginBottom: 6 }}>\r\n            Add Purchase (updates stock & logs in purchases table)\r\n          </div>\r\n\r\n          {/* ✅ Context row: Date + Bill No + Party Name + GST + Reset */}\r\n          <div\r\n            style={{\r\n              display: \"grid\",\r\n              gridTemplateColumns: \"1fr 1fr 1fr 140px auto\",\r\n              gap: 12,\r\n              alignItems: \"end\",\r\n              marginBottom: 8,\r\n            }}\r\n          >\r\n            <div>\r\n              <label>Date of Purchase</label>\r\n              <input\r\n                type=\"date\"\r\n                value={pDate}\r\n                onChange={(e) => setPDate(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Purchase Bill No.</label>\r\n              <input\r\n                value={pBill}\r\n                onChange={(e) => setPBill(e.target.value)}\r\n                placeholder=\"PB/1234\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Party Name</label>\r\n              <input\r\n                value={pParty}\r\n                onChange={(e) => setPParty(e.target.value)}\r\n                placeholder=\"Supplier / Party name\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>GST No</label>\r\n              <input\r\n                value={pGstNo}\r\n                onChange={(e) => setPGstNo(e.target.value.toUpperCase())}\r\n                placeholder=\"33ABCDE1234F1Z5\"\r\n                maxLength={15}\r\n              />\r\n            </div>\r\n\r\n\r\n            <div className=\"stack\" style={{ alignSelf: \"end\" }}>\r\n              <button className=\"btn\" onClick={resetPurchaseContext}>\r\n                Reset\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Lines grid */}\r\n          <div style={{ marginTop: 6 }}>\r\n            <table>\r\n              <thead>\r\n                <tr>\r\n                  <th style={{ width: 36 }}>#</th>\r\n                  <th>Item (from items table)</th>\r\n                  <th style={{ width: 110 }}>Quantity</th>\r\n                  <th style={{ width: 130 }}>Purchase State</th>\r\n                  <th style={{ width: 140 }}>Purchase Price</th>\r\n                  <th style={{ width: 120 }}>Discount</th>\r\n                  <th style={{ width: 110 }}>GST %</th>\r\n                  <th style={{ width: 140 }}>Selling Price</th>\r\n                  <th style={{ width: 60 }}></th>\r\n                </tr>\r\n              </thead>\r\n\r\n              <tbody>\r\n                {lines.map((r, i) => (\r\n                  <tr key={`line-${i}`}>\r\n                    <td>{i + 1}</td>\r\n\r\n                    <td>\r\n                      <input\r\n                        id={`pitem-${i}`}\r\n                        list=\"inv-suggest-purchase\"\r\n                        value={r.item}\r\n                        onChange={(e) => updateLine(i, \"item\", e.target.value)}\r\n                        placeholder=\"Start typing to search…\"\r\n                        autoComplete=\"off\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.qty}\r\n                        onChange={(e) => updateLine(i, \"qty\", e.target.value)}\r\n                        placeholder=\"0\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.purchase_state}\r\n                        onChange={(e) =>\r\n                          updateLine(\r\n                            i,\r\n                            \"purchase_state\",\r\n                            e.target.value.toUpperCase()\r\n                          )\r\n                        }\r\n                        placeholder=\"00\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.purchase_price}\r\n                        onChange={(e) =>\r\n                          updateLine(i, \"purchase_price\", e.target.value)\r\n                        }\r\n                        placeholder=\"0.00\"\r\n                        onBlur={() => onPurchasePriceDone(i)}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === \"Enter\") onPurchasePriceDone(i);\r\n                        }}\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.purchase_discount}\r\n                        onChange={(e) =>\r\n                          updateLine(i, \"purchase_discount\", e.target.value)\r\n                        }\r\n                        placeholder=\"0.00\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.gst}\r\n                        onChange={(e) => updateLine(i, \"gst\", e.target.value)}\r\n                        placeholder=\"18\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={r.price}\r\n                        onChange={(e) => updateLine(i, \"price\", e.target.value)}\r\n                        placeholder=\"0.00\"\r\n                      />\r\n                    </td>\r\n\r\n                    <td className=\"center\">\r\n                      <button\r\n                        className=\"btn\"\r\n                        onClick={() => removeLine(i)}\r\n                        title=\"Remove row\"\r\n                      >\r\n                        ✕\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n\r\n                <tr>\r\n                  <td colSpan={9} className=\"small\">\r\n                    Tip: After entering <strong>Purchase Price</strong>, press{\" \"}\r\n                    <strong>Enter</strong> to create the next row automatically.\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n\r\n            {/* Shared datalist for purchase items */}\r\n            <datalist id=\"inv-suggest-purchase\">\r\n              {pSuggest.map((s) => (\r\n                <option key={s.name} value={s.name} />\r\n              ))}\r\n            </datalist>\r\n\r\n            <div className=\"stack\" style={{ marginTop: 10 }}>\r\n              <button className=\"btn primary\" onClick={submitAllPurchases}>\r\n                Add Purchase\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* === TAB: Add Item === */}\r\n      {activeTab === \"item\" && (\r\n        <div style={{ marginTop: 12 }}>\r\n          <div className=\"row-3\">\r\n            <div>\r\n              <label>Add New Item (or select existing)</label>\r\n              <input\r\n                list=\"inv-suggest\"\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n                placeholder=\"e.g., TMT BARS 8MM JSW TMT\"\r\n                autoComplete=\"off\"\r\n              />\r\n              <datalist id=\"inv-suggest\">\r\n                {suggest.map((s) => (\r\n                  <option key={s.name} value={s.name} />\r\n                ))}\r\n              </datalist>\r\n            </div>\r\n\r\n            <div>\r\n              <label>Group</label>\r\n              <input\r\n                value={groupName}\r\n                onChange={(e) => setGroupName(e.target.value)}\r\n                placeholder=\"e.g., TMT, MS, CHANNEL, ANGLE\"\r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>HSN Code</label>\r\n              <input\r\n                value={hsnCode}\r\n                onChange={(e) => setHsnCode(e.target.value.replace(/[^\\d]/g, \"\"))}\r\n                placeholder=\"e.g., 7214\"\r\n                inputMode=\"numeric\"\r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"stack\">\r\n              <button className=\"btn primary\" onClick={addItem}>\r\n                Add Item\r\n              </button>\r\n              <button\r\n                className=\"btn\"\r\n                onClick={async () => setRows(await apiGetInventory())}\r\n              >\r\n                Reload from DB\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* === Items Grid (current inventory) === */}\r\n      <div style={{ marginTop: 12 }}>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ width: 40 }}>#</th>\r\n              <th>Item</th>\r\n              <th className=\"right\">GST %</th>\r\n              <th>Unit</th>\r\n              <th>HSN Code</th>\r\n              <th className=\"right\">Price</th>\r\n              <th className=\"right\">Stock</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map((r, i) => (\r\n              <tr key={`${r.ID || r[\"ITEM NAME\"]}-${i}`}>\r\n                <td>{i + 1}</td>\r\n                <td>{r[\"ITEM NAME\"] || r[\"ITEM NAM\"]}</td>\r\n                <td className=\"right\">{Number(r[\"GST %\"] ?? r[\"GST\"] ?? 0)}</td>\r\n                <td>{r[\"UNIT\"]}</td>\r\n                <td>{r[\"HSN CODE\"] ?? r[\"HSN\"] ?? \"\"}</td>\r\n                <td className=\"right\">{toINR(r[\"PRICE\"])}</td>\r\n                <td className=\"right\">{toINR(r[\"STOCK QTY\"])}</td>\r\n              </tr>\r\n            ))}\r\n            {rows.length === 0 && (\r\n              <tr>\r\n                <td colSpan={7} className=\"center small\">\r\n                  No items\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,SACEC,eAAe,EACfC,eAAe,EACfC,UAAU,EACVC,cAAc,QACT,OAAO;AACd,OAAO,sBAAsB;;AAE7B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,KAAK,GAAIC,CAAC,IACdC,MAAM,CAACD,CAAC,IAAI,CAAC,CAAC,CAACE,cAAc,CAAC,OAAO,EAAE;EAAEC,qBAAqB,EAAE;AAAE,CAAC,CAAC;AAEtE,eAAe,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EACvC;EACA;EACA;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;;EAExD;EACA;EACA;EACA,MAAM,CAACgB,IAAI,EAAEC,OAAO,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;;EAEpC;EACA;EACA;EACA,MAAM,CAACkB,IAAI,EAAEC,OAAO,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACsB,OAAO,EAAEC,UAAU,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACwB,OAAO,EAAEC,UAAU,CAAC,GAAGzB,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM0B,MAAM,GAAG3B,MAAM,CAAC,CAAC;;EAEvB;EACA;EACA;EACA,MAAM,CAAC4B,KAAK,EAAEC,QAAQ,CAAC,GAAG5B,QAAQ,CAAC,MACjC,IAAI6B,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CACtC,CAAC;EACD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGjC,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACkC,MAAM,EAAEC,SAAS,CAAC,GAAGnC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC1C,MAAM,CAACoC,MAAM,EAAEC,SAAS,CAAC,GAAGrC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EACxC,MAAM,CAACsC,IAAI,EAAEC,OAAO,CAAC,GAAGvC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;;EAGxC;EACA;EACA;EACA,MAAMwC,aAAa,GAAGA,CAAA,MAAO;IAC3BC,IAAI,EAAE,EAAE;IACRC,GAAG,EAAE,EAAE;IACPC,cAAc,EAAE,EAAE;IAClBC,cAAc,EAAE,EAAE;IAClBC,iBAAiB,EAAE,EAAE;IAAE;IACvBC,GAAG,EAAER,IAAI,IAAI,IAAI;IAAE;IACnBS,KAAK,EAAE,EAAE,CAAE;EACb,CAAC,CAAC;EAEF,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGjD,QAAQ,CAAC,CAACwC,aAAa,CAAC,CAAC,CAAC,CAAC;EACrD,MAAM,CAACU,QAAQ,EAAEC,WAAW,CAAC,GAAGnD,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAMoD,OAAO,GAAGrD,MAAM,CAAC,CAAC;;EAExB;EACA;EACA;EACAD,SAAS,CAAC,MAAM;IACdG,eAAe,CAAC,CAAC,CACdoD,IAAI,CAACpC,OAAO,CAAC,CACbqC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EACpB,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA;EACA;EACA;EACAxD,SAAS,CAAC,MAAM;IACdmD,QAAQ,CAAEM,IAAI,IAAK;MACjB,IAAI,CAACA,IAAI,CAACC,MAAM,EAAE,OAAO,CAAChB,aAAa,CAAC,CAAC,CAAC;MAC1C,MAAMiB,IAAI,GAAG,CAAC,GAAGF,IAAI,CAAC;MACtB,MAAMG,OAAO,GAAGD,IAAI,CAACD,MAAM,GAAG,CAAC;MAC/B,MAAMG,IAAI,GAAGF,IAAI,CAACC,OAAO,CAAC,IAAI,CAAC,CAAC;MAEhC,MAAME,YAAY,GAChB,CAACD,IAAI,CAAClB,IAAI,IAAI,EAAE,EAAEoB,IAAI,CAAC,CAAC,KAAK,EAAE,IAC/B,CAACF,IAAI,CAACjB,GAAG,IAAI,EAAE,MAAM,EAAE,IACvB,CAACiB,IAAI,CAAChB,cAAc,IAAI,EAAE,MAAM,EAAE,IAClC,CAACgB,IAAI,CAACf,cAAc,IAAI,EAAE,MAAM,EAAE,IAClC,CAACe,IAAI,CAACd,iBAAiB,IAAI,EAAE,MAAM,EAAE,IACrC,CAACc,IAAI,CAACb,GAAG,IAAI,EAAE,MAAM,EAAE,IACvB,CAACa,IAAI,CAACZ,KAAK,IAAI,EAAE,MAAM,EAAE;MAE3B,IAAI,CAACa,YAAY,EAAE;QACjBH,IAAI,CAACC,OAAO,CAAC,GAAG;UAAE,GAAGC,IAAI;UAAEb,GAAG,EAAER,IAAI,IAAI;QAAK,CAAC;MAChD;MACA,OAAOmB,IAAI;IACb,CAAC,CAAC;IACF;EACF,CAAC,EAAE,CAACnB,IAAI,CAAC,CAAC;;EAEV;EACA;EACA;EACAxC,SAAS,CAAC,MAAM;IACdgE,YAAY,CAACpC,MAAM,CAACqC,OAAO,CAAC;IAC5BrC,MAAM,CAACqC,OAAO,GAAGC,UAAU,CAAC,YAAY;MACtC,IAAI,CAAC9C,IAAI,EAAE;QACTO,UAAU,CAAC,EAAE,CAAC;QACd;MACF;MACA,IAAI;QACFA,UAAU,CAAC,MAAMvB,eAAe,CAACgB,IAAI,EAAE,EAAE,CAAC,CAAC;MAC7C,CAAC,CAAC,MAAM;QACN;MAAA;IAEJ,CAAC,EAAE,GAAG,CAAC;IAEP,OAAO,MAAM4C,YAAY,CAACpC,MAAM,CAACqC,OAAO,CAAC;EAC3C,CAAC,EAAE,CAAC7C,IAAI,CAAC,CAAC;;EAEV;EACA;EACA;EACA,MAAM+C,oBAAoB,GAAIC,CAAC,IAAK;IAClCJ,YAAY,CAACV,OAAO,CAACW,OAAO,CAAC;IAC7BX,OAAO,CAACW,OAAO,GAAGC,UAAU,CAAC,YAAY;MACvC,IAAI,CAACE,CAAC,EAAE;QACNf,WAAW,CAAC,EAAE,CAAC;QACf;MACF;MACA,IAAI;QACFA,WAAW,CAAC,MAAMjD,eAAe,CAACgE,CAAC,EAAE,EAAE,CAAC,CAAC;MAC3C,CAAC,CAAC,MAAM;QACN;MAAA;IAEJ,CAAC,EAAE,GAAG,CAAC;EACT,CAAC;;EAED;EACA;EACA;EACA,MAAMC,OAAO,GAAG,MAAAA,CAAA,KAAY;IAC1B,MAAM3D,CAAC,GAAG,CAACU,IAAI,IAAI,EAAE,EAAE2C,IAAI,CAAC,CAAC;IAC7B,MAAMO,CAAC,GAAG,CAAChD,SAAS,IAAI,EAAE,EAAEyC,IAAI,CAAC,CAAC;IAClC,MAAMQ,CAAC,GAAG,CAAC/C,OAAO,IAAI,EAAE,EAAEuC,IAAI,CAAC,CAAC;IAChC,IAAI,CAACrD,CAAC,EAAE,OAAO8D,KAAK,CAAC,iBAAiB,CAAC;IACvC,IAAI,CAACF,CAAC,EAAE,OAAOE,KAAK,CAAC,kBAAkB,CAAC;IAExC,IAAI;MACF,MAAMnE,UAAU,CAACK,CAAC,EAAE6D,CAAC,EAAED,CAAC,CAAC;MAEzB,MAAMG,KAAK,GAAG,MAAMtE,eAAe,CAAC,CAAC;MACrCgB,OAAO,CAACsD,KAAK,CAAC;MAEdpD,OAAO,CAAC,EAAE,CAAC;MACXE,YAAY,CAAC,EAAE,CAAC;MAChBE,UAAU,CAAC,EAAE,CAAC;MACdE,UAAU,CAAC,EAAE,CAAC;IAChB,CAAC,CAAC,OAAO+C,CAAC,EAAE;MACVF,KAAK,CAAC,4BAA4B,GAAGE,CAAC,CAAC;IACzC;EACF,CAAC;;EAED;EACA;EACA;EACA,MAAMC,UAAU,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,KAAK;IACpC3B,QAAQ,CAAEM,IAAI,IAAK;MACjB,MAAME,IAAI,GAAG,CAAC,GAAGF,IAAI,CAAC;MACtB,MAAMsB,GAAG,GAAG;QAAE,GAAGpB,IAAI,CAACiB,GAAG;MAAE,CAAC;;MAE5B;MACA,MAAMI,WAAW,GAAG,CAClB,KAAK,EACL,gBAAgB,EAChB,mBAAmB,EACnB,KAAK,EACL,OAAO,CACR;MACD,IAAIA,WAAW,CAACC,QAAQ,CAACJ,GAAG,CAAC,EAAE;QAC7BC,GAAG,GAAGI,MAAM,CAACJ,GAAG,CAAC,CAACK,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;MAC3C;MAEAJ,GAAG,CAACF,GAAG,CAAC,GAAGC,GAAG;MACdnB,IAAI,CAACiB,GAAG,CAAC,GAAGG,GAAG;MACf,OAAOpB,IAAI;IACb,CAAC,CAAC;IAEF,IAAIkB,GAAG,KAAK,MAAM,EAAEV,oBAAoB,CAACW,GAAG,CAAC;EAC/C,CAAC;;EAED;EACA;EACA;EACA,MAAMM,sBAAsB,GAAGA,CAAA,KAAM;IACnCjC,QAAQ,CAAEM,IAAI,IAAK;MACjB,MAAMI,IAAI,GAAGJ,IAAI,CAACA,IAAI,CAACC,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;MACxC,MAAMI,YAAY,GAChB,CAACD,IAAI,CAAClB,IAAI,IAAI,EAAE,EAAEoB,IAAI,CAAC,CAAC,KAAK,EAAE,IAC/B,CAACF,IAAI,CAACjB,GAAG,IAAI,EAAE,MAAM,EAAE,IACvB,CAACiB,IAAI,CAAChB,cAAc,IAAI,EAAE,MAAM,EAAE,IAClC,CAACgB,IAAI,CAACf,cAAc,IAAI,EAAE,MAAM,EAAE,IAClC,CAACe,IAAI,CAACd,iBAAiB,IAAI,EAAE,MAAM,EAAE,IACrC,CAACc,IAAI,CAACb,GAAG,IAAI,EAAE,MAAM,EAAE,IACvB,CAACa,IAAI,CAACZ,KAAK,IAAI,EAAE,MAAM,EAAE;MAE3B,OAAOa,YAAY,GAAG,CAAC,GAAGL,IAAI,EAAEf,aAAa,CAAC,CAAC,CAAC,GAAGe,IAAI;IACzD,CAAC,CAAC;EACJ,CAAC;;EAED;EACA;EACA;EACA;EACA,MAAM4B,mBAAmB,GAAIT,GAAG,IAAK;IACnC,MAAMU,CAAC,GAAGpC,KAAK,CAAC0B,GAAG,CAAC,IAAI,CAAC,CAAC;IAC1B,IAAI,CAACU,CAAC,CAAC3C,IAAI,IAAI,EAAE,EAAEoB,IAAI,CAAC,CAAC,IAAIpD,MAAM,CAAC2E,CAAC,CAAC1C,GAAG,CAAC,GAAG,CAAC,EAAE;MAC9CwC,sBAAsB,CAAC,CAAC;MACxBlB,UAAU,CAAC,MAAM;QACf,MAAMqB,EAAE,GAAGC,QAAQ,CAACC,cAAc,CAAC,SAASb,GAAG,GAAG,CAAC,EAAE,CAAC;QACtDW,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEG,KAAK,CAAC,CAAC;MACb,CAAC,EAAE,CAAC,CAAC;IACP;EACF,CAAC;;EAED;EACA;EACA;EACA,MAAMC,UAAU,GAAIf,GAAG,IAAK;IAC1BzB,QAAQ,CAAEM,IAAI,IAAK;MACjB,MAAME,IAAI,GAAGF,IAAI,CAACmC,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKlB,GAAG,CAAC;MAC7C,OAAOjB,IAAI,CAACD,MAAM,GAAGC,IAAI,GAAG,CAACjB,aAAa,CAAC,CAAC,CAAC;IAC/C,CAAC,CAAC;EACJ,CAAC;;EAED;EACA;EACA;EACA,MAAMqD,oBAAoB,GAAGA,CAAA,KAAM;IACjCjE,QAAQ,CAAC,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAC/CE,QAAQ,CAAC,EAAE,CAAC;IACZE,SAAS,CAAC,EAAE,CAAC;IACbE,SAAS,CAAC,EAAE,CAAC;EACf,CAAC;;EAED;EACA;EACA;EACA,MAAMyD,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI,CAAC9D,KAAK,CAAC6B,IAAI,CAAC,CAAC,EAAE,OAAOS,KAAK,CAAC,yBAAyB,CAAC;IAE1D,MAAMyB,QAAQ,GAAG/C,KAAK,CACnBgD,GAAG,CAAEC,CAAC,IAAK;MACV,MAAMC,SAAS,GAAG,CAACD,CAAC,CAACxD,IAAI,IAAI,EAAE,EAAEoB,IAAI,CAAC,CAAC;MACvC,MAAMnB,GAAG,GAAGjC,MAAM,CAACwF,CAAC,CAACvD,GAAG,CAAC;;MAEzB;MACA,MAAMyD,KAAK,GAAGF,CAAC,CAACrD,cAAc,KAAK,EAAE,GAAG,IAAI,GAAGnC,MAAM,CAACwF,CAAC,CAACrD,cAAc,CAAC;MACvE,MAAMwD,IAAI,GACRH,CAAC,CAACpD,iBAAiB,KAAK,EAAE,GAAG,CAAC,GAAGpC,MAAM,CAACwF,CAAC,CAACpD,iBAAiB,CAAC;MAE9D,MAAMwD,WAAW,GACfF,KAAK,KAAK,IAAI,GAAG,IAAI,GAAGG,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,CAACJ,KAAK,IAAI,CAAC,KAAKC,IAAI,IAAI,CAAC,CAAC,CAAC;MAEjE,OAAO;QACLF,SAAS;QACTxD,GAAG;QAEH;QACAC,cAAc,EAAE,CAACsD,CAAC,CAACtD,cAAc,IAAI,EAAE,EAAEkB,IAAI,CAAC,CAAC,IAAI,IAAI;QACvDjB,cAAc,EAAEyD,WAAW;QAE3B;QACAG,WAAW,EAAEP,CAAC,CAACnD,GAAG,KAAK,EAAE,GAAG,IAAI,GAAGrC,MAAM,CAACwF,CAAC,CAACnD,GAAG,CAAC;QAChD2D,aAAa,EAAER,CAAC,CAAClD,KAAK,KAAK,EAAE,GAAG,IAAI,GAAGtC,MAAM,CAACwF,CAAC,CAAClD,KAAK,CAAC;QAEtD;QACA2D,IAAI,EAAE/E,KAAK;QACXgF,OAAO,EAAE3E,KAAK;QACd4E,UAAU,EAAE,CAAC1E,MAAM,IAAI,EAAE,EAAE2B,IAAI,CAAC,CAAC,IAAI,IAAI;QACzCgD,MAAM,EAAE,CAACzE,MAAM,IAAI,EAAE,EAAEyB,IAAI,CAAC,CAAC,IAAI;MAEnC,CAAC;IACH,CAAC,CAAC,CACD6B,MAAM,CAAEoB,CAAC,IAAKA,CAAC,CAACZ,SAAS,IAAIzF,MAAM,CAACsG,QAAQ,CAACD,CAAC,CAACpE,GAAG,CAAC,IAAIoE,CAAC,CAACpE,GAAG,GAAG,CAAC,CAAC;IAEpE,IAAI,CAACqD,QAAQ,CAACvC,MAAM,EAAE,OAAOc,KAAK,CAAC,8BAA8B,CAAC;IAElE,IAAI;MACF,KAAK,MAAMwC,CAAC,IAAIf,QAAQ,EAAE;QACxB;QACA,MAAM3F,cAAc,CAAC0G,CAAC,CAAC;MACzB;MAEA,MAAMvC,KAAK,GAAG,MAAMtE,eAAe,CAAC,CAAC;MACrCgB,OAAO,CAACsD,KAAK,CAAC;MAEdtB,QAAQ,CAAC,CAACT,aAAa,CAAC,CAAC,CAAC,CAAC;IAC7B,CAAC,CAAC,OAAOgC,CAAC,EAAE;MACVF,KAAK,CAAC,iCAAiC,GAAGE,CAAC,CAAC;IAC9C;EACF,CAAC;;EAED;EACA;EACA;EACA,oBACElE,OAAA;IAAK0G,SAAS,EAAC,MAAM;IAAAC,QAAA,gBAEnB3G,OAAA;MAAK0G,SAAS,EAAC,UAAU;MAAAC,QAAA,gBACvB3G,OAAA;QACE0G,SAAS,EAAElG,SAAS,KAAK,UAAU,GAAG,gBAAgB,GAAG,SAAU;QACnEoG,OAAO,EAAEA,CAAA,KAAMnG,YAAY,CAAC,UAAU,CAAE;QAAAkG,QAAA,EACzC;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACThH,OAAA;QACE0G,SAAS,EAAElG,SAAS,KAAK,MAAM,GAAG,gBAAgB,GAAG,SAAU;QAC/DoG,OAAO,EAAEA,CAAA,KAAMnG,YAAY,CAAC,MAAM,CAAE;QAAAkG,QAAA,EACrC;MAED;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,EAGLxG,SAAS,KAAK,UAAU,iBACvBR,OAAA;MAAKiH,KAAK,EAAE;QAAEC,SAAS,EAAE;MAAG,CAAE;MAAAP,QAAA,gBAC5B3G,OAAA;QAAK0G,SAAS,EAAC,OAAO;QAACO,KAAK,EAAE;UAAEE,YAAY,EAAE;QAAE,CAAE;QAAAR,QAAA,EAAC;MAEnD;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAGNhH,OAAA;QACEiH,KAAK,EAAE;UACLG,OAAO,EAAE,MAAM;UACfC,mBAAmB,EAAE,wBAAwB;UAC7CC,GAAG,EAAE,EAAE;UACPC,UAAU,EAAE,KAAK;UACjBJ,YAAY,EAAE;QAChB,CAAE;QAAAR,QAAA,gBAEF3G,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAgB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC/BhH,OAAA;YACEwH,IAAI,EAAC,MAAM;YACXC,KAAK,EAAEpG,KAAM;YACbqG,QAAQ,EAAGxD,CAAC,IAAK5C,QAAQ,CAAC4C,CAAC,CAACyD,MAAM,CAACF,KAAK;UAAE;YAAAZ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3C,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENhH,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAiB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAChChH,OAAA;YACEyH,KAAK,EAAE/F,KAAM;YACbgG,QAAQ,EAAGxD,CAAC,IAAKvC,QAAQ,CAACuC,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;YAC1CG,WAAW,EAAC;UAAS;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENhH,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAU;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACzBhH,OAAA;YACEyH,KAAK,EAAE7F,MAAO;YACd8F,QAAQ,EAAGxD,CAAC,IAAKrC,SAAS,CAACqC,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;YAC3CG,WAAW,EAAC;UAAuB;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENhH,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAM;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACrBhH,OAAA;YACEyH,KAAK,EAAE3F,MAAO;YACd4F,QAAQ,EAAGxD,CAAC,IAAKnC,SAAS,CAACmC,CAAC,CAACyD,MAAM,CAACF,KAAK,CAACI,WAAW,CAAC,CAAC,CAAE;YACzDD,WAAW,EAAC,iBAAiB;YAC7BE,SAAS,EAAE;UAAG;YAAAjB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACf,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAGNhH,OAAA;UAAK0G,SAAS,EAAC,OAAO;UAACO,KAAK,EAAE;YAAEc,SAAS,EAAE;UAAM,CAAE;UAAApB,QAAA,eACjD3G,OAAA;YAAQ0G,SAAS,EAAC,KAAK;YAACE,OAAO,EAAErB,oBAAqB;YAAAoB,QAAA,EAAC;UAEvD;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNhH,OAAA;QAAKiH,KAAK,EAAE;UAAEC,SAAS,EAAE;QAAE,CAAE;QAAAP,QAAA,gBAC3B3G,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,eACE3G,OAAA;cAAA2G,QAAA,gBACE3G,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAG,CAAE;gBAAArB,QAAA,EAAC;cAAC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAChChH,OAAA;gBAAA2G,QAAA,EAAI;cAAuB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAChChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAQ;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACxChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAc;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC9ChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAc;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC9ChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAQ;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACxChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAK;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACrChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAI,CAAE;gBAAArB,QAAA,EAAC;cAAa;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC7ChH,OAAA;gBAAIiH,KAAK,EAAE;kBAAEe,KAAK,EAAE;gBAAG;cAAE;gBAAAnB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC7B;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC,eAERhH,OAAA;YAAA2G,QAAA,GACGjE,KAAK,CAACgD,GAAG,CAAC,CAACZ,CAAC,EAAEQ,CAAC,kBACdtF,OAAA;cAAA2G,QAAA,gBACE3G,OAAA;gBAAA2G,QAAA,EAAKrB,CAAC,GAAG;cAAC;gBAAAuB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAEhBhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEiI,EAAE,EAAE,SAAS3C,CAAC,EAAG;kBACjB4C,IAAI,EAAC,sBAAsB;kBAC3BT,KAAK,EAAE3C,CAAC,CAAC3C,IAAK;kBACduF,QAAQ,EAAGxD,CAAC,IAAKC,UAAU,CAACmB,CAAC,EAAE,MAAM,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;kBACvDG,WAAW,EAAC,8BAAyB;kBACrCO,YAAY,EAAC;gBAAK;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAAC1C,GAAI;kBACbsF,QAAQ,EAAGxD,CAAC,IAAKC,UAAU,CAACmB,CAAC,EAAE,KAAK,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;kBACtDG,WAAW,EAAC;gBAAG;kBAAAf,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAChB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAACzC,cAAe;kBACxBqF,QAAQ,EAAGxD,CAAC,IACVC,UAAU,CACRmB,CAAC,EACD,gBAAgB,EAChBpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAACI,WAAW,CAAC,CAC7B,CACD;kBACDD,WAAW,EAAC;gBAAI;kBAAAf,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAACxC,cAAe;kBACxBoF,QAAQ,EAAGxD,CAAC,IACVC,UAAU,CAACmB,CAAC,EAAE,gBAAgB,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAC/C;kBACDG,WAAW,EAAC,MAAM;kBAClBQ,MAAM,EAAEA,CAAA,KAAMvD,mBAAmB,CAACS,CAAC,CAAE;kBACrC+C,SAAS,EAAGnE,CAAC,IAAK;oBAChB,IAAIA,CAAC,CAACG,GAAG,KAAK,OAAO,EAAEQ,mBAAmB,CAACS,CAAC,CAAC;kBAC/C;gBAAE;kBAAAuB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAACvC,iBAAkB;kBAC3BmF,QAAQ,EAAGxD,CAAC,IACVC,UAAU,CAACmB,CAAC,EAAE,mBAAmB,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAClD;kBACDG,WAAW,EAAC;gBAAM;kBAAAf,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAACtC,GAAI;kBACbkF,QAAQ,EAAGxD,CAAC,IAAKC,UAAU,CAACmB,CAAC,EAAE,KAAK,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;kBACtDG,WAAW,EAAC;gBAAI;kBAAAf,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAA2G,QAAA,eACE3G,OAAA;kBACEyH,KAAK,EAAE3C,CAAC,CAACrC,KAAM;kBACfiF,QAAQ,EAAGxD,CAAC,IAAKC,UAAU,CAACmB,CAAC,EAAE,OAAO,EAAEpB,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;kBACxDG,WAAW,EAAC;gBAAM;kBAAAf,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eAELhH,OAAA;gBAAI0G,SAAS,EAAC,QAAQ;gBAAAC,QAAA,eACpB3G,OAAA;kBACE0G,SAAS,EAAC,KAAK;kBACfE,OAAO,EAAEA,CAAA,KAAMzB,UAAU,CAACG,CAAC,CAAE;kBAC7BgD,KAAK,EAAC,YAAY;kBAAA3B,QAAA,EACnB;gBAED;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACP,CAAC;YAAA,GApFE,QAAQ1B,CAAC,EAAE;cAAAuB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAqFhB,CACL,CAAC,eAEFhH,OAAA;cAAA2G,QAAA,eACE3G,OAAA;gBAAIuI,OAAO,EAAE,CAAE;gBAAC7B,SAAS,EAAC,OAAO;gBAAAC,QAAA,GAAC,sBACZ,eAAA3G,OAAA;kBAAA2G,QAAA,EAAQ;gBAAc;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,WAAO,EAAC,GAAG,eAC9DhH,OAAA;kBAAA2G,QAAA,EAAQ;gBAAK;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,0CACxB;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAGRhH,OAAA;UAAUiI,EAAE,EAAC,sBAAsB;UAAAtB,QAAA,EAChC/D,QAAQ,CAAC8C,GAAG,CAAE8C,CAAC,iBACdxI,OAAA;YAAqByH,KAAK,EAAEe,CAAC,CAAC5H;UAAK,GAAtB4H,CAAC,CAAC5H,IAAI;YAAAiG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAkB,CACtC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACM,CAAC,eAEXhH,OAAA;UAAK0G,SAAS,EAAC,OAAO;UAACO,KAAK,EAAE;YAAEC,SAAS,EAAE;UAAG,CAAE;UAAAP,QAAA,eAC9C3G,OAAA;YAAQ0G,SAAS,EAAC,aAAa;YAACE,OAAO,EAAEpB,kBAAmB;YAAAmB,QAAA,EAAC;UAE7D;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGAxG,SAAS,KAAK,MAAM,iBACnBR,OAAA;MAAKiH,KAAK,EAAE;QAAEC,SAAS,EAAE;MAAG,CAAE;MAAAP,QAAA,eAC5B3G,OAAA;QAAK0G,SAAS,EAAC,OAAO;QAAAC,QAAA,gBACpB3G,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAiC;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAChDhH,OAAA;YACEkI,IAAI,EAAC,aAAa;YAClBT,KAAK,EAAE7G,IAAK;YACZ8G,QAAQ,EAAGxD,CAAC,IAAKrD,OAAO,CAACqD,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;YACzCG,WAAW,EAAC,4BAA4B;YACxCO,YAAY,EAAC;UAAK;YAAAtB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC,eACFhH,OAAA;YAAUiI,EAAE,EAAC,aAAa;YAAAtB,QAAA,EACvBzF,OAAO,CAACwE,GAAG,CAAE8C,CAAC,iBACbxI,OAAA;cAAqByH,KAAK,EAAEe,CAAC,CAAC5H;YAAK,GAAtB4H,CAAC,CAAC5H,IAAI;cAAAiG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAkB,CACtC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACR,CAAC,eAENhH,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACpBhH,OAAA;YACEyH,KAAK,EAAE3G,SAAU;YACjB4G,QAAQ,EAAGxD,CAAC,IAAKnD,YAAY,CAACmD,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAE;YAC9CG,WAAW,EAAC,+BAA+B;YAC3CO,YAAY,EAAC;UAAK;YAAAtB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENhH,OAAA;UAAA2G,QAAA,gBACE3G,OAAA;YAAA2G,QAAA,EAAO;UAAQ;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACvBhH,OAAA;YACEyH,KAAK,EAAEzG,OAAQ;YACf0G,QAAQ,EAAGxD,CAAC,IAAKjD,UAAU,CAACiD,CAAC,CAACyD,MAAM,CAACF,KAAK,CAAC9C,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAE;YAClEiD,WAAW,EAAC,YAAY;YACxBa,SAAS,EAAC,SAAS;YACnBN,YAAY,EAAC;UAAK;YAAAtB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENhH,OAAA;UAAK0G,SAAS,EAAC,OAAO;UAAAC,QAAA,gBACpB3G,OAAA;YAAQ0G,SAAS,EAAC,aAAa;YAACE,OAAO,EAAE/C,OAAQ;YAAA8C,QAAA,EAAC;UAElD;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACThH,OAAA;YACE0G,SAAS,EAAC,KAAK;YACfE,OAAO,EAAE,MAAAA,CAAA,KAAYjG,OAAO,CAAC,MAAMhB,eAAe,CAAC,CAAC,CAAE;YAAAgH,QAAA,EACvD;UAED;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,eAGDhH,OAAA;MAAKiH,KAAK,EAAE;QAAEC,SAAS,EAAE;MAAG,CAAE;MAAAP,QAAA,eAC5B3G,OAAA;QAAA2G,QAAA,gBACE3G,OAAA;UAAA2G,QAAA,eACE3G,OAAA;YAAA2G,QAAA,gBACE3G,OAAA;cAAIiH,KAAK,EAAE;gBAAEe,KAAK,EAAE;cAAG,CAAE;cAAArB,QAAA,EAAC;YAAC;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAChChH,OAAA;cAAA2G,QAAA,EAAI;YAAI;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACbhH,OAAA;cAAI0G,SAAS,EAAC,OAAO;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAChChH,OAAA;cAAA2G,QAAA,EAAI;YAAI;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACbhH,OAAA;cAAA2G,QAAA,EAAI;YAAQ;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACjBhH,OAAA;cAAI0G,SAAS,EAAC,OAAO;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAChChH,OAAA;cAAI0G,SAAS,EAAC,OAAO;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9B;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,eACRhH,OAAA;UAAA2G,QAAA,GACGjG,IAAI,CAACgF,GAAG,CAAC,CAACZ,CAAC,EAAEQ,CAAC;YAAA,IAAAoD,IAAA,EAAAC,MAAA,EAAAC,KAAA,EAAAC,UAAA;YAAA,oBACb7I,OAAA;cAAA2G,QAAA,gBACE3G,OAAA;gBAAA2G,QAAA,EAAKrB,CAAC,GAAG;cAAC;gBAAAuB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAChBhH,OAAA;gBAAA2G,QAAA,EAAK7B,CAAC,CAAC,WAAW,CAAC,IAAIA,CAAC,CAAC,UAAU;cAAC;gBAAA+B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAC1ChH,OAAA;gBAAI0G,SAAS,EAAC,OAAO;gBAAAC,QAAA,EAAExG,MAAM,EAAAuI,IAAA,IAAAC,MAAA,GAAC7D,CAAC,CAAC,OAAO,CAAC,cAAA6D,MAAA,cAAAA,MAAA,GAAI7D,CAAC,CAAC,KAAK,CAAC,cAAA4D,IAAA,cAAAA,IAAA,GAAI,CAAC;cAAC;gBAAA7B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAChEhH,OAAA;gBAAA2G,QAAA,EAAK7B,CAAC,CAAC,MAAM;cAAC;gBAAA+B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACpBhH,OAAA;gBAAA2G,QAAA,GAAAiC,KAAA,IAAAC,UAAA,GAAK/D,CAAC,CAAC,UAAU,CAAC,cAAA+D,UAAA,cAAAA,UAAA,GAAI/D,CAAC,CAAC,KAAK,CAAC,cAAA8D,KAAA,cAAAA,KAAA,GAAI;cAAE;gBAAA/B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAC1ChH,OAAA;gBAAI0G,SAAS,EAAC,OAAO;gBAAAC,QAAA,EAAE1G,KAAK,CAAC6E,CAAC,CAAC,OAAO,CAAC;cAAC;gBAAA+B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eAC9ChH,OAAA;gBAAI0G,SAAS,EAAC,OAAO;gBAAAC,QAAA,EAAE1G,KAAK,CAAC6E,CAAC,CAAC,WAAW,CAAC;cAAC;gBAAA+B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC;YAAA,GAP3C,GAAGlC,CAAC,CAACgE,EAAE,IAAIhE,CAAC,CAAC,WAAW,CAAC,IAAIQ,CAAC,EAAE;cAAAuB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAQrC,CAAC;UAAA,CACN,CAAC,EACDtG,IAAI,CAACwC,MAAM,KAAK,CAAC,iBAChBlD,OAAA;YAAA2G,QAAA,eACE3G,OAAA;cAAIuI,OAAO,EAAE,CAAE;cAAC7B,SAAS,EAAC,cAAc;cAAAC,QAAA,EAAC;YAEzC;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACL;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACzG,EAAA,CAtlBuBD,cAAc;AAAAyI,EAAA,GAAdzI,cAAc;AAAA,IAAAyI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}