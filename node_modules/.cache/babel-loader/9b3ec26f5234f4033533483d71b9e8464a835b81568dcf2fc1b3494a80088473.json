{"ast":null,"code":"import _objectWithoutProperties from\"C:/CA/Billing/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _toPropertyKey from\"C:/CA/Billing/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js\";import _objectSpread from\"C:/CA/Billing/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/BillingPanel.jsx\nimport React,{useEffect,useMemo,useRef,useState}from\"react\";import*as XLSX from\"xlsx\";import\"./BillingPanel.css\";import{apiBillingSuggest,apiCheckAvailability,apiPurchasesLast,apiCreateSaleFIFO,apiAccountsSuggest,apiAccountByMobile,apiAccountsSuggestName,apiAccountById}from\"./api\";// ---- helpers (scoped to panel) ----\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const emptyLine=()=>({itemName:\"\",qty:\"\",unitPrice:\"\",hsn:\"\",gst:\"\",unit:\"KG\"});const fmtDDMMYYYY=iso=>{const d=new Date(iso);const dd=String(d.getDate()).padStart(2,\"0\");const mm=String(d.getMonth()+1).padStart(2,\"0\");const yy=d.getFullYear();return\"\".concat(dd,\"-\").concat(mm,\"-\").concat(yy);};function toINR(n){const v=isNaN(n)?0:n;return v.toLocaleString(\"en-IN\",{minimumFractionDigits:2,maximumFractionDigits:2});}function numberToWordsIndian(num){const a=[\"\",\"One\",\"Two\",\"Three\",\"Four\",\"Five\",\"Six\",\"Seven\",\"Eight\",\"Nine\",\"Ten\",\"Eleven\",\"Twelve\",\"Thirteen\",\"Fourteen\",\"Fifteen\",\"Sixteen\",\"Seventeen\",\"Eighteen\",\"Nineteen\"];const b=[\"\",\"\",\"Twenty\",\"Thirty\",\"Forty\",\"Fifty\",\"Sixty\",\"Seventy\",\"Eighty\",\"Ninety\"];function inWords(n){if(n<20)return a[n];if(n<100)return b[Math.floor(n/10)]+(n%10?\" \"+a[n%10]:\"\");if(n<1000)return a[Math.floor(n/100)]+\" Hundred\"+(n%100?\" and \"+inWords(n%100):\"\");return\"\";}if(num===0)return\"Zero\";const parts=[];const units=[[\"Crore\",10000000],[\"Lakh\",100000],[\"Thousand\",1000],[\"\",1]];let n=Math.floor(num);for(const[label,value]of units){const q=Math.floor(n/value);if(q){if(value>=1000){if(q<100)parts.push(inWords(q)+\" \"+label);else parts.push(numberToWordsIndian(q)+\" \"+label);}else{parts.push(inWords(q));}n=n%value;}}return parts.join(\" \");}function escapeHtml(s){return String(s||\"\").replaceAll(\"&\",\"&amp;\").replaceAll(\"<\",\"&lt;\").replaceAll(\">\",\"&gt;\").replaceAll('\"',\"&quot;\").replaceAll(\"'\",\"&#039;\");}const normCode=v=>String(v||\"\").trim();const isSameState=(companyStateCode,customerStateCode)=>normCode(companyStateCode)!==\"\"&&normCode(customerStateCode)!==\"\"&&normCode(companyStateCode)===normCode(customerStateCode);// small numeric helper\nconst n=v=>isNaN(Number(v))||!v?0:Number(v);// Mobile-based typeahead (accounts_list)\n/** Billing panel */export default function BillingPanel(_ref){let{company,defaultBank,inventory}=_ref;// Buyer / consignee / meta\nconst[buyer,setBuyer]=useState({name:\"\",mobile:\"\",addr1:\"\",addr2:\"\",city:\"\",pin:\"\",state:\"\",stateCode:\"\",gstin:\"\",email:\"\",phone:\"\"});// Selected account (ledger)\nconst[selectedAccount,setSelectedAccount]=useState(null);// Account search\nconst[accQuery,setAccQuery]=useState(\"\");const[accSuggest,setAccSuggest]=useState([]);const accDebRef=useRef();const normalizeAccount=a=>{var _ref2,_a$name;return _objectSpread(_objectSpread({},a),{},{name:(_ref2=(_a$name=a.name)!==null&&_a$name!==void 0?_a$name:a.account_name)!==null&&_ref2!==void 0?_ref2:\"\"});};useEffect(()=>{clearTimeout(accDebRef.current);accDebRef.current=setTimeout(async()=>{const q=(accQuery||\"\").trim();if(q.length<2)return setAccSuggest([]);try{const rows=await apiAccountsSuggestName(q,10);setAccSuggest((rows||[]).map(normalizeAccount));}catch(_unused){setAccSuggest([]);}},180);return()=>clearTimeout(accDebRef.current);},[accQuery]);// Payments\nconst[advance,setAdvance]=useState(\"0\");// kept in state, but field hidden now\nconst[paymentMode,setPaymentMode]=useState(\"\");const paymentModes=[\"Select\",\"Cash\",\"UPI\",\"Card\",\"Bank Transfer\",\"Cheque\",\"Credit\",\"Online\"];// Split payments\nconst[splitEnabled,setSplitEnabled]=useState(false);const[split1,setSplit1]=useState({amount:\"\",mode:\"Select\",ref:\"\"});const[split2,setSplit2]=useState({amount:\"\",mode:\"Select\",ref:\"\"});const[consigneeDifferent,setConsigneeDifferent]=useState(false);const[consignee,setConsignee]=useState(_objectSpread({},buyer));useEffect(()=>{if(!consigneeDifferent)setConsignee(_objectSpread({},buyer));},[consigneeDifferent,buyer]);const todayIso=new Date().toISOString().slice(0,10);const[invMeta,setInvMeta]=useState({invoiceNo:\"PKS-B-00001\",date:todayIso,ewayNo:\"\",kms:\"\",fromDate:\"\",toDate:\"\",lrDate:todayIso});// lines + discount\nconst[lines,setLines]=useState([emptyLine()]);const[discountPct,setDiscountPct]=useState(\"0\");// Purchases-based type-ahead\nconst[suggest,setSuggest]=useState([]);// [{name}]\nconst[activeQuery,setActiveQuery]=useState(\"\");const debRef=useRef();useEffect(()=>{clearTimeout(debRef.current);debRef.current=setTimeout(async()=>{const q=(activeQuery||\"\").trim();if(!q)return setSuggest([]);try{const list=await apiBillingSuggest(q,25);setSuggest(list||[]);}catch(_unused2){setSuggest([]);}},180);return()=>clearTimeout(debRef.current);},[activeQuery]);const[mobileSuggest,setMobileSuggest]=useState([]);// rows from backend\nconst[mobileQuery,setMobileQuery]=useState(\"\");const mobDebRef=useRef();useEffect(()=>{clearTimeout(mobDebRef.current);mobDebRef.current=setTimeout(async()=>{const q=(mobileQuery||\"\").trim();if(q.length<2)return setMobileSuggest([]);try{const rows=await apiAccountsSuggest(q,10);setMobileSuggest((rows||[]).map(normalizeAccount));}catch(_unused3){setMobileSuggest([]);}},180);return()=>clearTimeout(mobDebRef.current);},[mobileQuery]);const[nameSuggest,setNameSuggest]=useState([]);const[nameQuery,setNameQuery]=useState(\"\");const nameDebRef=useRef();useEffect(()=>{clearTimeout(nameDebRef.current);nameDebRef.current=setTimeout(async()=>{const q=(nameQuery||\"\").trim();if(q.length<2)return setNameSuggest([]);try{const rows=await apiAccountsSuggestName(q,10);setNameSuggest((rows||[]).map(normalizeAccount));}catch(_unused4){setNameSuggest([]);}},180);return()=>clearTimeout(nameDebRef.current);},[nameQuery]);const pickName=async acc=>{fillBuyerFromAccount(acc);setNameSuggest([]);setNameQuery((acc===null||acc===void 0?void 0:acc.name)||\"\");};const pickAccount=async acc=>{if(!(acc!==null&&acc!==void 0&&acc.account_id))return;try{var _ref3,_full$name;const full=await apiAccountById(acc.account_id);if(!full)return;const normalized=_objectSpread(_objectSpread({},full),{},{name:(_ref3=(_full$name=full.name)!==null&&_full$name!==void 0?_full$name:full.account_name)!==null&&_ref3!==void 0?_ref3:\"\"});setSelectedAccount(normalized);fillBuyerFromAccount(normalized);setAccQuery(normalized.name);}catch(e){console.error(\"Account fetch failed\",e);}finally{setAccSuggest([]);}};const fillBuyerFromAccount=acc=>{if(!acc)return;setBuyer(b=>{var _acc$name,_acc$mobile,_acc$addr,_acc$addr2,_acc$city,_ref4,_acc$pin,_acc$state,_ref5,_acc$stateCode,_acc$gstin,_acc$email,_acc$phone;return _objectSpread(_objectSpread({},b),{},{name:(_acc$name=acc.name)!==null&&_acc$name!==void 0?_acc$name:b.name,mobile:(_acc$mobile=acc.mobile)!==null&&_acc$mobile!==void 0?_acc$mobile:b.mobile,addr1:(_acc$addr=acc.addr1)!==null&&_acc$addr!==void 0?_acc$addr:b.addr1,addr2:(_acc$addr2=acc.addr2)!==null&&_acc$addr2!==void 0?_acc$addr2:b.addr2,city:(_acc$city=acc.city)!==null&&_acc$city!==void 0?_acc$city:b.city,pin:String((_ref4=(_acc$pin=acc.pin)!==null&&_acc$pin!==void 0?_acc$pin:b.pin)!==null&&_ref4!==void 0?_ref4:\"\").replace(/[^0-9]/g,\"\"),state:(_acc$state=acc.state)!==null&&_acc$state!==void 0?_acc$state:b.state,stateCode:String((_ref5=(_acc$stateCode=acc.stateCode)!==null&&_acc$stateCode!==void 0?_acc$stateCode:b.stateCode)!==null&&_ref5!==void 0?_ref5:\"\").replace(/[^0-9]/g,\"\"),gstin:(_acc$gstin=acc.gstin)!==null&&_acc$gstin!==void 0?_acc$gstin:b.gstin,email:(_acc$email=acc.email)!==null&&_acc$email!==void 0?_acc$email:b.email,phone:(_acc$phone=acc.phone)!==null&&_acc$phone!==void 0?_acc$phone:b.phone});});};// per-line availability status: { exists, stock, can_deliver }\nconst[statuses,setStatuses]=useState({});const updateAvailability=async(idx,name,qty)=>{const vname=(name||\"\").trim();const q=Number(qty!==null&&qty!==void 0?qty:0);if(!vname){setStatuses(s=>_objectSpread(_objectSpread({},s),{},{[idx]:undefined}));return;}try{const st=await apiCheckAvailability(vname,Number.isFinite(q)?q:0);setStatuses(s=>_objectSpread(_objectSpread({},s),{},{[idx]:st}));}catch(_unused5){setStatuses(s=>_objectSpread(_objectSpread({},s),{},{[idx]:undefined}));}};const lookupFromInventory=val=>{const arr=Array.isArray(inventory)?inventory:[];const byLower=s=>String(s||\"\").toLowerCase();let found=arr.find(i=>byLower(i.name)===byLower(val));if(found){var _ref6,_ref7,_found$hsn,_ref8,_found$gst,_ref9,_found$unit,_ref10,_found$price;return{name:found.name,hsn:(_ref6=(_ref7=(_found$hsn=found.hsn)!==null&&_found$hsn!==void 0?_found$hsn:found[\"HSN\"])!==null&&_ref7!==void 0?_ref7:found[\"HSN CODE\"])!==null&&_ref6!==void 0?_ref6:\"\",gst:Number((_ref8=(_found$gst=found.gst)!==null&&_found$gst!==void 0?_found$gst:found[\"GST %\"])!==null&&_ref8!==void 0?_ref8:0)||0,unit:(_ref9=(_found$unit=found.unit)!==null&&_found$unit!==void 0?_found$unit:found[\"UNIT\"])!==null&&_ref9!==void 0?_ref9:\"KGS\",price:Number((_ref10=(_found$price=found.price)!==null&&_found$price!==void 0?_found$price:found[\"PRICE\"])!==null&&_ref10!==void 0?_ref10:0)||0};}const f2=arr.find(i=>byLower(i[\"ITEM NAME\"])===byLower(val));if(f2){var _ref11,_f2$HSN,_f2$GST,_f2$UNIT,_f2$PRICE;return{name:f2[\"ITEM NAME\"],hsn:(_ref11=(_f2$HSN=f2[\"HSN\"])!==null&&_f2$HSN!==void 0?_f2$HSN:f2[\"HSN CODE\"])!==null&&_ref11!==void 0?_ref11:\"\",gst:Number((_f2$GST=f2[\"GST %\"])!==null&&_f2$GST!==void 0?_f2$GST:0)||0,unit:(_f2$UNIT=f2[\"UNIT\"])!==null&&_f2$UNIT!==void 0?_f2$UNIT:\"KGS\",price:Number((_f2$PRICE=f2[\"PRICE\"])!==null&&_f2$PRICE!==void 0?_f2$PRICE:0)||0};}return null;};const handleItemChange=async(idx,val)=>{var _lines$idx;setActiveQuery(val);let picked=null;try{if((val||\"\").trim()){picked=await apiPurchasesLast(val.trim());}}catch(_unused6){/* ignore */}if(!picked){const item=lookupFromInventory(val);picked=item?{name:item.name,hsn:item.hsn||\"\",price:Number(item.price||0),gst:Number(item.gst||0),stockQty:0}:null;}setLines(prev=>{const next=prev.map((r,i)=>{var _picked$hsn,_picked,_picked$price,_picked2,_picked$gst,_picked3;return i!==idx?r:_objectSpread(_objectSpread({},r),{},{itemName:val,hsn:(_picked$hsn=(_picked=picked)===null||_picked===void 0?void 0:_picked.hsn)!==null&&_picked$hsn!==void 0?_picked$hsn:r.hsn,unit:\"KG\",unitPrice:String((_picked$price=(_picked2=picked)===null||_picked2===void 0?void 0:_picked2.price)!==null&&_picked$price!==void 0?_picked$price:r.unitPrice),gst:String((_picked$gst=(_picked3=picked)===null||_picked3===void 0?void 0:_picked3.gst)!==null&&_picked$gst!==void 0?_picked$gst:r.gst)});});const isNonEmpty=!!(next[idx].itemName||next[idx].qty);const hasBlank=next.length&&!next[next.length-1].itemName&&!next[next.length-1].qty;if(isNonEmpty&&!hasBlank)next.push(emptyLine());return next;});const qtyNow=Number(((_lines$idx=lines[idx])===null||_lines$idx===void 0?void 0:_lines$idx.qty)||0);updateAvailability(idx,val,qtyNow);setSuggest([]);};const handleQty=(idx,v)=>{var _lines$idx2;const clean=String(v).replace(/[^0-9.]/g,\"\");setLines(prev=>{const next=prev.map((r,i)=>i!==idx?r:_objectSpread(_objectSpread({},r),{},{qty:clean}));const isNonEmpty=!!(next[idx].itemName||clean);const hasBlank=next.length&&!next[next.length-1].itemName&&!next[next.length-1].qty;if(isNonEmpty&&!hasBlank)next.push(emptyLine());return next;});updateAvailability(idx,((_lines$idx2=lines[idx])===null||_lines$idx2===void 0?void 0:_lines$idx2.itemName)||\"\",clean);};const handlePrice=(idx,v)=>setLines(prev=>prev.map((r,i)=>i!==idx?r:_objectSpread(_objectSpread({},r),{},{unitPrice:String(v).replace(/[^0-9.]/g,\"\")})));const handleHSN=(idx,v)=>setLines(prev=>prev.map((r,i)=>i!==idx?r:_objectSpread(_objectSpread({},r),{},{hsn:v})));const handleGST=(idx,v)=>setLines(prev=>prev.map((r,i)=>i!==idx?r:_objectSpread(_objectSpread({},r),{},{gst:String(v).replace(/[^0-9.]/g,\"\")})));const handleUnit=(idx,v)=>setLines(prev=>prev.map((r,i)=>i!==idx?r:_objectSpread(_objectSpread({},r),{},{unit:v})));const addRow=()=>setLines(prev=>[...prev,emptyLine()]);const removeRow=idx=>{setLines(prev=>prev.filter((_,i)=>i!==idx));setStatuses(s=>{const{[idx]:_omit}=s,rest=_objectWithoutProperties(s,[idx].map(_toPropertyKey));return rest;});};// ============ totals (with GST rounding) ============\nconst computed=useMemo(()=>{const filled=lines.filter(l=>l.itemName&&Number(l.qty)>0);const baseRows=filled.map(l=>{const qty=Number(l.qty||0);const rate=Number(l.unitPrice||0);const gstRate=Number(l.gst||0);const lineTaxable=qty*rate;return _objectSpread(_objectSpread({},l),{},{qty,rate,gstRate,lineTaxable});});const taxable=baseRows.reduce((s,r)=>s+r.lineTaxable,0);const pct=Math.max(0,Number(discountPct||0));const discountAmount=+(taxable*(pct/100)).toFixed(2);const discountedTaxable=+(taxable-discountAmount).toFixed(2);const factor=taxable>0?1-pct/100:1;let cgstRaw=0,sgstRaw=0,igstRaw=0;baseRows.forEach(r=>{const discLineTaxable=r.lineTaxable*factor;const lineGST=discLineTaxable*(r.gstRate/100);if((buyer.stateCode||\"\").trim()!==((company===null||company===void 0?void 0:company.stateCode)||\"\").trim()){igstRaw+=lineGST;}else{cgstRaw+=lineGST/2;sgstRaw+=lineGST/2;}});const rawGSTTotal=cgstRaw+sgstRaw+igstRaw;const roundRupee=x=>Math.round(x);const isInter=(buyer.stateCode||\"\").trim()!==((company===null||company===void 0?void 0:company.stateCode)||\"\").trim();const cgstRounded=isInter?0:roundRupee(cgstRaw);const sgstRounded=isInter?0:roundRupee(sgstRaw);const igstRounded=isInter?roundRupee(igstRaw):0;const gstRounded=isInter?igstRounded:cgstRounded+sgstRounded;const roundOff=+(gstRounded-rawGSTTotal).toFixed(2);const total=+(discountedTaxable+gstRounded).toFixed(2);const grand=total;return{rows:baseRows,taxable,discountAmount,discountedTaxable,rawGSTTotal,cgstRounded,sgstRounded,igstRounded,gstRounded,roundOff,total,grand};},[lines,discountPct,buyer.stateCode,company===null||company===void 0?void 0:company.stateCode]);const isInterState=useMemo(()=>(buyer.stateCode||\"\").trim()!==((company===null||company===void 0?void 0:company.stateCode)||\"\").trim(),[buyer.stateCode,company===null||company===void 0?void 0:company.stateCode]);// Split: paid now & balance\nconst paidNow=useMemo(()=>{const s1=splitEnabled?n(split1.amount):0;const s2=splitEnabled?n(split2.amount):0;return n(advance)+s1+s2;},[advance,splitEnabled,split1.amount,split2.amount]);const balanceAfterSplits=useMemo(()=>Math.max(0,+(computed.grand-paidNow).toFixed(2)),[computed.grand,paidNow]);// ====== Export Excel (with split details) ======\nconst exportExcel=()=>{const consigneeForExcel=consigneeDifferent?consignee:buyer;const pct=Math.max(0,Number(discountPct||0));const factor=1-pct/100;const invoiceAdvance=n(advance);const split1Amt=splitEnabled?n(split1.amount):0;const split2Amt=splitEnabled?n(split2.amount):0;const invoicePaidNow=invoiceAdvance+split1Amt+split2Amt;const invoiceBalance=+(computed.grand-invoicePaidNow).toFixed(2);const rows=(computed.rows.length?computed.rows:[]).map((r,idx)=>{const lineTaxableDisc=+(r.lineTaxable*factor).toFixed(2);const lineGSTRaw=lineTaxableDisc*(r.gstRate/100);const cgstP=isInterState?0:r.gstRate/2;const sgstP=isInterState?0:r.gstRate/2;const igstP=isInterState?r.gstRate:0;const totalVal=lineTaxableDisc+lineGSTRaw;const roundOffForRow=idx===0?computed.roundOff:0;return{\"VOUCHER TYPE\":\"Sales\",DATE:fmtDDMMYYYY(invMeta.date),\"VOUCHER NUMBER\":invMeta.invoiceNo,\"PARTY NAME\":buyer.name||\"\",GSTIN:buyer.gstin||\"\",ADDRESS:\"\".concat(buyer.addr1||\"\",\" \").concat(buyer.addr2||\"\").trim(),STATE:buyer.state||\"\",\"BUYER CITYPIN\":buyer.city||\"\",\"BUYER STATE CODE\":buyer.stateCode||\"\",\"CONSIGNEE NAME\":consigneeForExcel.name||\"\",\"CONSIGNEE ADDRESS\":\"\".concat(consigneeForExcel.addr1||\"\",\" \").concat(consigneeForExcel.addr2||\"\").trim(),\"CONSIGNEE CITYPIN\":consigneeForExcel.city||\"\",\"CONSIGNEE STATE\":consigneeForExcel.state||\"\",\"CONSIGNEE STATE CODE\":consigneeForExcel.stateCode||\"\",\"ITEM NAME\":r.itemName||\"\",\"HSN CODE\":r.hsn||\"\",QTY:r.qty||0,UOM:r.unit||\"KG\",RATE:r.rate||0,\"TAXABLE VALUE\":+lineTaxableDisc.toFixed(2),\"CGST %\":cgstP,\"SGST %\":sgstP,\"IGST %\":igstP,\"TOTAL VALUE\":+totalVal.toFixed(2),NARRATION:paymentMode?\"Sale of goods \\u2014 Payment: \".concat(paymentMode)+(splitEnabled?\"; Split1 \".concat(split1Amt,\" \").concat(split1.mode).concat(split1.ref?\" (\"+split1.ref+\")\":\"\",\"; Split2 \").concat(split2Amt,\" \").concat(split2.mode).concat(split2.ref?\" (\"+split2.ref+\")\":\"\"):\"\"):splitEnabled?\"Sale of goods \\u2014 Split1 \".concat(split1Amt,\" \").concat(split1.mode).concat(split1.ref?\" (\"+split1.ref+\")\":\"\",\"; Split2 \").concat(split2Amt,\" \").concat(split2.mode).concat(split2.ref?\" (\"+split2.ref+\")\":\"\"):\"Sale of goods\",\"ROUND OFF\":roundOffForRow,\"PLACE OF SUPPLY\":buyer.state||\"\",\"TERMS OF PAYMENT\":paymentMode||\"\",\"EWAY BILL NO\":invMeta.ewayNo||\"\",\"LR DATE\":invMeta.lrDate||\"\",\"INV TAXABLE TOTAL\":+computed.taxable.toFixed(2),\"INV DISCOUNT %\":pct,\"INV DISCOUNT AMOUNT\":+computed.discountAmount.toFixed(2),\"INV TAXABLE AFTER DISC\":+computed.discountedTaxable.toFixed(2),\"INV GST TOTAL\":+computed.gstRounded.toFixed(2),\"INV ROUND OFF\":+computed.roundOff.toFixed(2),\"INV GRAND TOTAL\":+computed.grand.toFixed(2),\"INV ADVANCE\":invoiceAdvance,\"INV SPLIT1 AMT\":split1Amt,\"INV SPLIT1 MODE\":splitEnabled?split1.mode:\"\",\"INV SPLIT1 REF\":splitEnabled?split1.ref:\"\",\"INV SPLIT2 AMT\":split2Amt,\"INV SPLIT2 MODE\":splitEnabled?split2.mode:\"\",\"INV SPLIT2 REF\":splitEnabled?split2.ref:\"\",\"INV PAID NOW\":invoicePaidNow,\"INV BALANCE\":invoiceBalance};});const data=rows.length>0?rows:[{\"VOUCHER TYPE\":\"Sales\",DATE:fmtDDMMYYYY(invMeta.date),\"VOUCHER NUMBER\":invMeta.invoiceNo,\"PARTY NAME\":buyer.name||\"\",GSTIN:buyer.gstin||\"\",ADDRESS:\"\".concat(buyer.addr1||\"\",\" \").concat(buyer.addr2||\"\").trim(),STATE:buyer.state||\"\",\"BUYER CITYPIN\":buyer.city||\"\",\"BUYER STATE CODE\":buyer.stateCode||\"\",\"CONSIGNEE NAME\":consigneeForExcel.name||\"\",\"CONSIGNEE ADDRESS\":\"\".concat(consigneeForExcel.addr1||\"\",\" \").concat(consigneeForExcel.addr2||\"\").trim(),\"CONSIGNEE CITYPIN\":consigneeForExcel.city||\"\",\"CONSIGNEE STATE\":consigneeForExcel.state||\"\",\"CONSIGNEE STATE CODE\":consigneeForExcel.stateCode||\"\",\"ITEM NAME\":\"\",\"HSN CODE\":\"\",QTY:0,UOM:\"KGS\",RATE:0,\"TAXABLE VALUE\":0,\"CGST %\":0,\"SGST %\":0,\"IGST %\":0,\"TOTAL VALUE\":0,NARRATION:paymentMode?\"Sale of goods \\u2014 Payment: \".concat(paymentMode):\"Sale of goods\",\"ROUND OFF\":computed.roundOff||0,\"PLACE OF SUPPLY\":buyer.state||\"\",\"TERMS OF PAYMENT\":paymentMode||\"\",\"EWAY BILL NO\":invMeta.ewayNo||\"\",\"LR DATE\":invMeta.lrDate||\"\",\"INV TAXABLE TOTAL\":+computed.taxable.toFixed(2),\"INV DISCOUNT %\":pct,\"INV DISCOUNT AMOUNT\":+computed.discountAmount.toFixed(2),\"INV TAXABLE AFTER DISC\":+computed.discountedTaxable.toFixed(2),\"INV GST TOTAL\":+computed.gstRounded.toFixed(2),\"INV ROUND OFF\":+computed.roundOff.toFixed(2),\"INV GRAND TOTAL\":+computed.grand.toFixed(2),\"INV ADVANCE\":invoiceAdvance,\"INV SPLIT1 AMT\":split1Amt,\"INV SPLIT1 MODE\":splitEnabled?split1.mode:\"\",\"INV SPLIT1 REF\":splitEnabled?split1.ref:\"\",\"INV SPLIT2 AMT\":split2Amt,\"INV SPLIT2 MODE\":splitEnabled?split2.mode:\"\",\"INV SPLIT2 REF\":splitEnabled?split2.ref:\"\",\"INV PAID NOW\":invoicePaidNow,\"INV BALANCE\":invoiceBalance}];const ws=XLSX.utils.json_to_sheet(data,{header:[\"VOUCHER TYPE\",\"DATE\",\"VOUCHER NUMBER\",\"PARTY NAME\",\"GSTIN\",\"ADDRESS\",\"STATE\",\"BUYER CITYPIN\",\"BUYER STATE CODE\",\"CONSIGNEE NAME\",\"CONSIGNEE ADDRESS\",\"CONSIGNEE CITYPIN\",\"CONSIGNEE STATE\",\"CONSIGNEE STATE CODE\",\"ITEM NAME\",\"HSN CODE\",\"QTY\",\"UOM\",\"RATE\",\"TAXABLE VALUE\",\"CGST %\",\"SGST %\",\"IGST %\",\"TOTAL VALUE\",\"NARRATION\",\"ROUND OFF\",\"PLACE OF SUPPLY\",\"TERMS OF PAYMENT\",\"EWAY BILL NO\",\"LR DATE\",\"INV TAXABLE TOTAL\",\"INV DISCOUNT %\",\"INV DISCOUNT AMOUNT\",\"INV TAXABLE AFTER DISC\",\"INV GST TOTAL\",\"INV ROUND OFF\",\"INV GRAND TOTAL\",\"INV ADVANCE\",\"INV SPLIT1 AMT\",\"INV SPLIT1 MODE\",\"INV SPLIT1 REF\",\"INV SPLIT2 AMT\",\"INV SPLIT2 MODE\",\"INV SPLIT2 REF\",\"INV PAID NOW\",\"INV BALANCE\"]});const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,\"Invoice\");const fileName=\"Invoice_\".concat(invMeta.invoiceNo.replace(/[\\/\\\\:*?\"<>|]/g,\"-\"),\".xlsx\");XLSX.writeFile(wb,fileName);};// ===================== PRINT (with split payment details) =====================\nconst printNow=()=>{var _buyer$pin,_buyer$pin$trim;const missing=[];if(!buyer.name.trim())missing.push(\"Buyer Name\");if(!buyer.addr1.trim())missing.push(\"Buyer Address 1\");if(!buyer.city.trim())missing.push(\"Buyer City\");if(!((_buyer$pin=buyer.pin)!==null&&_buyer$pin!==void 0&&(_buyer$pin$trim=_buyer$pin.trim)!==null&&_buyer$pin$trim!==void 0&&_buyer$pin$trim.call(_buyer$pin)))missing.push(\"Buyer PIN\");if(missing.length){alert(\"Please fill mandatory fields:\\n\"+missing.join(\"\\n\"));return;}const issues=[];lines.forEach((l,i)=>{if(!l.itemName||!Number(l.qty))return;const st=statuses[i];if(!(st!==null&&st!==void 0&&st.exists))issues.push(\"Row \".concat(i+1,\": Item not found in inventory\"));else if(!(st!==null&&st!==void 0&&st.can_deliver))issues.push(\"Row \".concat(i+1,\": Only \").concat(st.stock,\" in stock\"));});if(issues.length){alert(\"Please fix before printing:\\n\"+issues.join(\"\\n\"));return;}const wnd=window.open(\"\",\"_blank\");if(!wnd)return;const useConsignee=consigneeDifferent?consignee:buyer;const fmtL=d=>new Date(d).toLocaleDateString(\"en-IN\",{day:\"2-digit\",month:\"short\",year:\"numeric\"});// build invoice rows for print\nconst rowHtmlArr=(computed.rows.length?computed.rows:[]).map((r,i)=>{const pct=Math.max(0,Number(discountPct||0));const factor=1-pct/100;const lineBase=r.lineTaxable;const lineTaxableDisc=+(r.lineTaxable*factor).toFixed(2);const amountWithTaxRaw=lineTaxableDisc+lineTaxableDisc*r.gstRate/100;const taxLabel=r.gstRate?isInterState?\"\".concat(r.gstRate,\"% IGST\"):\"\".concat((r.gstRate/2).toFixed(0),\"% + \").concat((r.gstRate/2).toFixed(0),\"%\"):\"-\";return\"\\n        <tr>\\n          <td class=\\\"c\\\">\".concat(i+1,\"</td>\\n          <td>\").concat(escapeHtml(r.itemName),\"</td>\\n          <td class=\\\"c\\\">\").concat(escapeHtml(r.hsn||\"\"),\"</td>\\n          <td class=\\\"r\\\">\").concat(r.qty,\"</td>\\n          <td class=\\\"c\\\">\").concat(escapeHtml(r.unit||\"KGS\"),\"</td>\\n          <td class=\\\"r\\\">\").concat(toINR(r.rate),\"</td>\\n          <td class=\\\"r\\\">\").concat(toINR(lineBase),\"</td>\\n          <td class=\\\"c\\\">\").concat(taxLabel,\"</td>\\n          <td class=\\\"r\\\">\").concat(toINR(amountWithTaxRaw),\"</td>\\n        </tr>\");});// pad rows to fixed count (10)\nconst TARGET_ROWS=10;const blankCount=Math.max(0,TARGET_ROWS-rowHtmlArr.length);for(let k=0;k<blankCount;k++){rowHtmlArr.push(\"\\n        <tr>\\n          <td class=\\\"c\\\">&nbsp;</td>\\n          <td>&nbsp;</td>\\n          <td class=\\\"c\\\">&nbsp;</td>\\n          <td class=\\\"r\\\">&nbsp;</td>\\n          <td class=\\\"c\\\">&nbsp;</td>\\n          <td class=\\\"r\\\">&nbsp;</td>\\n          <td class=\\\"r\\\">&nbsp;</td>\\n          <td class=\\\"c\\\">&nbsp;</td>\\n          <td class=\\\"r\\\">&nbsp;</td>\\n        </tr>\");}const rowsHtml=rowHtmlArr.join(\"\")||\"<tr><td colspan=\\\"9\\\" class=\\\"c muted\\\">No items</td></tr>\";const cssHref=Array.from(document.styleSheets).map(s=>s.href).filter(Boolean).find(h=>h.includes(\"BillingPanel.css\"))||\"BillingPanel.css\";// totals used in print\nconst adv=paidNow;// advance + split payments\nconst balanceDue=balanceAfterSplits;// NEW: split details rows\nconst splitLinesHtml=splitEnabled?\"\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\">Split #1 (\".concat(escapeHtml(split1.mode||\"-\"),\")</td><td class=\\\"r\\\">\").concat(toINR(n(split1.amount)),\"</td></tr>\\n            \").concat(n(split2.amount)>0?\"<tr><td colspan=\\\"8\\\" class=\\\"r\\\">Split #2 (\".concat(escapeHtml(split2.mode||\"-\"),\")</td><td class=\\\"r\\\">\").concat(toINR(n(split2.amount)),\"</td></tr>\"):\"\",\"\\n        \"):\"\";const html=\"<!doctype html><html><head><meta charset=\\\"utf-8\\\" />\\n      <title>Tax Invoice</title>\\n      <link rel=\\\"stylesheet\\\" href=\\\"\".concat(cssHref,\"\\\">\\n      <style>\\n        @page { size: A4; margin: 10mm; }\\n        @media print {\\n          html, body { width: 210mm; }\\n          .shell { border: 0; padding: 0; }\\n          table { page-break-inside: auto; }\\n          tr { page-break-inside: avoid; break-inside: avoid; }\\n          thead { display: table-header-group; }\\n          tfoot { display: table-footer-group; }\\n        }\\n        body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:16px}\\n        .small{font-size:12px;color:#555}\\n        .muted{color:#6b7280}\\n        .r{text-align:right}.c{text-align:center}\\n        .shell{border:1px solid #111; padding:12px}\\n        .grid{display:grid; grid-template-columns: 1.2fr .9fr; gap:12px}\\n        .box{border:1px solid #111; padding:8px}\\n        .two{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:8px}\\n        .foot{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px}\\n        .hr{border-top:1px solid #ddd; margin:6px 0}\\n        table{width:100%; border-collapse:collapse; margin-top:8px}\\n        th,td{border:1px solid #111; padding:6px; font-size:13px}\\n        th{background:#f9fafb; white-space:nowrap}\\n        td:nth-child(2){word-break:break-word}\\n        tbody tr:nth-child(odd){background:#fcfcfc}\\n      </style>\\n    </head>\\n    <body class=\\\"invoice-print\\\">\\n      <div class=\\\"shell\\\">\\n        <div class=\\\"grid\\\">\\n          <div class=\\\"box\\\">\\n            <div style=\\\"display:flex;justify-content:space-between;align-items:center\\\">\\n              <div>\\n                <div style=\\\"font-size:18px;font-weight:700\\\">\").concat(escapeHtml((company===null||company===void 0?void 0:company.name)||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml((company===null||company===void 0?void 0:company.addr1)||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml((company===null||company===void 0?void 0:company.addr2)||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml((company===null||company===void 0?void 0:company.city)||\"\"),\"</div>\\n                <div class=\\\"small\\\">State: \").concat(escapeHtml((company===null||company===void 0?void 0:company.state)||\"-\"),\", Code: \").concat(escapeHtml((company===null||company===void 0?void 0:company.stateCode)||\"-\"),\"</div>\\n                <div class=\\\"small\\\">GSTIN/UIN: \").concat(escapeHtml((company===null||company===void 0?void 0:company.gstin)||\"-\"),\"</div>\\n                \").concat(company!==null&&company!==void 0&&company.email?\"<div class=\\\"small\\\">E-Mail : \".concat(escapeHtml(company.email),\"</div>\"):\"\",\"\\n                \").concat(company!==null&&company!==void 0&&company.mobile||company!==null&&company!==void 0&&company.phone||company!==null&&company!==void 0&&company.whatsapp?\"<div class=\\\"small\\\">Phone : \".concat(escapeHtml([company.mobile,company.phone].filter(Boolean).join(\" / \"))).concat(company!==null&&company!==void 0&&company.whatsapp?\" | WhatsApp: \"+escapeHtml(company.whatsapp):\"\",\"</div>\"):\"\",\"\\n              </div>\\n              <div style=\\\"font-size:12px;font-weight:700\\\">Tax invoice</div>\\n            </div>\\n\\n            <div class=\\\"two\\\">\\n              <div class=\\\"box\\\">\\n                <div style=\\\"font-weight:600;font-size:12px\\\">Consignee (Ship To)</div>\\n                <div style=\\\"font-weight:600\\\">\").concat(escapeHtml(useConsignee.name||\"-\"),\"</div>\\n                \\n                <div class=\\\"small\\\">\").concat(escapeHtml(useConsignee.addr1||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml(useConsignee.addr2||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml(useConsignee.city||\"\"),\"</div>\\n                <div class=\\\"small\\\">State: \").concat(escapeHtml(useConsignee.state||\"-\"),\", Code: \").concat(escapeHtml(useConsignee.stateCode||\"-\"),\"</div>\\n                <div class=\\\"small\\\">GSTIN/UIN: \").concat(escapeHtml(useConsignee.gstin||\"-\"),\"</div>\\n              </div>\\n              <div class=\\\"box\\\">\\n                <div style=\\\"font-weight:600;font-size:12px\\\">Buyer (Bill To)</div>\\n                <div style=\\\"font-weight:600\\\">\").concat(escapeHtml(buyer.name||\"-\"),\"</div>\\n                  \").concat(buyer.mobile?\"<div class=\\\"small\\\">Mobile: \".concat(escapeHtml(buyer.mobile),\"</div>\"):\"\",\"\\n                \\n                <div class=\\\"small\\\">\").concat(escapeHtml(buyer.addr1||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml(buyer.addr2||\"\"),\"</div>\\n                <div class=\\\"small\\\">\").concat(escapeHtml(buyer.city||\"\"),\"</div>\\n                <div class=\\\"small\\\">State: \").concat(escapeHtml(buyer.state||\"-\"),\", Code: \").concat(escapeHtml(buyer.stateCode||\"-\"),\"</div>\\n                <div class=\\\"small\\\">GSTIN/UIN: \").concat(escapeHtml(buyer.gstin||\"-\"),\"</div>\\n              </div>\\n            </div>\\n          </div>\\n\\n          <div class=\\\"box\\\">\\n            <table>\\n              <tbody>\\n                <tr><td style=\\\"width:45%\\\">Invoice No</td><td>\").concat(escapeHtml(invMeta.invoiceNo),\"</td></tr>\\n                <tr><td>Date</td><td>\").concat(fmtL(invMeta.date),\"</td></tr>\\n                <tr><td>Terms of Payment</td><td>\").concat(escapeHtml(paymentMode||\"-\"),\"</td></tr>\\n                <tr><td>e-Way Bill No</td><td>\").concat(escapeHtml(invMeta.ewayNo||\"-\"),\"</td></tr>\\n                <tr><td>LR / Date</td><td>\").concat(escapeHtml(invMeta.lrDate||\"-\"),\"</td></tr>\\n                <tr><td>Vehicle No</td><td>\").concat(escapeHtml(invMeta.vehicleNo||\"-\"),\"</td></tr>\\n              </tbody>\\n            </table>\\n          </div>\\n        </div>\\n\\n        <table style=\\\"margin-top:8px\\\">\\n          <thead>\\n            <tr>\\n              <th style=\\\"width:36px\\\">S.No</th>\\n              <th>Description of Goods</th>\\n              <th>HSN/SAC</th>\\n              <th class=\\\"r\\\">Quantity</th>\\n              <th>Unit</th>\\n              <th class=\\\"r\\\">Rate</th>\\n              <th class=\\\"r\\\">Price</th>\\n              <th class=\\\"c\\\">GST %</th>\\n              <th class=\\\"r\\\">Amount</th>\\n            </tr>\\n          </thead>\\n\\n          <tbody>\\n            \").concat(rowsHtml,\"\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\"><b>Taxable Value</b></td><td class=\\\"r\\\"><b>\").concat(toINR(computed.taxable),\"</b></td></tr>\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\">Discount (\").concat(Number(discountPct||0),\"%)</td><td class=\\\"r\\\">-\").concat(toINR(computed.discountAmount),\"</td></tr>\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\">Taxable After Discount</td><td class=\\\"r\\\">\").concat(toINR(computed.discountedTaxable),\"</td></tr>\\n            \").concat(isInterState?\"<tr><td colspan=\\\"8\\\" class=\\\"r\\\"><b>IGST (rounded)</b></td><td class=\\\"r\\\"><b>\".concat(toINR(computed.igstRounded),\"</b></td></tr>\"):\"<tr><td colspan=\\\"8\\\" class=\\\"r\\\">CGST (rounded)</td><td class=\\\"r\\\">\".concat(toINR(computed.cgstRounded),\"</td></tr>\\n                   <tr><td colspan=\\\"8\\\" class=\\\"r\\\">SGST (rounded)</td><td class=\\\"r\\\">\").concat(toINR(computed.sgstRounded),\"</td></tr>\"),\"\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\">Round Off (GST rounding)</td><td class=\\\"r\\\">\").concat(toINR(computed.roundOff),\"</td></tr>\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\"><b>Total</b></td><td class=\\\"r\\\"><b>\").concat(toINR(computed.total),\"</b></td></tr>\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\"><b>Grand Total</b></td><td class=\\\"r\\\"><b>\").concat(toINR(computed.grand),\"</b></td></tr>\\n\\n            \").concat(splitLinesHtml,\"\\n\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\">Advance / Received</td><td class=\\\"r\\\">-\").concat(toINR(adv),\"</td></tr>\\n            <tr><td colspan=\\\"8\\\" class=\\\"r\\\"><b>Balance Due</b></td><td class=\\\"r\\\"><b>\").concat(toINR(balanceDue),\"</b></td></tr>\\n          </tbody>\\n        </table>\\n\\n        <div class=\\\"foot\\\">\\n          <div class=\\\"box\\\">\\n            <div><b>Amount Chargeable (in words)</b></div>\\n            <div class=\\\"small\\\" style=\\\"margin-top:4px\\\">INR \").concat(numberToWordsIndian(Math.round(computed.grand)),\" Only</div>\\n            <div class=\\\"hr\\\"></div>\\n            <div class=\\\"small\\\"><b>Tax Amount (in words)</b></div>\\n            <div class=\\\"small\\\">INR \").concat(numberToWordsIndian(Math.round(computed.gstRounded)),\" Only</div>\\n          </div>\\n          <div class=\\\"box\\\">\\n            <div class=\\\"small\\\"><b>Company's Bank Details</b></div>\\n            \").concat(defaultBank?\"\\n              <div class=\\\"small\\\">Bank : \".concat(escapeHtml(defaultBank.bankName||\"\"),\"</div>\\n              <div class=\\\"small\\\">Branch & IFSC : \").concat(escapeHtml(defaultBank.branch||\"\"),\" & \").concat(escapeHtml(defaultBank.ifsc||\"\"),\"</div>\\n              <div class=\\\"small\\\">A/C No : \").concat(escapeHtml(defaultBank.account||\"\"),\"</div>\"):\"<div class=\\\"small\\\">No bank selected</div>\",\"\\n            <div class=\\\"hr\\\"></div>\\n            <div class=\\\"small c\\\">For \").concat(escapeHtml((company===null||company===void 0?void 0:company.name)||\"\"),\"</div>\\n            <div style=\\\"height:48px\\\"></div>\\n            <div class=\\\"small r\\\">Authorised Signatory</div>\\n          </div>\\n        </div>\\n\\n        <div class=\\\"small\\\" style=\\\"margin-top:8px\\\">\\n          <b>Declaration:</b> We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct.\\n          <div>SUBJECT TO TRICHY JURISDICTION</div>\\n        </div>\\n      </div>\\n      <script>window.onload = () => window.print();</script>\\n    </body></html>\");wnd.document.write(html);wnd.document.close();};// ================= UI =================\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"billing-full card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-4\",style:{marginTop:6},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Invoice No.\"}),/*#__PURE__*/_jsx(\"input\",{value:invMeta.invoiceNo,onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{invoiceNo:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:invMeta.date,onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{date:e.target.value}))})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",gap:\"20px\",alignItems:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"meta-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"meta-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"eWay Bill No\"}),/*#__PURE__*/_jsx(\"input\",{value:invMeta.ewayNo,onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{ewayNo:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"KMs\"}),/*#__PURE__*/_jsx(\"input\",{value:invMeta.kms||\"\",onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{kms:e.target.value.replace(/[^0-9]/g,\"\")}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"From Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:invMeta.fromDate||\"\",onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{fromDate:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"To Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:invMeta.toDate||\"\",onChange:e=>setInvMeta(m=>_objectSpread(_objectSpread({},m),{},{toDate:e.target.value}))})]})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Buyer (Bill To)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-4\",style:{marginTop:6},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row-2\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.name,onChange:e=>{const v=e.target.value;setBuyer(b=>_objectSpread(_objectSpread({},b),{},{name:v}));setNameQuery(v);},onFocus:()=>setNameQuery(buyer.name||\" \"),placeholder:\"Type buyer name...\",autoComplete:\"off\"}),nameSuggest.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:\"100%\",left:0,right:0,background:\"#fff\",border:\"1px solid #ddd\",zIndex:50,maxHeight:220,overflowY:\"auto\",borderRadius:8},children:nameSuggest.map((a,idx)=>/*#__PURE__*/_jsxs(\"div\",{onMouseDown:e=>{e.preventDefault();// IMPORTANT: prevents blur before click\npickName(a);},style:{padding:\"8px 10px\",cursor:\"pointer\",borderBottom:\"1px solid #f1f1f1\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600},children:a.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#666\"},children:[a.mobile?\"\\uD83D\\uDCF1 \".concat(a.mobile):\"\",a.city?\" \\u2022 \".concat(a.city):\"\"]})]},\"\".concat(a.mobile||\"\",\"-\").concat(idx)))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Mobile No.\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",list:\"mobile-suggest\",placeholder:\"10-digit mobile\",value:buyer.mobile,onChange:async e=>{const v=String(e.target.value).replace(/[^0-9]/g,\"\").slice(0,10);setBuyer(b=>_objectSpread(_objectSpread({},b),{},{mobile:v}));setMobileQuery(v);// when full 10 digits â†’ autofill\nif(v.length===10){try{const acc=await apiAccountByMobile(v);if(acc)fillBuyerFromAccount(acc);}catch(_unused7){}setMobileSuggest([]);}},onBlur:async()=>{const v=(buyer.mobile||\"\").trim();if(v.length===10){try{const acc=await apiAccountByMobile(v);if(acc)fillBuyerFromAccount(acc);}catch(_unused8){}}setMobileSuggest([]);}}),/*#__PURE__*/_jsx(\"datalist\",{id:\"mobile-suggest\",children:mobileSuggest.map((a,idx)=>/*#__PURE__*/_jsx(\"option\",{value:a.mobile,children:a.name?\"\".concat(a.name,\" - \").concat(a.mobile):a.mobile},\"\".concat(a.mobile,\"-\").concat(idx)))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"GSTIN / UIN\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.gstin,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{gstin:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Account (Ledger)\"}),/*#__PURE__*/_jsx(\"input\",{value:accQuery,onChange:e=>{setAccQuery(e.target.value);setSelectedAccount(null);},onFocus:()=>{if(accQuery.length===0)setAccSuggest([]);},placeholder:\"Search account\\u2026\",autoComplete:\"off\"}),accSuggest.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:\"100%\",left:0,right:0,background:\"#fff\",border:\"1px solid #ddd\",zIndex:60,maxHeight:220,overflowY:\"auto\",borderRadius:8},children:accSuggest.map((a,idx)=>/*#__PURE__*/_jsxs(\"div\",{onMouseDown:e=>{e.preventDefault();// prevent blur\npickAccount(a);},style:{padding:\"8px 10px\",cursor:\"pointer\",borderBottom:\"1px solid #f1f1f1\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600},children:a.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,color:\"#666\"},children:[\"ID: \",a.account_id,a.mobile?\" \\u2022 \\uD83D\\uDCF1 \".concat(a.mobile):\"\"]})]},\"\".concat(a.account_id,\"-\").concat(idx)))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.state,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{state:e.target.value})),placeholder:\"Tamil Nadu\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"State Code\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.stateCode,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{stateCode:String(e.target.value).replace(/[^0-9]/g,\"\")})),placeholder:\"33\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address 1 *\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.addr1,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{addr1:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address 2\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.addr2,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{addr2:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"City *\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.city,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"PIN *\"}),/*#__PURE__*/_jsx(\"input\",{value:buyer.pin,onChange:e=>setBuyer(b=>_objectSpread(_objectSpread({},b),{},{pin:String(e.target.value).replace(/[^0-9]/g,\"\")}))})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stack\",style:{marginTop:4},children:[/*#__PURE__*/_jsxs(\"label\",{className:\"small\",style:{display:\"flex\",alignItems:\"center\",gap:8},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:consigneeDifferent,onChange:e=>setConsigneeDifferent(e.target.checked),style:{width:16,height:16}}),\"Consignee different from Buyer?\"]}),!consigneeDifferent&&/*#__PURE__*/_jsx(\"span\",{className:\"badge\",children:\"Using Buyer as Consignee\"})]}),consigneeDifferent&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{marginTop:8},children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Consignee (Ship To)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-3\",style:{marginTop:6},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.name,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{name:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"GSTIN/UIN\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.gstin,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{gstin:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"State Code\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.stateCode,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{stateCode:String(e.target.value).replace(/[^0-9]/g,\"\")})),placeholder:\"33\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-3\",style:{marginTop:6},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.state,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{state:e.target.value})),placeholder:\"Tamil Nadu\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.city,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{city:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"PIN\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.pin||\"\",onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{pin:String(e.target.value).replace(/[^0-9]/g,\"\")}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:6},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address 1\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.addr1,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{addr1:e.target.value})),style:{width:\"100%\"}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:6},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address 2\"}),/*#__PURE__*/_jsx(\"input\",{value:consignee.addr2,onChange:e=>setConsignee(c=>_objectSpread(_objectSpread({},c),{},{addr2:e.target.value})),style:{width:\"100%\"}})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{marginTop:12},children:/*#__PURE__*/_jsxs(\"table\",{className:\"items-table\",style:{width:\"100%\",tableLayout:\"fixed\"},children:[/*#__PURE__*/_jsxs(\"colgroup\",{children:[/*#__PURE__*/_jsx(\"col\",{style:{width:44}}),/*#__PURE__*/_jsx(\"col\",{}),/*#__PURE__*/_jsx(\"col\",{style:{width:100}}),/*#__PURE__*/_jsx(\"col\",{style:{width:84}}),/*#__PURE__*/_jsx(\"col\",{style:{width:72}}),/*#__PURE__*/_jsx(\"col\",{style:{width:96}}),/*#__PURE__*/_jsx(\"col\",{style:{width:108}}),/*#__PURE__*/_jsx(\"col\",{style:{width:84}}),/*#__PURE__*/_jsx(\"col\",{style:{width:116}}),/*#__PURE__*/_jsx(\"col\",{style:{width:56}})]}),/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description of Goods\"}),/*#__PURE__*/_jsx(\"th\",{children:\"HSN\"}),/*#__PURE__*/_jsx(\"th\",{className:\"right\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"center\",children:\"Unit\"}),/*#__PURE__*/_jsx(\"th\",{className:\"right\",children:\"Rate\"}),/*#__PURE__*/_jsx(\"th\",{className:\"right\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"right\",children:\"GST %\"}),/*#__PURE__*/_jsx(\"th\",{className:\"right\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"center\",children:\"\\u2716\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:lines.map((l,i)=>{const qty=Number(l.qty||0);const rate=Number(l.unitPrice||0);const gstPct=Number(l.gst||0);const price=qty*rate;const st=statuses[i];const disableRowInputs=!!st&&(!st.exists||typeof st.stock===\"number\"&&st.stock<=0);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:i+1}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"input\",{list:\"bill-suggest\",placeholder:\"Type to search Purchases\\u2026\",value:l.itemName,onChange:e=>handleItemChange(i,e.target.value),onFocus:e=>setActiveQuery(e.target.value||\" \")}),/*#__PURE__*/_jsx(\"datalist\",{id:\"bill-suggest\",children:suggest.map((s,idx)=>/*#__PURE__*/_jsx(\"option\",{value:s.name},\"\".concat(s.name,\"-\").concat(idx)))}),l.itemName&&st&&/*#__PURE__*/_jsxs(\"div\",{className:\"small\",style:{color:st.exists&&Number(l.qty||0)<=st.stock?\"#047857\":\"#b91c1c\"},children:[!st.exists&&\"Not available in Inventory\",st.exists&&st.stock===0&&\"Out of stock\",st.exists&&st.stock>0&&Number(l.qty||0)===0&&\"In stock: \".concat(st.stock),st.exists&&Number(l.qty||0)>st.stock&&\"Only \".concat(st.stock,\" in stock\"),st.exists&&Number(l.qty||0)>0&&Number(l.qty||0)<=st.stock&&\"Available: \".concat(st.stock)]})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{value:l.hsn,onChange:e=>handleHSN(i,e.target.value),disabled:disableRowInputs})}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:/*#__PURE__*/_jsx(\"input\",{value:l.qty,onChange:e=>handleQty(i,e.target.value),onBlur:e=>updateAvailability(i,l.itemName,e.target.value),disabled:disableRowInputs})}),/*#__PURE__*/_jsx(\"td\",{className:\"center\",children:/*#__PURE__*/_jsx(\"input\",{value:\"KG\",readOnly:true})}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:/*#__PURE__*/_jsx(\"input\",{value:l.unitPrice,onChange:e=>handlePrice(i,e.target.value),disabled:disableRowInputs})}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:toINR(price)}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:/*#__PURE__*/_jsx(\"input\",{value:l.gst,onChange:e=>handleGST(i,e.target.value),disabled:disableRowInputs})}),/*#__PURE__*/_jsx(\"td\",{className:\"right\",children:toINR(price+price*gstPct/100)}),/*#__PURE__*/_jsx(\"td\",{className:\"center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn warn\",onClick:()=>removeRow(i),children:\"Del\"})})]},i);})}),/*#__PURE__*/_jsx(\"tfoot\",{children:/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:10,children:/*#__PURE__*/_jsxs(\"div\",{className:\"stack\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:addRow,children:\"+ Add Item\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"muted\",children:[\"Type to search from \",/*#__PURE__*/_jsx(\"b\",{children:\"Purchases\"}),\". Unit is fixed to \",/*#__PURE__*/_jsx(\"b\",{children:\"KG\"}),\"; Rate & GST% auto-fill from the latest Purchase; HSN from Inventory.\"]})]})})})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"totals-grid\",children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{gridTemplateColumns:\"1fr 1fr\",margin:0},children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Taxable Amount\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsx(\"b\",{children:toINR(computed.taxable)})}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",style:{display:\"flex\",alignItems:\"center\",gap:8},children:\"Discount (%)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsx(\"input\",{value:discountPct,onChange:e=>setDiscountPct(String(e.target.value).replace(/[^0-9.]/g,\"\")),style:{width:120,textAlign:\"right\"},placeholder:\"0\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Discount Amount\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"right\",children:[\"-\",toINR(computed.discountAmount)]}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:isInterState?\"GST (IGST)\":\"GST (CGST+SGST)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsx(\"b\",{children:isInterState?toINR(computed.igstRounded):toINR(computed.cgstRounded+computed.sgstRounded)})}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Round Off (GST rounding)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:toINR(computed.roundOff)}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Total\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsx(\"b\",{children:toINR(computed.total)})}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",style:{marginTop:6},children:/*#__PURE__*/_jsx(\"b\",{children:\"Grand Total\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",style:{marginTop:6},children:/*#__PURE__*/_jsx(\"b\",{children:toINR(computed.grand)})}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Terms of Payment\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsxs(\"select\",{value:paymentMode,onChange:e=>setPaymentMode(e.target.value),style:{width:140,textAlign:\"right\"},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select\"}),paymentModes.map(m=>/*#__PURE__*/_jsx(\"option\",{children:m},\"pm-\"+m))]})})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{gridTemplateColumns:\"1fr 1fr\",marginTop:6},children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",style:{display:\"flex\",alignItems:\"center\",gap:8},children:\"Split Payment (max 2)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:/*#__PURE__*/_jsxs(\"label\",{style:{display:\"inline-flex\",gap:8,alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:splitEnabled,onChange:e=>setSplitEnabled(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{className:\"small\",children:\"Enable\"})]})})]}),splitEnabled&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-3\",style:{display:\"grid\",gridTemplateColumns:\"1fr 1fr 1fr\",gap:8,marginTop:8},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Split #1 Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:split1.amount,onChange:e=>{const raw=String(e.target.value);const clean=raw.replace(/[^0-9.]/g,\"\");const amt1=n(clean);const remaining=Math.max(0,+(computed.grand-amt1).toFixed(2));setSplit1(_objectSpread(_objectSpread({},split1),{},{amount:clean}));setSplit2(prev=>_objectSpread(_objectSpread({},prev),{},{amount:remaining>0?String(remaining):remaining===0?\"0\":prev.amount}));},placeholder:\"0\",className:\"right\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Split #1 Terms / Mode\"}),/*#__PURE__*/_jsx(\"select\",{value:split1.mode,onChange:e=>setSplit1(_objectSpread(_objectSpread({},split1),{},{mode:e.target.value})),children:paymentModes.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m,children:m},\"m1\"+m))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ref / Txn No. (opt)\"}),/*#__PURE__*/_jsx(\"input\",{value:split1.ref,onChange:e=>setSplit1(_objectSpread(_objectSpread({},split1),{},{ref:e.target.value})),placeholder:\"UTR / Cheque / Last 4\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-3\",style:{display:\"grid\",gridTemplateColumns:\"1fr 1fr 1fr\",gap:8,marginTop:8},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Split #2 Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:split2.amount,onChange:e=>setSplit2(_objectSpread(_objectSpread({},split2),{},{amount:e.target.value})),placeholder:\"0\",className:\"right\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Split #2 Terms / Mode\"}),/*#__PURE__*/_jsx(\"select\",{value:split2.mode,onChange:e=>setSplit2(_objectSpread(_objectSpread({},split2),{},{mode:e.target.value})),children:paymentModes.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m,children:m},\"m2\"+m))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ref / Txn No. (opt)\"}),/*#__PURE__*/_jsx(\"input\",{value:split2.ref,onChange:e=>setSplit2(_objectSpread(_objectSpread({},split2),{},{ref:e.target.value})),placeholder:\"UTR / Cheque / Last 4\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{gridTemplateColumns:\"1fr 1fr\",marginTop:8},children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"Paid Now (Advance + Splits)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:toINR(paidNow)})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"actions-row\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:async()=>{var _buyer$pin2,_buyer$pin2$trim;const missing=[];if(!buyer.name.trim())missing.push(\"Buyer Name\");if(!buyer.addr1.trim())missing.push(\"Buyer Address 1\");if(!buyer.city.trim())missing.push(\"Buyer City\");if(!((_buyer$pin2=buyer.pin)!==null&&_buyer$pin2!==void 0&&(_buyer$pin2$trim=_buyer$pin2.trim)!==null&&_buyer$pin2$trim!==void 0&&_buyer$pin2$trim.call(_buyer$pin2)))missing.push(\"Buyer PIN\");if(!(selectedAccount!==null&&selectedAccount!==void 0&&selectedAccount.account_id)){alert(\"Please select Account (Ledger) before saving.\");return;}if(missing.length){alert(\"Please fill mandatory fields:\\n\"+missing.join(\"\\n\"));return;}const issues=[];lines.forEach((l,i)=>{if(!l.itemName||!Number(l.qty))return;const st=statuses[i];if(!(st!==null&&st!==void 0&&st.exists))issues.push(\"Row \".concat(i+1,\": Item not found in inventory\"));else if(!(st!==null&&st!==void 0&&st.can_deliver))issues.push(\"Row \".concat(i+1,\": Only \").concat(st.stock,\" in stock\"));});if(issues.length){alert(\"Please fix before saving:\\n\"+issues.join(\"\\n\"));return;}if(!computed.rows.length){alert(\"No valid line items to save.\");return;}// 1) Build FIFO sale payload for backend\n/*const salePayload = {\r\n              bill_no: invMeta.invoiceNo,\r\n              date: invMeta.date,\r\n              party_name: buyer.name || \"\",\r\n              items: computed.rows.map((r) => ({\r\n                item_name: r.itemName,\r\n                qty: Number(r.qty || 0),\r\n                price: Number(r.rate || 0),\r\n                gst: Number(r.gstRate || r.gst || 0),\r\n              })),\r\n            };*/// 1) Build FIFO sale payload for backend\nconst salePayload={bill_no:invMeta.invoiceNo,date:invMeta.date,account_id:selectedAccount.account_id,// ISO yyyy-mm-dd (backend will store as DATE)\nparty_name:buyer.name||\"\",// header totals\ntaxable:+computed.taxable.toFixed(2),discount_amount:+computed.discountAmount.toFixed(2),discounted_taxable:+computed.discountedTaxable.toFixed(2),gst_amount:+computed.gstRounded.toFixed(2),round_off:+computed.roundOff.toFixed(2),grand_total:+computed.grand.toFixed(2),paid_now:+paidNow.toFixed(2),balance:+balanceAfterSplits.toFixed(2),payment_mode:paymentMode||\"\",// split payment info\nsplit_enabled:splitEnabled,split1_amount:splitEnabled?n(split1.amount):0,split1_mode:splitEnabled?split1.mode:\"\",split1_ref:splitEnabled?split1.ref:\"\",split2_amount:splitEnabled?n(split2.amount):0,split2_mode:splitEnabled?split2.mode:\"\",split2_ref:splitEnabled?split2.ref:\"\",// some useful extra buyer meta (optional but nice for reports)\nbuyer_gstin:buyer.gstin||\"\",buyer_mobile:buyer.mobile||\"\",buyer_state:buyer.state||\"\",buyer_state_code:buyer.stateCode||\"\",// line items for sale_lines table\nitems:computed.rows.map(r=>({item_name:r.itemName,hsn:r.hsn||\"\",qty:Number(r.qty||0),unit:r.unit||\"KG\",price:Number(r.rate||0),gst:Number(r.gstRate||r.gst||0)}))};try{const resp=await apiCreateSaleFIFO(salePayload);// Optional: you can log / show resp.sale_id, resp.total_amount, etc.\nconsole.log(\"Sale created (FIFO):\",resp);}catch(e){console.error(\"Error creating sale via FIFO:\",e);alert(\"Failed to create sale in database (FIFO).\\n\"+((e===null||e===void 0?void 0:e.message)||e));return;}// 2) Local storage copy (for your own dashboard/history)\nconst bill={id:Date.now(),account_id:selectedAccount.account_id,account_name:selectedAccount.name,account_mobile:selectedAccount.mobile||buyer.mobile||\"\",company,buyer,consignee:consigneeDifferent?consignee:buyer,invMeta,lines,computed,discountPct,advance,paymentMode,payments:{splitEnabled,split1:splitEnabled?{amount:n(split1.amount),mode:split1.mode,ref:split1.ref}:null,split2:splitEnabled?{amount:n(split2.amount),mode:split2.mode,ref:split2.ref}:null,paidNow,balance:balanceAfterSplits},createdAt:new Date().toISOString()};const arr=JSON.parse(localStorage.getItem(\"bills.v2\")||\"[]\");arr.push(bill);localStorage.setItem(\"bills.v2\",JSON.stringify(arr));// 3) Export + Print\nexportExcel();printNow();},children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn primary\",onClick:printNow,children:\"Print\"})]})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","XLSX","apiBillingSuggest","apiCheckAvailability","apiPurchasesLast","apiCreateSaleFIFO","apiAccountsSuggest","apiAccountByMobile","apiAccountsSuggestName","apiAccountById","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","emptyLine","itemName","qty","unitPrice","hsn","gst","unit","fmtDDMMYYYY","iso","d","Date","dd","String","getDate","padStart","mm","getMonth","yy","getFullYear","concat","toINR","n","v","isNaN","toLocaleString","minimumFractionDigits","maximumFractionDigits","numberToWordsIndian","num","a","b","inWords","Math","floor","parts","units","label","value","q","push","join","escapeHtml","s","replaceAll","normCode","trim","isSameState","companyStateCode","customerStateCode","Number","BillingPanel","_ref","company","defaultBank","inventory","buyer","setBuyer","name","mobile","addr1","addr2","city","pin","state","stateCode","gstin","email","phone","selectedAccount","setSelectedAccount","accQuery","setAccQuery","accSuggest","setAccSuggest","accDebRef","normalizeAccount","_ref2","_a$name","_objectSpread","account_name","clearTimeout","current","setTimeout","length","rows","map","_unused","advance","setAdvance","paymentMode","setPaymentMode","paymentModes","splitEnabled","setSplitEnabled","split1","setSplit1","amount","mode","ref","split2","setSplit2","consigneeDifferent","setConsigneeDifferent","consignee","setConsignee","todayIso","toISOString","slice","invMeta","setInvMeta","invoiceNo","date","ewayNo","kms","fromDate","toDate","lrDate","lines","setLines","discountPct","setDiscountPct","suggest","setSuggest","activeQuery","setActiveQuery","debRef","list","_unused2","mobileSuggest","setMobileSuggest","mobileQuery","setMobileQuery","mobDebRef","_unused3","nameSuggest","setNameSuggest","nameQuery","setNameQuery","nameDebRef","_unused4","pickName","acc","fillBuyerFromAccount","pickAccount","account_id","_ref3","_full$name","full","normalized","e","console","error","_acc$name","_acc$mobile","_acc$addr","_acc$addr2","_acc$city","_ref4","_acc$pin","_acc$state","_ref5","_acc$stateCode","_acc$gstin","_acc$email","_acc$phone","replace","statuses","setStatuses","updateAvailability","idx","vname","undefined","st","isFinite","_unused5","lookupFromInventory","val","arr","Array","isArray","byLower","toLowerCase","found","find","i","_ref6","_ref7","_found$hsn","_ref8","_found$gst","_ref9","_found$unit","_ref10","_found$price","price","f2","_ref11","_f2$HSN","_f2$GST","_f2$UNIT","_f2$PRICE","handleItemChange","_lines$idx","picked","_unused6","item","stockQty","prev","next","r","_picked$hsn","_picked","_picked$price","_picked2","_picked$gst","_picked3","isNonEmpty","hasBlank","qtyNow","handleQty","_lines$idx2","clean","handlePrice","handleHSN","handleGST","handleUnit","addRow","removeRow","filter","_","_omit","rest","_objectWithoutProperties","_toPropertyKey","computed","filled","l","baseRows","rate","gstRate","lineTaxable","taxable","reduce","pct","max","discountAmount","toFixed","discountedTaxable","factor","cgstRaw","sgstRaw","igstRaw","forEach","discLineTaxable","lineGST","rawGSTTotal","roundRupee","x","round","isInter","cgstRounded","sgstRounded","igstRounded","gstRounded","roundOff","total","grand","isInterState","paidNow","s1","s2","balanceAfterSplits","exportExcel","consigneeForExcel","invoiceAdvance","split1Amt","split2Amt","invoicePaidNow","invoiceBalance","lineTaxableDisc","lineGSTRaw","cgstP","sgstP","igstP","totalVal","roundOffForRow","DATE","GSTIN","ADDRESS","STATE","QTY","UOM","RATE","NARRATION","data","ws","utils","json_to_sheet","header","wb","book_new","book_append_sheet","fileName","writeFile","printNow","_buyer$pin","_buyer$pin$trim","missing","call","alert","issues","exists","can_deliver","stock","wnd","window","open","useConsignee","fmtL","toLocaleDateString","day","month","year","rowHtmlArr","lineBase","amountWithTaxRaw","taxLabel","TARGET_ROWS","blankCount","k","rowsHtml","cssHref","from","document","styleSheets","href","Boolean","h","includes","adv","balanceDue","splitLinesHtml","html","whatsapp","vehicleNo","bankName","branch","ifsc","account","write","close","className","children","style","marginTop","onChange","m","target","type","display","gap","alignItems","position","onFocus","placeholder","autoComplete","top","left","right","background","border","zIndex","maxHeight","overflowY","borderRadius","onMouseDown","preventDefault","padding","cursor","borderBottom","fontWeight","fontSize","color","_unused7","onBlur","_unused8","id","checked","width","height","c","tableLayout","gstPct","disableRowInputs","disabled","readOnly","onClick","colSpan","gridTemplateColumns","margin","textAlign","step","raw","amt1","remaining","_buyer$pin2","_buyer$pin2$trim","salePayload","bill_no","party_name","discount_amount","discounted_taxable","gst_amount","round_off","grand_total","paid_now","balance","payment_mode","split_enabled","split1_amount","split1_mode","split1_ref","split2_amount","split2_mode","split2_ref","buyer_gstin","buyer_mobile","buyer_state","buyer_state_code","items","item_name","resp","log","message","bill","now","account_mobile","payments","createdAt","JSON","parse","localStorage","getItem","setItem","stringify"],"sources":["C:/CA/Billing/dev/billing-pks/src/BillingPanel.jsx"],"sourcesContent":["// src/BillingPanel.jsx\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport * as XLSX from \"xlsx\";\r\nimport \"./BillingPanel.css\";\r\n\r\nimport {\r\n  apiBillingSuggest,\r\n  apiCheckAvailability,\r\n  apiPurchasesLast,\r\n  apiCreateSaleFIFO,\r\n  apiAccountsSuggest,\r\n  apiAccountByMobile,\r\n  apiAccountsSuggestName,\r\n  apiAccountById,\r\n} from \"./api\";\r\n\r\n\r\n// ---- helpers (scoped to panel) ----\r\nconst emptyLine = () => ({\r\n  itemName: \"\",\r\n  qty: \"\",\r\n  unitPrice: \"\",\r\n  hsn: \"\",\r\n  gst: \"\",\r\n  unit: \"KG\",\r\n});\r\n\r\nconst fmtDDMMYYYY = (iso) => {\r\n  const d = new Date(iso);\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const yy = d.getFullYear();\r\n  return `${dd}-${mm}-${yy}`;\r\n};\r\n\r\nfunction toINR(n) {\r\n  const v = isNaN(n) ? 0 : n;\r\n  return v.toLocaleString(\"en-IN\", {\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n  });\r\n}\r\n\r\nfunction numberToWordsIndian(num) {\r\n  const a = [\r\n    \"\",\r\n    \"One\",\r\n    \"Two\",\r\n    \"Three\",\r\n    \"Four\",\r\n    \"Five\",\r\n    \"Six\",\r\n    \"Seven\",\r\n    \"Eight\",\r\n    \"Nine\",\r\n    \"Ten\",\r\n    \"Eleven\",\r\n    \"Twelve\",\r\n    \"Thirteen\",\r\n    \"Fourteen\",\r\n    \"Fifteen\",\r\n    \"Sixteen\",\r\n    \"Seventeen\",\r\n    \"Eighteen\",\r\n    \"Nineteen\",\r\n  ];\r\n  const b = [\r\n    \"\",\r\n    \"\",\r\n    \"Twenty\",\r\n    \"Thirty\",\r\n    \"Forty\",\r\n    \"Fifty\",\r\n    \"Sixty\",\r\n    \"Seventy\",\r\n    \"Eighty\",\r\n    \"Ninety\",\r\n  ];\r\n  function inWords(n) {\r\n    if (n < 20) return a[n];\r\n    if (n < 100)\r\n      return b[Math.floor(n / 10)] + (n % 10 ? \" \" + a[n % 10] : \"\");\r\n    if (n < 1000)\r\n      return (\r\n        a[Math.floor(n / 100)] +\r\n        \" Hundred\" +\r\n        (n % 100 ? \" and \" + inWords(n % 100) : \"\")\r\n      );\r\n    return \"\";\r\n  }\r\n  if (num === 0) return \"Zero\";\r\n  const parts = [];\r\n  const units = [\r\n    [\"Crore\", 10000000],\r\n    [\"Lakh\", 100000],\r\n    [\"Thousand\", 1000],\r\n    [\"\", 1],\r\n  ];\r\n  let n = Math.floor(num);\r\n  for (const [label, value] of units) {\r\n    const q = Math.floor(n / value);\r\n    if (q) {\r\n      if (value >= 1000) {\r\n        if (q < 100) parts.push(inWords(q) + \" \" + label);\r\n        else parts.push(numberToWordsIndian(q) + \" \" + label);\r\n      } else {\r\n        parts.push(inWords(q));\r\n      }\r\n      n = n % value;\r\n    }\r\n  }\r\n  return parts.join(\" \");\r\n}\r\n\r\nfunction escapeHtml(s) {\r\n  return String(s || \"\")\r\n    .replaceAll(\"&\", \"&amp;\")\r\n    .replaceAll(\"<\", \"&lt;\")\r\n    .replaceAll(\">\", \"&gt;\")\r\n    .replaceAll('\"', \"&quot;\")\r\n    .replaceAll(\"'\", \"&#039;\");\r\n}\r\n\r\nconst normCode = (v) => String(v || \"\").trim();\r\nconst isSameState = (companyStateCode, customerStateCode) =>\r\n  normCode(companyStateCode) !== \"\" &&\r\n  normCode(customerStateCode) !== \"\" &&\r\n  normCode(companyStateCode) === normCode(customerStateCode);\r\n\r\n// small numeric helper\r\nconst n = (v) => (isNaN(Number(v)) || !v ? 0 : Number(v));\r\n// Mobile-based typeahead (accounts_list)\r\n\r\n\r\n/** Billing panel */\r\nexport default function BillingPanel({ company, defaultBank, inventory }) {\r\n  // Buyer / consignee / meta\r\n  const [buyer, setBuyer] = useState({\r\n    name: \"\",\r\n    mobile: \"\",  \r\n    addr1: \"\",\r\n    addr2: \"\",\r\n    city: \"\",\r\n    pin: \"\",\r\n    state: \"\",\r\n    stateCode: \"\",\r\n    gstin: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n  });\r\n\r\n  // Selected account (ledger)\r\nconst [selectedAccount, setSelectedAccount] = useState(null);\r\n\r\n// Account search\r\nconst [accQuery, setAccQuery] = useState(\"\");\r\nconst [accSuggest, setAccSuggest] = useState([]);\r\nconst accDebRef = useRef();\r\nconst normalizeAccount = (a) => ({\r\n  ...a,\r\n  name: a.name ?? a.account_name ?? \"\",\r\n});\r\nuseEffect(() => {\r\n  clearTimeout(accDebRef.current);\r\n  accDebRef.current = setTimeout(async () => {\r\n    const q = (accQuery || \"\").trim();\r\n    if (q.length < 2) return setAccSuggest([]);\r\n    try {\r\n      const rows = await apiAccountsSuggestName(q, 10);\r\n      setAccSuggest((rows || []).map(normalizeAccount));\r\n    } catch {\r\n      setAccSuggest([]);\r\n    }\r\n  }, 180);\r\n\r\n  return () => clearTimeout(accDebRef.current);\r\n}, [accQuery]);\r\n\r\n\r\n  // Payments\r\n  const [advance, setAdvance] = useState(\"0\"); // kept in state, but field hidden now\r\n  const [paymentMode, setPaymentMode] = useState(\"\");\r\n  const paymentModes = [\r\n    \"Select\",\r\n    \"Cash\",\r\n    \"UPI\",\r\n    \"Card\",\r\n    \"Bank Transfer\",\r\n    \"Cheque\",\r\n    \"Credit\",\r\n    \"Online\",\r\n  ];\r\n\r\n  // Split payments\r\n  const [splitEnabled, setSplitEnabled] = useState(false);\r\n  const [split1, setSplit1] = useState({ amount: \"\", mode: \"Select\", ref: \"\" });\r\n  const [split2, setSplit2] = useState({ amount: \"\", mode: \"Select\", ref: \"\" });\r\n\r\n  const [consigneeDifferent, setConsigneeDifferent] = useState(false);\r\n  const [consignee, setConsignee] = useState({ ...buyer });\r\n  useEffect(() => {\r\n    if (!consigneeDifferent) setConsignee({ ...buyer });\r\n  }, [consigneeDifferent, buyer]);\r\n\r\n  const todayIso = new Date().toISOString().slice(0, 10);\r\n  const [invMeta, setInvMeta] = useState({\r\n    invoiceNo: \"PKS-B-00001\",\r\n    date: todayIso,\r\n    ewayNo: \"\",\r\n    kms: \"\",\r\n    fromDate: \"\",\r\n    toDate: \"\",\r\n    lrDate: todayIso,\r\n  });\r\n\r\n  // lines + discount\r\n  const [lines, setLines] = useState([emptyLine()]);\r\n  const [discountPct, setDiscountPct] = useState(\"0\");\r\n\r\n  // Purchases-based type-ahead\r\n  const [suggest, setSuggest] = useState([]); // [{name}]\r\n  const [activeQuery, setActiveQuery] = useState(\"\");\r\n  const debRef = useRef();\r\n\r\n  useEffect(() => {\r\n    clearTimeout(debRef.current);\r\n    debRef.current = setTimeout(async () => {\r\n      const q = (activeQuery || \"\").trim();\r\n      if (!q) return setSuggest([]);\r\n      try {\r\n        const list = await apiBillingSuggest(q, 25);\r\n        setSuggest(list || []);\r\n      } catch {\r\n        setSuggest([]);\r\n      }\r\n    }, 180);\r\n    return () => clearTimeout(debRef.current);\r\n  }, [activeQuery]);\r\n\r\n  const [mobileSuggest, setMobileSuggest] = useState([]); // rows from backend\r\nconst [mobileQuery, setMobileQuery] = useState(\"\");\r\nconst mobDebRef = useRef();\r\n\r\n  useEffect(() => {\r\n  clearTimeout(mobDebRef.current);\r\n  mobDebRef.current = setTimeout(async () => {\r\n    const q = (mobileQuery || \"\").trim();\r\n    if (q.length < 2) return setMobileSuggest([]);\r\n    try {\r\n      const rows = await apiAccountsSuggest(q, 10);\r\n      setMobileSuggest((rows || []).map(normalizeAccount));\r\n    } catch {\r\n      setMobileSuggest([]);\r\n    }\r\n  }, 180);\r\n\r\n  return () => clearTimeout(mobDebRef.current);\r\n}, [mobileQuery]);\r\n\r\nconst [nameSuggest, setNameSuggest] = useState([]);\r\nconst [nameQuery, setNameQuery] = useState(\"\");\r\nconst nameDebRef = useRef();\r\n\r\nuseEffect(() => {\r\n  clearTimeout(nameDebRef.current);\r\n  nameDebRef.current = setTimeout(async () => {\r\n    const q = (nameQuery || \"\").trim();\r\n    if (q.length < 2) return setNameSuggest([]);\r\n    try {\r\n      const rows = await apiAccountsSuggestName(q, 10);\r\n      setNameSuggest((rows || []).map(normalizeAccount));\r\n    } catch {\r\n      setNameSuggest([]);\r\n    }\r\n  }, 180);\r\n\r\n  return () => clearTimeout(nameDebRef.current);\r\n}, [nameQuery]);\r\n\r\n\r\nconst pickName = async (acc) => {\r\n  fillBuyerFromAccount(acc);\r\n  setNameSuggest([]);\r\n  setNameQuery(acc?.name || \"\");\r\n};\r\n\r\nconst pickAccount = async (acc) => {\r\n  if (!acc?.account_id) return;\r\n\r\n  try {\r\n    const full = await apiAccountById(acc.account_id);\r\n\r\n    if (!full) return;\r\n\r\n    const normalized = {\r\n      ...full,\r\n      name: full.name ?? full.account_name ?? \"\",\r\n    };\r\n\r\n    setSelectedAccount(normalized);\r\n    fillBuyerFromAccount(normalized);\r\n    setAccQuery(normalized.name);\r\n  } catch (e) {\r\n    console.error(\"Account fetch failed\", e);\r\n  } finally {\r\n    setAccSuggest([]);\r\n  }\r\n};\r\n\r\n\r\nconst fillBuyerFromAccount = (acc) => {\r\n  if (!acc) return;\r\n  setBuyer((b) => ({\r\n    ...b,\r\n    name: acc.name ?? b.name,\r\n    mobile: acc.mobile ?? b.mobile,\r\n    addr1: acc.addr1 ?? b.addr1,\r\n    addr2: acc.addr2 ?? b.addr2,\r\n    city: acc.city ?? b.city,\r\n    pin: String(acc.pin ?? b.pin ?? \"\").replace(/[^0-9]/g, \"\"),\r\n    state: acc.state ?? b.state,\r\n    stateCode: String(acc.stateCode ?? b.stateCode ?? \"\").replace(/[^0-9]/g, \"\"),\r\n    gstin: acc.gstin ?? b.gstin,\r\n    email: acc.email ?? b.email,\r\n    phone: acc.phone ?? b.phone,\r\n  }));\r\n};\r\n\r\n\r\n  // per-line availability status: { exists, stock, can_deliver }\r\n  const [statuses, setStatuses] = useState({});\r\n\r\n  const updateAvailability = async (idx, name, qty) => {\r\n    const vname = (name || \"\").trim();\r\n    const q = Number(qty ?? 0);\r\n    if (!vname) {\r\n      setStatuses((s) => ({ ...s, [idx]: undefined }));\r\n      return;\r\n    }\r\n    try {\r\n      const st = await apiCheckAvailability(vname, Number.isFinite(q) ? q : 0);\r\n      setStatuses((s) => ({ ...s, [idx]: st }));\r\n    } catch {\r\n      setStatuses((s) => ({ ...s, [idx]: undefined }));\r\n    }\r\n  };\r\n\r\n  const lookupFromInventory = (val) => {\r\n    const arr = Array.isArray(inventory) ? inventory : [];\r\n    const byLower = (s) => String(s || \"\").toLowerCase();\r\n\r\n    let found = arr.find((i) => byLower(i.name) === byLower(val));\r\n    if (found) {\r\n      return {\r\n        name: found.name,\r\n        hsn: found.hsn ?? found[\"HSN\"] ?? found[\"HSN CODE\"] ?? \"\",\r\n        gst: Number(found.gst ?? found[\"GST %\"] ?? 0) || 0,\r\n        unit: found.unit ?? found[\"UNIT\"] ?? \"KGS\",\r\n        price: Number(found.price ?? found[\"PRICE\"] ?? 0) || 0,\r\n      };\r\n    }\r\n\r\n    const f2 = arr.find((i) => byLower(i[\"ITEM NAME\"]) === byLower(val));\r\n    if (f2) {\r\n      return {\r\n        name: f2[\"ITEM NAME\"],\r\n        hsn: f2[\"HSN\"] ?? f2[\"HSN CODE\"] ?? \"\",\r\n        gst: Number(f2[\"GST %\"] ?? 0) || 0,\r\n        unit: f2[\"UNIT\"] ?? \"KGS\",\r\n        price: Number(f2[\"PRICE\"] ?? 0) || 0,\r\n      };\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const handleItemChange = async (idx, val) => {\r\n    setActiveQuery(val);\r\n\r\n    let picked = null;\r\n    try {\r\n      if ((val || \"\").trim()) {\r\n        picked = await apiPurchasesLast(val.trim());\r\n      }\r\n    } catch {\r\n      /* ignore */\r\n    }\r\n\r\n    if (!picked) {\r\n      const item = lookupFromInventory(val);\r\n      picked = item\r\n        ? {\r\n            name: item.name,\r\n            hsn: item.hsn || \"\",\r\n            price: Number(item.price || 0),\r\n            gst: Number(item.gst || 0),\r\n            stockQty: 0,\r\n          }\r\n        : null;\r\n    }\r\n\r\n    setLines((prev) => {\r\n      const next = prev.map((r, i) =>\r\n        i !== idx\r\n          ? r\r\n          : {\r\n              ...r,\r\n              itemName: val,\r\n              hsn: picked?.hsn ?? r.hsn,\r\n              unit: \"KG\",\r\n              unitPrice: String(picked?.price ?? r.unitPrice),\r\n              gst: String(picked?.gst ?? r.gst),\r\n            }\r\n      );\r\n      const isNonEmpty = !!(next[idx].itemName || next[idx].qty);\r\n      const hasBlank =\r\n        next.length &&\r\n        !next[next.length - 1].itemName &&\r\n        !next[next.length - 1].qty;\r\n      if (isNonEmpty && !hasBlank) next.push(emptyLine());\r\n      return next;\r\n    });\r\n\r\n    const qtyNow = Number(lines[idx]?.qty || 0);\r\n    updateAvailability(idx, val, qtyNow);\r\n    setSuggest([]);\r\n  };\r\n\r\n  const handleQty = (idx, v) => {\r\n    const clean = String(v).replace(/[^0-9.]/g, \"\");\r\n    setLines((prev) => {\r\n      const next = prev.map((r, i) =>\r\n        i !== idx ? r : { ...r, qty: clean }\r\n      );\r\n      const isNonEmpty = !!(next[idx].itemName || clean);\r\n      const hasBlank =\r\n        next.length &&\r\n        !next[next.length - 1].itemName &&\r\n        !next[next.length - 1].qty;\r\n      if (isNonEmpty && !hasBlank) next.push(emptyLine());\r\n      return next;\r\n    });\r\n    updateAvailability(idx, lines[idx]?.itemName || \"\", clean);\r\n  };\r\n\r\n  const handlePrice = (idx, v) =>\r\n    setLines((prev) =>\r\n      prev.map((r, i) =>\r\n        i !== idx\r\n          ? r\r\n          : { ...r, unitPrice: String(v).replace(/[^0-9.]/g, \"\") }\r\n      )\r\n    );\r\n  const handleHSN = (idx, v) =>\r\n    setLines((prev) =>\r\n      prev.map((r, i) => (i !== idx ? r : { ...r, hsn: v }))\r\n    );\r\n  const handleGST = (idx, v) =>\r\n    setLines((prev) =>\r\n      prev.map((r, i) =>\r\n        i !== idx\r\n          ? r\r\n          : { ...r, gst: String(v).replace(/[^0-9.]/g, \"\") }\r\n      )\r\n    );\r\n  const handleUnit = (idx, v) =>\r\n    setLines((prev) =>\r\n      prev.map((r, i) => (i !== idx ? r : { ...r, unit: v }))\r\n    );\r\n  const addRow = () => setLines((prev) => [...prev, emptyLine()]);\r\n  const removeRow = (idx) => {\r\n    setLines((prev) => prev.filter((_, i) => i !== idx));\r\n    setStatuses((s) => {\r\n      const { [idx]: _omit, ...rest } = s;\r\n      return rest;\r\n    });\r\n  };\r\n\r\n  // ============ totals (with GST rounding) ============\r\n  const computed = useMemo(() => {\r\n    const filled = lines.filter((l) => l.itemName && Number(l.qty) > 0);\r\n\r\n    const baseRows = filled.map((l) => {\r\n      const qty = Number(l.qty || 0);\r\n      const rate = Number(l.unitPrice || 0);\r\n      const gstRate = Number(l.gst || 0);\r\n      const lineTaxable = qty * rate;\r\n      return { ...l, qty, rate, gstRate, lineTaxable };\r\n    });\r\n\r\n    const taxable = baseRows.reduce((s, r) => s + r.lineTaxable, 0);\r\n\r\n    const pct = Math.max(0, Number(discountPct || 0));\r\n    const discountAmount = +(taxable * (pct / 100)).toFixed(2);\r\n    const discountedTaxable = +(taxable - discountAmount).toFixed(2);\r\n\r\n    const factor = taxable > 0 ? 1 - pct / 100 : 1;\r\n\r\n    let cgstRaw = 0,\r\n      sgstRaw = 0,\r\n      igstRaw = 0;\r\n    baseRows.forEach((r) => {\r\n      const discLineTaxable = r.lineTaxable * factor;\r\n      const lineGST = discLineTaxable * (r.gstRate / 100);\r\n      if (\r\n        (buyer.stateCode || \"\").trim() !==\r\n        (company?.stateCode || \"\").trim()\r\n      ) {\r\n        igstRaw += lineGST;\r\n      } else {\r\n        cgstRaw += lineGST / 2;\r\n        sgstRaw += lineGST / 2;\r\n      }\r\n    });\r\n\r\n    const rawGSTTotal = cgstRaw + sgstRaw + igstRaw;\r\n\r\n    const roundRupee = (x) => Math.round(x);\r\n    const isInter =\r\n      (buyer.stateCode || \"\").trim() !==\r\n      (company?.stateCode || \"\").trim();\r\n    const cgstRounded = isInter ? 0 : roundRupee(cgstRaw);\r\n    const sgstRounded = isInter ? 0 : roundRupee(sgstRaw);\r\n    const igstRounded = isInter ? roundRupee(igstRaw) : 0;\r\n    const gstRounded = isInter ? igstRounded : cgstRounded + sgstRounded;\r\n\r\n    const roundOff = +(gstRounded - rawGSTTotal).toFixed(2);\r\n    const total = +(discountedTaxable + gstRounded).toFixed(2);\r\n    const grand = total;\r\n\r\n    return {\r\n      rows: baseRows,\r\n      taxable,\r\n      discountAmount,\r\n      discountedTaxable,\r\n      rawGSTTotal,\r\n      cgstRounded,\r\n      sgstRounded,\r\n      igstRounded,\r\n      gstRounded,\r\n      roundOff,\r\n      total,\r\n      grand,\r\n    };\r\n  }, [lines, discountPct, buyer.stateCode, company?.stateCode]);\r\n\r\n  const isInterState = useMemo(\r\n    () =>\r\n      (buyer.stateCode || \"\").trim() !==\r\n      (company?.stateCode || \"\").trim(),\r\n    [buyer.stateCode, company?.stateCode]\r\n  );\r\n\r\n  // Split: paid now & balance\r\n  const paidNow = useMemo(() => {\r\n    const s1 = splitEnabled ? n(split1.amount) : 0;\r\n    const s2 = splitEnabled ? n(split2.amount) : 0;\r\n    return n(advance) + s1 + s2;\r\n  }, [advance, splitEnabled, split1.amount, split2.amount]);\r\n\r\n  const balanceAfterSplits = useMemo(\r\n    () => Math.max(0, +(computed.grand - paidNow).toFixed(2)),\r\n    [computed.grand, paidNow]\r\n  );\r\n\r\n  // ====== Export Excel (with split details) ======\r\n  const exportExcel = () => {\r\n    const consigneeForExcel = consigneeDifferent ? consignee : buyer;\r\n\r\n    const pct = Math.max(0, Number(discountPct || 0));\r\n    const factor = 1 - pct / 100;\r\n\r\n    const invoiceAdvance = n(advance);\r\n    const split1Amt = splitEnabled ? n(split1.amount) : 0;\r\n    const split2Amt = splitEnabled ? n(split2.amount) : 0;\r\n    const invoicePaidNow = invoiceAdvance + split1Amt + split2Amt;\r\n    const invoiceBalance = +(computed.grand - invoicePaidNow).toFixed(2);\r\n\r\n    const rows = (computed.rows.length ? computed.rows : []).map((r, idx) => {\r\n      const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\r\n      const lineGSTRaw = lineTaxableDisc * (r.gstRate / 100);\r\n\r\n      const cgstP = isInterState ? 0 : r.gstRate / 2;\r\n      const sgstP = isInterState ? 0 : r.gstRate / 2;\r\n      const igstP = isInterState ? r.gstRate : 0;\r\n\r\n      const totalVal = lineTaxableDisc + lineGSTRaw;\r\n      const roundOffForRow = idx === 0 ? computed.roundOff : 0;\r\n\r\n      return {\r\n        \"VOUCHER TYPE\": \"Sales\",\r\n        DATE: fmtDDMMYYYY(invMeta.date),\r\n        \"VOUCHER NUMBER\": invMeta.invoiceNo,\r\n        \"PARTY NAME\": buyer.name || \"\",\r\n        GSTIN: buyer.gstin || \"\",\r\n        ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\r\n        STATE: buyer.state || \"\",\r\n        \"BUYER CITYPIN\": buyer.city || \"\",\r\n        \"BUYER STATE CODE\": buyer.stateCode || \"\",\r\n        \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\r\n        \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${\r\n          consigneeForExcel.addr2 || \"\"\r\n        }`.trim(),\r\n        \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\r\n        \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\r\n        \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\r\n        \"ITEM NAME\": r.itemName || \"\",\r\n        \"HSN CODE\": r.hsn || \"\",\r\n        QTY: r.qty || 0,\r\n        UOM: r.unit || \"KG\",\r\n        RATE: r.rate || 0,\r\n        \"TAXABLE VALUE\": +lineTaxableDisc.toFixed(2),\r\n        \"CGST %\": cgstP,\r\n        \"SGST %\": sgstP,\r\n        \"IGST %\": igstP,\r\n        \"TOTAL VALUE\": +totalVal.toFixed(2),\r\n        NARRATION: paymentMode\r\n          ? `Sale of goods â€” Payment: ${paymentMode}` +\r\n            (splitEnabled\r\n              ? `; Split1 ${split1Amt} ${split1.mode}${\r\n                  split1.ref ? \" (\" + split1.ref + \")\" : \"\"\r\n                }; Split2 ${split2Amt} ${split2.mode}${\r\n                  split2.ref ? \" (\" + split2.ref + \")\" : \"\"\r\n                }`\r\n              : \"\")\r\n          : splitEnabled\r\n          ? `Sale of goods â€” Split1 ${split1Amt} ${split1.mode}${\r\n              split1.ref ? \" (\" + split1.ref + \")\" : \"\"\r\n            }; Split2 ${split2Amt} ${split2.mode}${\r\n              split2.ref ? \" (\" + split2.ref + \")\" : \"\"\r\n            }`\r\n          : \"Sale of goods\",\r\n        \"ROUND OFF\": roundOffForRow,\r\n        \"PLACE OF SUPPLY\": buyer.state || \"\",\r\n        \"TERMS OF PAYMENT\": paymentMode || \"\",\r\n        \"EWAY BILL NO\": invMeta.ewayNo || \"\",\r\n        \"LR DATE\": invMeta.lrDate || \"\",\r\n        \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\r\n        \"INV DISCOUNT %\": pct,\r\n        \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\r\n        \"INV TAXABLE AFTER DISC\": +computed.discountedTaxable.toFixed(2),\r\n        \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\r\n        \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\r\n        \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\r\n        \"INV ADVANCE\": invoiceAdvance,\r\n        \"INV SPLIT1 AMT\": split1Amt,\r\n        \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\r\n        \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\r\n        \"INV SPLIT2 AMT\": split2Amt,\r\n        \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\r\n        \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\r\n        \"INV PAID NOW\": invoicePaidNow,\r\n        \"INV BALANCE\": invoiceBalance,\r\n      };\r\n    });\r\n\r\n    const data =\r\n      rows.length > 0\r\n        ? rows\r\n        : [\r\n            {\r\n              \"VOUCHER TYPE\": \"Sales\",\r\n              DATE: fmtDDMMYYYY(invMeta.date),\r\n              \"VOUCHER NUMBER\": invMeta.invoiceNo,\r\n              \"PARTY NAME\": buyer.name || \"\",\r\n              GSTIN: buyer.gstin || \"\",\r\n              ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\r\n              STATE: buyer.state || \"\",\r\n              \"BUYER CITYPIN\": buyer.city || \"\",\r\n              \"BUYER STATE CODE\": buyer.stateCode || \"\",\r\n              \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\r\n              \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${\r\n                consigneeForExcel.addr2 || \"\"\r\n              }`.trim(),\r\n              \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\r\n              \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\r\n              \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\r\n              \"ITEM NAME\": \"\",\r\n              \"HSN CODE\": \"\",\r\n              QTY: 0,\r\n              UOM: \"KGS\",\r\n              RATE: 0,\r\n              \"TAXABLE VALUE\": 0,\r\n              \"CGST %\": 0,\r\n              \"SGST %\": 0,\r\n              \"IGST %\": 0,\r\n              \"TOTAL VALUE\": 0,\r\n              NARRATION: paymentMode\r\n                ? `Sale of goods â€” Payment: ${paymentMode}`\r\n                : \"Sale of goods\",\r\n              \"ROUND OFF\": computed.roundOff || 0,\r\n              \"PLACE OF SUPPLY\": buyer.state || \"\",\r\n              \"TERMS OF PAYMENT\": paymentMode || \"\",\r\n              \"EWAY BILL NO\": invMeta.ewayNo || \"\",\r\n              \"LR DATE\": invMeta.lrDate || \"\",\r\n              \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\r\n              \"INV DISCOUNT %\": pct,\r\n              \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\r\n              \"INV TAXABLE AFTER DISC\":\r\n                +computed.discountedTaxable.toFixed(2),\r\n              \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\r\n              \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\r\n              \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\r\n              \"INV ADVANCE\": invoiceAdvance,\r\n              \"INV SPLIT1 AMT\": split1Amt,\r\n              \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\r\n              \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\r\n              \"INV SPLIT2 AMT\": split2Amt,\r\n              \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\r\n              \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\r\n              \"INV PAID NOW\": invoicePaidNow,\r\n              \"INV BALANCE\": invoiceBalance,\r\n            },\r\n          ];\r\n\r\n    const ws = XLSX.utils.json_to_sheet(data, {\r\n      header: [\r\n        \"VOUCHER TYPE\",\r\n        \"DATE\",\r\n        \"VOUCHER NUMBER\",\r\n        \"PARTY NAME\",\r\n        \"GSTIN\",\r\n        \"ADDRESS\",\r\n        \"STATE\",\r\n        \"BUYER CITYPIN\",\r\n        \"BUYER STATE CODE\",\r\n        \"CONSIGNEE NAME\",\r\n        \"CONSIGNEE ADDRESS\",\r\n        \"CONSIGNEE CITYPIN\",\r\n        \"CONSIGNEE STATE\",\r\n        \"CONSIGNEE STATE CODE\",\r\n        \"ITEM NAME\",\r\n        \"HSN CODE\",\r\n        \"QTY\",\r\n        \"UOM\",\r\n        \"RATE\",\r\n        \"TAXABLE VALUE\",\r\n        \"CGST %\",\r\n        \"SGST %\",\r\n        \"IGST %\",\r\n        \"TOTAL VALUE\",\r\n        \"NARRATION\",\r\n        \"ROUND OFF\",\r\n        \"PLACE OF SUPPLY\",\r\n        \"TERMS OF PAYMENT\",\r\n        \"EWAY BILL NO\",\r\n        \"LR DATE\",\r\n        \"INV TAXABLE TOTAL\",\r\n        \"INV DISCOUNT %\",\r\n        \"INV DISCOUNT AMOUNT\",\r\n        \"INV TAXABLE AFTER DISC\",\r\n        \"INV GST TOTAL\",\r\n        \"INV ROUND OFF\",\r\n        \"INV GRAND TOTAL\",\r\n        \"INV ADVANCE\",\r\n        \"INV SPLIT1 AMT\",\r\n        \"INV SPLIT1 MODE\",\r\n        \"INV SPLIT1 REF\",\r\n        \"INV SPLIT2 AMT\",\r\n        \"INV SPLIT2 MODE\",\r\n        \"INV SPLIT2 REF\",\r\n        \"INV PAID NOW\",\r\n        \"INV BALANCE\",\r\n      ],\r\n    });\r\n\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, \"Invoice\");\r\n    const fileName = `Invoice_${invMeta.invoiceNo.replace(\r\n      /[\\/\\\\:*?\"<>|]/g,\r\n      \"-\"\r\n    )}.xlsx`;\r\n    XLSX.writeFile(wb, fileName);\r\n  };\r\n\r\n  // ===================== PRINT (with split payment details) =====================\r\n  const printNow = () => {\r\n    const missing = [];\r\n    if (!buyer.name.trim()) missing.push(\"Buyer Name\");\r\n    if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\r\n    if (!buyer.city.trim()) missing.push(\"Buyer City\");\r\n    if (!buyer.pin?.trim?.()) missing.push(\"Buyer PIN\");\r\n\r\n    if (missing.length) {\r\n      alert(\"Please fill mandatory fields:\\n\" + missing.join(\"\\n\"));\r\n      return;\r\n    }\r\n\r\n    const issues = [];\r\n    lines.forEach((l, i) => {\r\n      if (!l.itemName || !Number(l.qty)) return;\r\n      const st = statuses[i];\r\n      if (!st?.exists) issues.push(`Row ${i + 1}: Item not found in inventory`);\r\n      else if (!st?.can_deliver)\r\n        issues.push(`Row ${i + 1}: Only ${st.stock} in stock`);\r\n    });\r\n    if (issues.length) {\r\n      alert(\"Please fix before printing:\\n\" + issues.join(\"\\n\"));\r\n      return;\r\n    }\r\n\r\n    const wnd = window.open(\"\", \"_blank\");\r\n    if (!wnd) return;\r\n\r\n    const useConsignee = consigneeDifferent ? consignee : buyer;\r\n    const fmtL = (d) =>\r\n      new Date(d).toLocaleDateString(\"en-IN\", {\r\n        day: \"2-digit\",\r\n        month: \"short\",\r\n        year: \"numeric\",\r\n      });\r\n\r\n    // build invoice rows for print\r\n    const rowHtmlArr = (computed.rows.length ? computed.rows : []).map(\r\n      (r, i) => {\r\n        const pct = Math.max(0, Number(discountPct || 0));\r\n        const factor = 1 - pct / 100;\r\n\r\n        const lineBase = r.lineTaxable;\r\n        const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\r\n        const amountWithTaxRaw =\r\n          lineTaxableDisc + (lineTaxableDisc * r.gstRate) / 100;\r\n\r\n        const taxLabel = r.gstRate\r\n          ? isInterState\r\n            ? `${r.gstRate}% IGST`\r\n            : `${(r.gstRate / 2).toFixed(0)}% + ${(r.gstRate / 2).toFixed(\r\n                0\r\n              )}%`\r\n          : \"-\";\r\n\r\n        return `\r\n        <tr>\r\n          <td class=\"c\">${i + 1}</td>\r\n          <td>${escapeHtml(r.itemName)}</td>\r\n          <td class=\"c\">${escapeHtml(r.hsn || \"\")}</td>\r\n          <td class=\"r\">${r.qty}</td>\r\n          <td class=\"c\">${escapeHtml(r.unit || \"KGS\")}</td>\r\n          <td class=\"r\">${toINR(r.rate)}</td>\r\n          <td class=\"r\">${toINR(lineBase)}</td>\r\n          <td class=\"c\">${taxLabel}</td>\r\n          <td class=\"r\">${toINR(amountWithTaxRaw)}</td>\r\n        </tr>`;\r\n      }\r\n    );\r\n\r\n    // pad rows to fixed count (10)\r\n    const TARGET_ROWS = 10;\r\n    const blankCount = Math.max(0, TARGET_ROWS - rowHtmlArr.length);\r\n    for (let k = 0; k < blankCount; k++) {\r\n      rowHtmlArr.push(`\r\n        <tr>\r\n          <td class=\"c\">&nbsp;</td>\r\n          <td>&nbsp;</td>\r\n          <td class=\"c\">&nbsp;</td>\r\n          <td class=\"r\">&nbsp;</td>\r\n          <td class=\"c\">&nbsp;</td>\r\n          <td class=\"r\">&nbsp;</td>\r\n          <td class=\"r\">&nbsp;</td>\r\n          <td class=\"c\">&nbsp;</td>\r\n          <td class=\"r\">&nbsp;</td>\r\n        </tr>`);\r\n    }\r\n\r\n    const rowsHtml =\r\n      rowHtmlArr.join(\"\") ||\r\n      `<tr><td colspan=\"9\" class=\"c muted\">No items</td></tr>`;\r\n\r\n    const cssHref =\r\n      Array.from(document.styleSheets)\r\n        .map((s) => s.href)\r\n        .filter(Boolean)\r\n        .find((h) => h.includes(\"BillingPanel.css\")) || \"BillingPanel.css\";\r\n\r\n    // totals used in print\r\n    const adv = paidNow; // advance + split payments\r\n    const balanceDue = balanceAfterSplits;\r\n\r\n    // NEW: split details rows\r\n    const splitLinesHtml = splitEnabled\r\n      ? `\r\n            <tr><td colspan=\"8\" class=\"r\">Split #1 (${escapeHtml(\r\n              split1.mode || \"-\"\r\n            )})</td><td class=\"r\">${toINR(n(split1.amount))}</td></tr>\r\n            ${\r\n              n(split2.amount) > 0\r\n                ? `<tr><td colspan=\"8\" class=\"r\">Split #2 (${escapeHtml(\r\n                    split2.mode || \"-\"\r\n                  )})</td><td class=\"r\">${toINR(n(split2.amount))}</td></tr>`\r\n                : \"\"\r\n            }\r\n        `\r\n      : \"\";\r\n\r\n    const html = `<!doctype html><html><head><meta charset=\"utf-8\" />\r\n      <title>Tax Invoice</title>\r\n      <link rel=\"stylesheet\" href=\"${cssHref}\">\r\n      <style>\r\n        @page { size: A4; margin: 10mm; }\r\n        @media print {\r\n          html, body { width: 210mm; }\r\n          .shell { border: 0; padding: 0; }\r\n          table { page-break-inside: auto; }\r\n          tr { page-break-inside: avoid; break-inside: avoid; }\r\n          thead { display: table-header-group; }\r\n          tfoot { display: table-footer-group; }\r\n        }\r\n        body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:16px}\r\n        .small{font-size:12px;color:#555}\r\n        .muted{color:#6b7280}\r\n        .r{text-align:right}.c{text-align:center}\r\n        .shell{border:1px solid #111; padding:12px}\r\n        .grid{display:grid; grid-template-columns: 1.2fr .9fr; gap:12px}\r\n        .box{border:1px solid #111; padding:8px}\r\n        .two{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:8px}\r\n        .foot{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px}\r\n        .hr{border-top:1px solid #ddd; margin:6px 0}\r\n        table{width:100%; border-collapse:collapse; margin-top:8px}\r\n        th,td{border:1px solid #111; padding:6px; font-size:13px}\r\n        th{background:#f9fafb; white-space:nowrap}\r\n        td:nth-child(2){word-break:break-word}\r\n        tbody tr:nth-child(odd){background:#fcfcfc}\r\n      </style>\r\n    </head>\r\n    <body class=\"invoice-print\">\r\n      <div class=\"shell\">\r\n        <div class=\"grid\">\r\n          <div class=\"box\">\r\n            <div style=\"display:flex;justify-content:space-between;align-items:center\">\r\n              <div>\r\n                <div style=\"font-size:18px;font-weight:700\">${escapeHtml(\r\n                  company?.name || \"\"\r\n                )}</div>\r\n                <div class=\"small\">${escapeHtml(company?.addr1 || \"\")}</div>\r\n                <div class=\"small\">${escapeHtml(company?.addr2 || \"\")}</div>\r\n                <div class=\"small\">${escapeHtml(company?.city || \"\")}</div>\r\n                <div class=\"small\">State: ${escapeHtml(\r\n                  company?.state || \"-\"\r\n                )}, Code: ${escapeHtml(company?.stateCode || \"-\")}</div>\r\n                <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                  company?.gstin || \"-\"\r\n                )}</div>\r\n                ${\r\n                  company?.email\r\n                    ? `<div class=\"small\">E-Mail : ${escapeHtml(\r\n                        company.email\r\n                      )}</div>`\r\n                    : \"\"\r\n                }\r\n                ${\r\n                  company?.mobile || company?.phone || company?.whatsapp\r\n                    ? `<div class=\"small\">Phone : ${escapeHtml(\r\n                        [company.mobile, company.phone]\r\n                          .filter(Boolean)\r\n                          .join(\" / \")\r\n                      )}${\r\n                        company?.whatsapp\r\n                          ? \" | WhatsApp: \" + escapeHtml(company.whatsapp)\r\n                          : \"\"\r\n                      }</div>`\r\n                    : \"\"\r\n                }\r\n              </div>\r\n              <div style=\"font-size:12px;font-weight:700\">Tax invoice</div>\r\n            </div>\r\n\r\n            <div class=\"two\">\r\n              <div class=\"box\">\r\n                <div style=\"font-weight:600;font-size:12px\">Consignee (Ship To)</div>\r\n                <div style=\"font-weight:600\">${escapeHtml(\r\n                  useConsignee.name || \"-\"\r\n                )}</div>\r\n                \r\n                <div class=\"small\">${escapeHtml(\r\n                  useConsignee.addr1 || \"\"\r\n                )}</div>\r\n                <div class=\"small\">${escapeHtml(\r\n                  useConsignee.addr2 || \"\"\r\n                )}</div>\r\n                <div class=\"small\">${escapeHtml(\r\n                  useConsignee.city || \"\"\r\n                )}</div>\r\n                <div class=\"small\">State: ${escapeHtml(\r\n                  useConsignee.state || \"-\"\r\n                )}, Code: ${escapeHtml(useConsignee.stateCode || \"-\")}</div>\r\n                <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                  useConsignee.gstin || \"-\"\r\n                )}</div>\r\n              </div>\r\n              <div class=\"box\">\r\n                <div style=\"font-weight:600;font-size:12px\">Buyer (Bill To)</div>\r\n                <div style=\"font-weight:600\">${escapeHtml(\r\n                  buyer.name || \"-\"\r\n                )}</div>\r\n                  ${\r\n    buyer.mobile\r\n      ? `<div class=\"small\">Mobile: ${escapeHtml(buyer.mobile)}</div>`\r\n      : \"\"\r\n  }\r\n                \r\n                <div class=\"small\">${escapeHtml(buyer.addr1 || \"\")}</div>\r\n                <div class=\"small\">${escapeHtml(buyer.addr2 || \"\")}</div>\r\n                <div class=\"small\">${escapeHtml(buyer.city || \"\")}</div>\r\n                <div class=\"small\">State: ${escapeHtml(\r\n                  buyer.state || \"-\"\r\n                )}, Code: ${escapeHtml(buyer.stateCode || \"-\")}</div>\r\n                <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                  buyer.gstin || \"-\"\r\n                )}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"box\">\r\n            <table>\r\n              <tbody>\r\n                <tr><td style=\"width:45%\">Invoice No</td><td>${escapeHtml(\r\n                  invMeta.invoiceNo\r\n                )}</td></tr>\r\n                <tr><td>Date</td><td>${fmtL(invMeta.date)}</td></tr>\r\n                <tr><td>Terms of Payment</td><td>${escapeHtml(\r\n                  paymentMode || \"-\"\r\n                )}</td></tr>\r\n                <tr><td>e-Way Bill No</td><td>${escapeHtml(\r\n                  invMeta.ewayNo || \"-\"\r\n                )}</td></tr>\r\n                <tr><td>LR / Date</td><td>${escapeHtml(\r\n                  invMeta.lrDate || \"-\"\r\n                )}</td></tr>\r\n                <tr><td>Vehicle No</td><td>${escapeHtml(\r\n                  invMeta.vehicleNo || \"-\"\r\n                )}</td></tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        <table style=\"margin-top:8px\">\r\n          <thead>\r\n            <tr>\r\n              <th style=\"width:36px\">S.No</th>\r\n              <th>Description of Goods</th>\r\n              <th>HSN/SAC</th>\r\n              <th class=\"r\">Quantity</th>\r\n              <th>Unit</th>\r\n              <th class=\"r\">Rate</th>\r\n              <th class=\"r\">Price</th>\r\n              <th class=\"c\">GST %</th>\r\n              <th class=\"r\">Amount</th>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            ${rowsHtml}\r\n            <tr><td colspan=\"8\" class=\"r\"><b>Taxable Value</b></td><td class=\"r\"><b>${toINR(\r\n              computed.taxable\r\n            )}</b></td></tr>\r\n            <tr><td colspan=\"8\" class=\"r\">Discount (${Number(\r\n              discountPct || 0\r\n            )}%)</td><td class=\"r\">-${toINR(\r\n      computed.discountAmount\r\n    )}</td></tr>\r\n            <tr><td colspan=\"8\" class=\"r\">Taxable After Discount</td><td class=\"r\">${toINR(\r\n              computed.discountedTaxable\r\n            )}</td></tr>\r\n            ${\r\n              isInterState\r\n                ? `<tr><td colspan=\"8\" class=\"r\"><b>IGST (rounded)</b></td><td class=\"r\"><b>${toINR(\r\n                    computed.igstRounded\r\n                  )}</b></td></tr>`\r\n                : `<tr><td colspan=\"8\" class=\"r\">CGST (rounded)</td><td class=\"r\">${toINR(\r\n                    computed.cgstRounded\r\n                  )}</td></tr>\r\n                   <tr><td colspan=\"8\" class=\"r\">SGST (rounded)</td><td class=\"r\">${toINR(\r\n                     computed.sgstRounded\r\n                   )}</td></tr>`\r\n            }\r\n            <tr><td colspan=\"8\" class=\"r\">Round Off (GST rounding)</td><td class=\"r\">${toINR(\r\n              computed.roundOff\r\n            )}</td></tr>\r\n            <tr><td colspan=\"8\" class=\"r\"><b>Total</b></td><td class=\"r\"><b>${toINR(\r\n              computed.total\r\n            )}</b></td></tr>\r\n            <tr><td colspan=\"8\" class=\"r\"><b>Grand Total</b></td><td class=\"r\"><b>${toINR(\r\n              computed.grand\r\n            )}</b></td></tr>\r\n\r\n            ${splitLinesHtml}\r\n\r\n            <tr><td colspan=\"8\" class=\"r\">Advance / Received</td><td class=\"r\">-${toINR(\r\n              adv\r\n            )}</td></tr>\r\n            <tr><td colspan=\"8\" class=\"r\"><b>Balance Due</b></td><td class=\"r\"><b>${toINR(\r\n              balanceDue\r\n            )}</b></td></tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"foot\">\r\n          <div class=\"box\">\r\n            <div><b>Amount Chargeable (in words)</b></div>\r\n            <div class=\"small\" style=\"margin-top:4px\">INR ${numberToWordsIndian(\r\n              Math.round(computed.grand)\r\n            )} Only</div>\r\n            <div class=\"hr\"></div>\r\n            <div class=\"small\"><b>Tax Amount (in words)</b></div>\r\n            <div class=\"small\">INR ${numberToWordsIndian(\r\n              Math.round(computed.gstRounded)\r\n            )} Only</div>\r\n          </div>\r\n          <div class=\"box\">\r\n            <div class=\"small\"><b>Company's Bank Details</b></div>\r\n            ${\r\n              defaultBank\r\n                ? `\r\n              <div class=\"small\">Bank : ${escapeHtml(\r\n                defaultBank.bankName || \"\"\r\n              )}</div>\r\n              <div class=\"small\">Branch & IFSC : ${escapeHtml(\r\n                defaultBank.branch || \"\"\r\n              )} & ${escapeHtml(\r\n                    defaultBank.ifsc || \"\"\r\n                  )}</div>\r\n              <div class=\"small\">A/C No : ${escapeHtml(\r\n                defaultBank.account || \"\"\r\n              )}</div>`\r\n                : `<div class=\"small\">No bank selected</div>`\r\n            }\r\n            <div class=\"hr\"></div>\r\n            <div class=\"small c\">For ${escapeHtml(company?.name || \"\")}</div>\r\n            <div style=\"height:48px\"></div>\r\n            <div class=\"small r\">Authorised Signatory</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"small\" style=\"margin-top:8px\">\r\n          <b>Declaration:</b> We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct.\r\n          <div>SUBJECT TO TRICHY JURISDICTION</div>\r\n        </div>\r\n      </div>\r\n      <script>window.onload = () => window.print();</script>\r\n    </body></html>`;\r\n\r\n    wnd.document.write(html);\r\n    wnd.document.close();\r\n  };\r\n\r\n  // ================= UI =================\r\n  return (\r\n    <div className=\"billing-full card\">\r\n      <div className=\"row\">\r\n        {/* Invoice meta */}\r\n        <div>\r\n          <div className=\"form-grid-4\" style={{ marginTop: 6 }}>\r\n            <div>\r\n              <label>Invoice No.</label>\r\n              <input\r\n                value={invMeta.invoiceNo}\r\n                onChange={(e) =>\r\n                  setInvMeta((m) => ({ ...m, invoiceNo: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>Date</label>\r\n              <input\r\n                type=\"date\"\r\n                value={invMeta.date}\r\n                onChange={(e) =>\r\n                  setInvMeta((m) => ({ ...m, date: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div\r\n              style={{ display: \"flex\", gap: \"20px\", alignItems: \"center\" }}\r\n            >\r\n              <div className=\"meta-row\">\r\n                <div className=\"meta-field\">\r\n                  <label>eWay Bill No</label>\r\n                  <input\r\n                    value={invMeta.ewayNo}\r\n                    onChange={(e) =>\r\n                      setInvMeta((m) => ({ ...m, ewayNo: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"meta-field\">\r\n                  <label>KMs</label>\r\n                  <input\r\n                    value={invMeta.kms || \"\"}\r\n                    onChange={(e) =>\r\n                      setInvMeta((m) => ({\r\n                        ...m,\r\n                        kms: e.target.value.replace(/[^0-9]/g, \"\"),\r\n                      }))\r\n                    }\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"meta-field\">\r\n                  <label>From Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={invMeta.fromDate || \"\"}\r\n                    onChange={(e) =>\r\n                      setInvMeta((m) => ({ ...m, fromDate: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"meta-field\">\r\n                  <label>To Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={invMeta.toDate || \"\"}\r\n                    onChange={(e) =>\r\n                      setInvMeta((m) => ({ ...m, toDate: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/*\r\n            <div>\r\n              <label>LR Date</label>\r\n              <input\r\n                type=\"date\"\r\n                value={invMeta.lrDate}\r\n                onChange={(e) =>\r\n                  setInvMeta((m) => ({ ...m, lrDate: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            */}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Buyer */}\r\n        <div>\r\n          <div className=\"small\">Buyer (Bill To)</div>\r\n          <div className=\"form-grid-4\" style={{ marginTop: 6 }}>\r\n           <div className=\"row-2\">\r\n  <div style={{ position: \"relative\" }}>\r\n  <label>Name *</label>\r\n  <input\r\n    value={buyer.name}\r\n    onChange={(e) => {\r\n      const v = e.target.value;\r\n      setBuyer((b) => ({ ...b, name: v }));\r\n      setNameQuery(v);\r\n    }}\r\n    onFocus={() => setNameQuery(buyer.name || \" \")}\r\n    placeholder=\"Type buyer name...\"\r\n    autoComplete=\"off\"\r\n  />\r\n\r\n  {/* dropdown */}\r\n  {nameSuggest.length > 0 && (\r\n    <div\r\n      style={{\r\n        position: \"absolute\",\r\n        top: \"100%\",\r\n        left: 0,\r\n        right: 0,\r\n        background: \"#fff\",\r\n        border: \"1px solid #ddd\",\r\n        zIndex: 50,\r\n        maxHeight: 220,\r\n        overflowY: \"auto\",\r\n        borderRadius: 8,\r\n      }}\r\n    >\r\n      {nameSuggest.map((a, idx) => (\r\n        <div\r\n          key={`${a.mobile || \"\"}-${idx}`}\r\n          onMouseDown={(e) => {\r\n            e.preventDefault(); // IMPORTANT: prevents blur before click\r\n            pickName(a);\r\n          }}\r\n          style={{\r\n            padding: \"8px 10px\",\r\n            cursor: \"pointer\",\r\n            borderBottom: \"1px solid #f1f1f1\",\r\n          }}\r\n        >\r\n          <div style={{ fontWeight: 600 }}>{a.name}</div>\r\n          <div style={{ fontSize: 12, color: \"#666\" }}>\r\n            {a.mobile ? `ðŸ“± ${a.mobile}` : \"\"}\r\n            {a.city ? ` â€¢ ${a.city}` : \"\"}\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )}\r\n</div>\r\n\r\n  <div>\r\n  <label>Mobile No.</label>\r\n  <input\r\n    type=\"tel\"\r\n    list=\"mobile-suggest\"\r\n    placeholder=\"10-digit mobile\"\r\n    value={buyer.mobile}\r\n    onChange={async (e) => {\r\n      const v = String(e.target.value).replace(/[^0-9]/g, \"\").slice(0, 10);\r\n      setBuyer((b) => ({ ...b, mobile: v }));\r\n      setMobileQuery(v);\r\n\r\n      // when full 10 digits â†’ autofill\r\n      if (v.length === 10) {\r\n        try {\r\n          const acc = await apiAccountByMobile(v);\r\n          if (acc) fillBuyerFromAccount(acc);\r\n        } catch {}\r\n        setMobileSuggest([]);\r\n      }\r\n    }}\r\n    onBlur={async () => {\r\n      const v = (buyer.mobile || \"\").trim();\r\n      if (v.length === 10) {\r\n        try {\r\n          const acc = await apiAccountByMobile(v);\r\n          if (acc) fillBuyerFromAccount(acc);\r\n        } catch {}\r\n      }\r\n      setMobileSuggest([]);\r\n    }}\r\n  />\r\n\r\n  <datalist id=\"mobile-suggest\">\r\n    {mobileSuggest.map((a, idx) => (\r\n      <option key={`${a.mobile}-${idx}`} value={a.mobile}>\r\n        {a.name ? `${a.name} - ${a.mobile}` : a.mobile}\r\n      </option>\r\n    ))}\r\n  </datalist>\r\n</div>\r\n\r\n</div>\r\n\r\n           <div className=\"row-2\">\r\n  {/* GSTIN */}\r\n  <div>\r\n    <label>GSTIN / UIN</label>\r\n    <input\r\n      value={buyer.gstin}\r\n      onChange={(e) =>\r\n        setBuyer((b) => ({ ...b, gstin: e.target.value }))\r\n      }\r\n    />\r\n  </div>\r\n\r\n  {/* ACCOUNT (LEDGER) */}\r\n  <div style={{ position: \"relative\" }}>\r\n    <label>Account (Ledger)</label>\r\n    <input\r\n      value={accQuery}\r\n      onChange={(e) => {\r\n        setAccQuery(e.target.value);\r\n        setSelectedAccount(null);\r\n      }}\r\n      onFocus={() => {\r\n  if (accQuery.length === 0) setAccSuggest([]);\r\n}}\r\n      placeholder=\"Search accountâ€¦\"\r\n      autoComplete=\"off\"\r\n    />\r\n\r\n    {/* Dropdown */}\r\n    {accSuggest.length > 0 && (\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          top: \"100%\",\r\n          left: 0,\r\n          right: 0,\r\n          background: \"#fff\",\r\n          border: \"1px solid #ddd\",\r\n          zIndex: 60,\r\n          maxHeight: 220,\r\n          overflowY: \"auto\",\r\n          borderRadius: 8,\r\n        }}\r\n      >\r\n        {accSuggest.map((a, idx) => (\r\n          <div\r\n            key={`${a.account_id}-${idx}`}\r\n            onMouseDown={(e) => {\r\n              e.preventDefault(); // prevent blur\r\n              pickAccount(a);\r\n            }}\r\n            style={{\r\n              padding: \"8px 10px\",\r\n              cursor: \"pointer\",\r\n              borderBottom: \"1px solid #f1f1f1\",\r\n            }}\r\n          >\r\n            <div style={{ fontWeight: 600 }}>{a.name}</div>\r\n            <div style={{ fontSize: 12, color: \"#666\" }}>\r\n              ID: {a.account_id}\r\n              {a.mobile ? ` â€¢ ðŸ“± ${a.mobile}` : \"\"}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    )}\r\n  </div>\r\n</div>\r\n\r\n            <div className=\"row-2\">\r\n              <div>\r\n                <label>State</label>\r\n                <input\r\n                  value={buyer.state}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({ ...b, state: e.target.value }))\r\n                  }\r\n                  placeholder=\"Tamil Nadu\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>State Code</label>\r\n                <input\r\n                  value={buyer.stateCode}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({\r\n                      ...b,\r\n                      stateCode: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                    }))\r\n                  }\r\n                  placeholder=\"33\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label>Address 1 *</label>\r\n              <input\r\n                value={buyer.addr1}\r\n                onChange={(e) =>\r\n                  setBuyer((b) => ({ ...b, addr1: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>Address 2</label>\r\n              <input\r\n                value={buyer.addr2}\r\n                onChange={(e) =>\r\n                  setBuyer((b) => ({ ...b, addr2: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div className=\"row-2\">\r\n              <div>\r\n                <label>City *</label>\r\n                <input\r\n                  value={buyer.city}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({ ...b, city: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>PIN *</label>\r\n                <input\r\n                  value={buyer.pin}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({\r\n                      ...b,\r\n                      pin: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                    }))\r\n                  }\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Consignee toggle */}\r\n      <div className=\"stack\" style={{ marginTop: 4 }}>\r\n        <label\r\n          className=\"small\"\r\n          style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n        >\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={consigneeDifferent}\r\n            onChange={(e) => setConsigneeDifferent(e.target.checked)}\r\n            style={{ width: 16, height: 16 }}\r\n          />\r\n          Consignee different from Buyer?\r\n        </label>\r\n        {!consigneeDifferent && (\r\n          <span className=\"badge\">Using Buyer as Consignee</span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Consignee fields */}\r\n      {consigneeDifferent && (\r\n        <div className=\"card\" style={{ marginTop: 8 }}>\r\n          <div className=\"small\">Consignee (Ship To)</div>\r\n\r\n          <div className=\"form-grid-3\" style={{ marginTop: 6 }}>\r\n            <div>\r\n              <label>Name</label>\r\n              <input\r\n                value={consignee.name}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, name: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>GSTIN/UIN</label>\r\n              <input\r\n                value={consignee.gstin}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, gstin: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>State Code</label>\r\n              <input\r\n                value={consignee.stateCode}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({\r\n                    ...c,\r\n                    stateCode: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                  }))\r\n                }\r\n                placeholder=\"33\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-grid-3\" style={{ marginTop: 6 }}>\r\n            <div>\r\n              <label>State</label>\r\n              <input\r\n                value={consignee.state}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, state: e.target.value }))\r\n                }\r\n                placeholder=\"Tamil Nadu\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>City</label>\r\n              <input\r\n                value={consignee.city}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, city: e.target.value }))\r\n                }\r\n              />\r\n            </div>\r\n            <div>\r\n              <label>PIN</label>\r\n              <input\r\n                value={consignee.pin || \"\"}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({\r\n                    ...c,\r\n                    pin: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                  }))\r\n                }\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ marginTop: 6 }}>\r\n            <label>Address 1</label>\r\n            <input\r\n              value={consignee.addr1}\r\n              onChange={(e) =>\r\n                setConsignee((c) => ({ ...c, addr1: e.target.value }))\r\n              }\r\n              style={{ width: \"100%\" }}\r\n            />\r\n          </div>\r\n\r\n          <div style={{ marginTop: 6 }}>\r\n            <label>Address 2</label>\r\n            <input\r\n              value={consignee.addr2}\r\n              onChange={(e) =>\r\n                setConsignee((c) => ({ ...c, addr2: e.target.value }))\r\n              }\r\n              style={{ width: \"100%\" }}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Items table */}\r\n      <div className=\"card\" style={{ marginTop: 12 }}>\r\n        <table\r\n          className=\"items-table\"\r\n          style={{ width: \"100%\", tableLayout: \"fixed\" }}\r\n        >\r\n          <colgroup>\r\n            <col style={{ width: 44 }} />\r\n            <col />\r\n            <col style={{ width: 100 }} />\r\n            <col style={{ width: 84 }} />\r\n            <col style={{ width: 72 }} />\r\n            <col style={{ width: 96 }} />\r\n            <col style={{ width: 108 }} />\r\n            <col style={{ width: 84 }} />\r\n            <col style={{ width: 116 }} />\r\n            <col style={{ width: 56 }} />\r\n          </colgroup>\r\n\r\n          <thead>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>Description of Goods</th>\r\n              <th>HSN</th>\r\n              <th className=\"right\">Qty</th>\r\n              <th className=\"center\">Unit</th>\r\n              <th className=\"right\">Rate</th>\r\n              <th className=\"right\">Price</th>\r\n              <th className=\"right\">GST %</th>\r\n              <th className=\"right\">Amount</th>\r\n              <th className=\"center\">âœ–</th>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            {lines.map((l, i) => {\r\n              const qty = Number(l.qty || 0);\r\n              const rate = Number(l.unitPrice || 0);\r\n              const gstPct = Number(l.gst || 0);\r\n              const price = qty * rate;\r\n              const st = statuses[i];\r\n\r\n              const disableRowInputs =\r\n                !!st &&\r\n                (!st.exists ||\r\n                  (typeof st.stock === \"number\" && st.stock <= 0));\r\n\r\n              return (\r\n                <tr key={i}>\r\n                  <td>{i + 1}</td>\r\n                  <td>\r\n                    <input\r\n                      list=\"bill-suggest\"\r\n                      placeholder=\"Type to search Purchasesâ€¦\"\r\n                      value={l.itemName}\r\n                      onChange={(e) => handleItemChange(i, e.target.value)}\r\n                      onFocus={(e) =>\r\n                        setActiveQuery(e.target.value || \" \")\r\n                      }\r\n                    />\r\n                    <datalist id=\"bill-suggest\">\r\n                      {suggest.map((s, idx) => (\r\n                        <option\r\n                          key={`${s.name}-${idx}`}\r\n                          value={s.name}\r\n                        />\r\n                      ))}\r\n                    </datalist>\r\n                    {l.itemName && st && (\r\n                      <div\r\n                        className=\"small\"\r\n                        style={{\r\n                          color:\r\n                            st.exists &&\r\n                            Number(l.qty || 0) <= st.stock\r\n                              ? \"#047857\"\r\n                              : \"#b91c1c\",\r\n                        }}\r\n                      >\r\n                        {!st.exists && \"Not available in Inventory\"}\r\n                        {st.exists &&\r\n                          st.stock === 0 &&\r\n                          \"Out of stock\"}\r\n                        {st.exists &&\r\n                          st.stock > 0 &&\r\n                          Number(l.qty || 0) === 0 &&\r\n                          `In stock: ${st.stock}`}\r\n                        {st.exists &&\r\n                          Number(l.qty || 0) > st.stock &&\r\n                          `Only ${st.stock} in stock`}\r\n                        {st.exists &&\r\n                          Number(l.qty || 0) > 0 &&\r\n                          Number(l.qty || 0) <= st.stock &&\r\n                          `Available: ${st.stock}`}\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n\r\n                  <td>\r\n                    <input\r\n                      value={l.hsn}\r\n                      onChange={(e) => handleHSN(i, e.target.value)}\r\n                      disabled={disableRowInputs}\r\n                    />\r\n                  </td>\r\n\r\n                  <td className=\"right\">\r\n                    <input\r\n                      value={l.qty}\r\n                      onChange={(e) => handleQty(i, e.target.value)}\r\n                      onBlur={(e) =>\r\n                        updateAvailability(\r\n                          i,\r\n                          l.itemName,\r\n                          e.target.value\r\n                        )\r\n                      }\r\n                      disabled={disableRowInputs}\r\n                    />\r\n                  </td>\r\n\r\n                  <td className=\"center\">\r\n                    <input value=\"KG\" readOnly />\r\n                  </td>\r\n\r\n                  <td className=\"right\">\r\n                    <input\r\n                      value={l.unitPrice}\r\n                      onChange={(e) => handlePrice(i, e.target.value)}\r\n                      disabled={disableRowInputs}\r\n                    />\r\n                  </td>\r\n\r\n                  <td className=\"right\">{toINR(price)}</td>\r\n\r\n                  <td className=\"right\">\r\n                    <input\r\n                      value={l.gst}\r\n                      onChange={(e) => handleGST(i, e.target.value)}\r\n                      disabled={disableRowInputs}\r\n                    />\r\n                  </td>\r\n\r\n                  <td className=\"right\">\r\n                    {toINR(price + (price * gstPct) / 100)}\r\n                  </td>\r\n\r\n                  <td className=\"center\">\r\n                    <button\r\n                      className=\"btn warn\"\r\n                      onClick={() => removeRow(i)}\r\n                    >\r\n                      Del\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n\r\n          <tfoot>\r\n            <tr>\r\n              <td colSpan={10}>\r\n                <div className=\"stack\">\r\n                  <button className=\"btn\" onClick={addRow}>\r\n                    + Add Item\r\n                  </button>\r\n                  <div className=\"muted\">\r\n                    Type to search from <b>Purchases</b>. Unit is fixed\r\n                    to <b>KG</b>; Rate &amp; GST% auto-fill from the\r\n                    latest Purchase; HSN from Inventory.\r\n                  </div>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Totals + payments */}\r\n      <div className=\"totals-grid\">\r\n        <div />\r\n        <div className=\"card\" style={{ padding: 12 }}>\r\n          <div\r\n            className=\"row\"\r\n            style={{ gridTemplateColumns: \"1fr 1fr\", margin: 0 }}\r\n          >\r\n            <div className=\"small\">Taxable Amount</div>\r\n            <div className=\"right\">\r\n              <b>{toINR(computed.taxable)}</b>\r\n            </div>\r\n\r\n            <div\r\n              className=\"small\"\r\n              style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n            >\r\n              Discount (%)\r\n            </div>\r\n            <div className=\"right\">\r\n              <input\r\n                value={discountPct}\r\n                onChange={(e) =>\r\n                  setDiscountPct(\r\n                    String(e.target.value).replace(/[^0-9.]/g, \"\")\r\n                  )\r\n                }\r\n                style={{ width: 120, textAlign: \"right\" }}\r\n                placeholder=\"0\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"small\">Discount Amount</div>\r\n            <div className=\"right\">\r\n              -{toINR(computed.discountAmount)}\r\n            </div>\r\n\r\n            <div className=\"small\">\r\n              {isInterState ? \"GST (IGST)\" : \"GST (CGST+SGST)\"}\r\n            </div>\r\n            <div className=\"right\">\r\n              <b>\r\n                {isInterState\r\n                  ? toINR(computed.igstRounded)\r\n                  : toINR(\r\n                      computed.cgstRounded + computed.sgstRounded\r\n                    )}\r\n              </b>\r\n            </div>\r\n\r\n            <div className=\"small\">Round Off (GST rounding)</div>\r\n            <div className=\"right\">\r\n              {toINR(computed.roundOff)}\r\n            </div>\r\n\r\n            <div className=\"small\">Total</div>\r\n            <div className=\"right\">\r\n              <b>{toINR(computed.total)}</b>\r\n            </div>\r\n\r\n            <div className=\"small\" style={{ marginTop: 6 }}>\r\n              <b>Grand Total</b>\r\n            </div>\r\n            <div className=\"right\" style={{ marginTop: 6 }}>\r\n              <b>{toINR(computed.grand)}</b>\r\n            </div>\r\n\r\n            {/* Advance / Partial Payment field hidden */}\r\n            {/* \r\n            <div className=\"small\" style={{ marginTop: 8 }}>\r\n              Advance / Partial Payment\r\n            </div>\r\n            <div className=\"right\" style={{ marginTop: 8 }}>\r\n              <input\r\n                value={advance}\r\n                onChange={(e) =>\r\n                  setAdvance(\r\n                    String(e.target.value).replace(/[^0-9]/g, \"\")\r\n                  )\r\n                }\r\n                style={{ width: 120, textAlign: \"right\" }}\r\n                placeholder=\"0\"\r\n              />\r\n            </div>\r\n            */}\r\n\r\n            <div className=\"small\">Terms of Payment</div>\r\n            <div className=\"right\">\r\n              <select\r\n                value={paymentMode}\r\n                onChange={(e) => setPaymentMode(e.target.value)}\r\n                style={{ width: 140, textAlign: \"right\" }}\r\n              >\r\n                <option value=\"\">Select</option>\r\n                {paymentModes.map((m) => (\r\n                  <option key={\"pm-\" + m}>{m}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Split Payments */}\r\n          <hr />\r\n          <div\r\n            className=\"row\"\r\n            style={{ gridTemplateColumns: \"1fr 1fr\", marginTop: 6 }}\r\n          >\r\n            <div\r\n              className=\"small\"\r\n              style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n            >\r\n              Split Payment (max 2)\r\n            </div>\r\n            <div className=\"right\">\r\n              <label\r\n                style={{\r\n                  display: \"inline-flex\",\r\n                  gap: 8,\r\n                  alignItems: \"center\",\r\n                }}\r\n              >\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={splitEnabled}\r\n                  onChange={(e) => setSplitEnabled(e.target.checked)}\r\n                />\r\n                <span className=\"small\">Enable</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {splitEnabled && (\r\n            <>\r\n              <div\r\n                className=\"grid grid-3\"\r\n                style={{\r\n                  display: \"grid\",\r\n                  gridTemplateColumns: \"1fr 1fr 1fr\",\r\n                  gap: 8,\r\n                  marginTop: 8,\r\n                }}\r\n              >\r\n                <div>\r\n                  <label>Split #1 Amount</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    step=\"0.01\"\r\n                    value={split1.amount}\r\n                    onChange={(e) => {\r\n                      const raw = String(e.target.value);\r\n                      const clean = raw.replace(/[^0-9.]/g, \"\");\r\n                      const amt1 = n(clean);\r\n                      const remaining = Math.max(\r\n                        0,\r\n                        +(computed.grand - amt1).toFixed(2)\r\n                      );\r\n                      setSplit1({ ...split1, amount: clean });\r\n                      setSplit2((prev) => ({\r\n                        ...prev,\r\n                        amount:\r\n                          remaining > 0\r\n                            ? String(remaining)\r\n                            : remaining === 0\r\n                            ? \"0\"\r\n                            : prev.amount,\r\n                      }));\r\n                    }}\r\n                    placeholder=\"0\"\r\n                    className=\"right\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label>Split #1 Terms / Mode</label>\r\n                  <select\r\n                    value={split1.mode}\r\n                    onChange={(e) =>\r\n                      setSplit1({ ...split1, mode: e.target.value })\r\n                    }\r\n                  >\r\n                    {paymentModes.map((m) => (\r\n                      <option key={\"m1\" + m} value={m}>\r\n                        {m}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label>Ref / Txn No. (opt)</label>\r\n                  <input\r\n                    value={split1.ref}\r\n                    onChange={(e) =>\r\n                      setSplit1({ ...split1, ref: e.target.value })\r\n                    }\r\n                    placeholder=\"UTR / Cheque / Last 4\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div\r\n                className=\"grid grid-3\"\r\n                style={{\r\n                  display: \"grid\",\r\n                  gridTemplateColumns: \"1fr 1fr 1fr\",\r\n                  gap: 8,\r\n                  marginTop: 8,\r\n                }}\r\n              >\r\n                <div>\r\n                  <label>Split #2 Amount</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    step=\"0.01\"\r\n                    value={split2.amount}\r\n                    onChange={(e) =>\r\n                      setSplit2({ ...split2, amount: e.target.value })\r\n                    }\r\n                    placeholder=\"0\"\r\n                    className=\"right\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label>Split #2 Terms / Mode</label>\r\n                  <select\r\n                    value={split2.mode}\r\n                    onChange={(e) =>\r\n                      setSplit2({ ...split2, mode: e.target.value })\r\n                    }\r\n                  >\r\n                    {paymentModes.map((m) => (\r\n                      <option key={\"m2\" + m} value={m}>\r\n                        {m}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label>Ref / Txn No. (opt)</label>\r\n                  <input\r\n                    value={split2.ref}\r\n                    onChange={(e) =>\r\n                      setSplit2({ ...split2, ref: e.target.value })\r\n                    }\r\n                    placeholder=\"UTR / Cheque / Last 4\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div\r\n                className=\"row\"\r\n                style={{\r\n                  gridTemplateColumns: \"1fr 1fr\",\r\n                  marginTop: 8,\r\n                }}\r\n              >\r\n                <div className=\"small\">\r\n                  Paid Now (Advance + Splits)\r\n                </div>\r\n                <div className=\"right\">{toINR(paidNow)}</div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* SAVE & PRINT */}\r\n      <div className=\"actions-row\">\r\n        <button\r\n          className=\"btn\"\r\n          onClick={async () => {\r\n            const missing = [];\r\n            if (!buyer.name.trim()) missing.push(\"Buyer Name\");\r\n            if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\r\n            if (!buyer.city.trim()) missing.push(\"Buyer City\");\r\n            if (!buyer.pin?.trim?.()) missing.push(\"Buyer PIN\");\r\n            if (!selectedAccount?.account_id) {\r\n  alert(\"Please select Account (Ledger) before saving.\");\r\n  return;\r\n}\r\n\r\n\r\n            if (missing.length) {\r\n              alert(\r\n                \"Please fill mandatory fields:\\n\" + missing.join(\"\\n\")\r\n              );\r\n              return;\r\n            }\r\n\r\n            const issues = [];\r\n            lines.forEach((l, i) => {\r\n              if (!l.itemName || !Number(l.qty)) return;\r\n              const st = statuses[i];\r\n              if (!st?.exists)\r\n                issues.push(\r\n                  `Row ${i + 1}: Item not found in inventory`\r\n                );\r\n              else if (!st?.can_deliver)\r\n                issues.push(\r\n                  `Row ${i + 1}: Only ${st.stock} in stock`\r\n                );\r\n            });\r\n            if (issues.length) {\r\n              alert(\"Please fix before saving:\\n\" + issues.join(\"\\n\"));\r\n              return;\r\n            }\r\n\r\n            if (!computed.rows.length) {\r\n              alert(\"No valid line items to save.\");\r\n              return;\r\n            }\r\n\r\n            // 1) Build FIFO sale payload for backend\r\n            /*const salePayload = {\r\n              bill_no: invMeta.invoiceNo,\r\n              date: invMeta.date,\r\n              party_name: buyer.name || \"\",\r\n              items: computed.rows.map((r) => ({\r\n                item_name: r.itemName,\r\n                qty: Number(r.qty || 0),\r\n                price: Number(r.rate || 0),\r\n                gst: Number(r.gstRate || r.gst || 0),\r\n              })),\r\n            };*/\r\n            // 1) Build FIFO sale payload for backend\r\nconst salePayload = {\r\n  bill_no: invMeta.invoiceNo,\r\n  date: invMeta.date,  \r\n   account_id: selectedAccount.account_id,        // ISO yyyy-mm-dd (backend will store as DATE)\r\n  party_name: buyer.name || \"\",\r\n\r\n  // header totals\r\n  taxable: +computed.taxable.toFixed(2),\r\n  discount_amount: +computed.discountAmount.toFixed(2),\r\n  discounted_taxable: +computed.discountedTaxable.toFixed(2),\r\n  gst_amount: +computed.gstRounded.toFixed(2),\r\n  round_off: +computed.roundOff.toFixed(2),\r\n  grand_total: +computed.grand.toFixed(2),\r\n\r\n  paid_now: +paidNow.toFixed(2),\r\n  balance: +balanceAfterSplits.toFixed(2),\r\n\r\n  payment_mode: paymentMode || \"\",\r\n\r\n  // split payment info\r\n  split_enabled: splitEnabled,\r\n  split1_amount: splitEnabled ? n(split1.amount) : 0,\r\n  split1_mode: splitEnabled ? split1.mode : \"\",\r\n  split1_ref: splitEnabled ? split1.ref : \"\",\r\n  split2_amount: splitEnabled ? n(split2.amount) : 0,\r\n  split2_mode: splitEnabled ? split2.mode : \"\",\r\n  split2_ref: splitEnabled ? split2.ref : \"\",\r\n\r\n  // some useful extra buyer meta (optional but nice for reports)\r\n  buyer_gstin: buyer.gstin || \"\",\r\n  buyer_mobile: buyer.mobile || \"\", \r\n  buyer_state: buyer.state || \"\",\r\n  buyer_state_code: buyer.stateCode || \"\",\r\n\r\n  // line items for sale_lines table\r\n  items: computed.rows.map((r) => ({\r\n    item_name: r.itemName,\r\n    hsn: r.hsn || \"\",\r\n    qty: Number(r.qty || 0),\r\n    unit: r.unit || \"KG\",\r\n    price: Number(r.rate || 0),\r\n    gst: Number(r.gstRate || r.gst || 0),\r\n  })),\r\n};\r\n\r\n\r\n            try {\r\n              const resp = await apiCreateSaleFIFO(salePayload);\r\n              // Optional: you can log / show resp.sale_id, resp.total_amount, etc.\r\n              console.log(\"Sale created (FIFO):\", resp);\r\n            } catch (e) {\r\n              console.error(\"Error creating sale via FIFO:\", e);\r\n              alert(\r\n                \"Failed to create sale in database (FIFO).\\n\" +\r\n                  (e?.message || e)\r\n              );\r\n              return;\r\n            }\r\n\r\n            // 2) Local storage copy (for your own dashboard/history)\r\n            const bill = {\r\n              id: Date.now(),\r\n               account_id: selectedAccount.account_id,\r\n  account_name: selectedAccount.name,\r\n  account_mobile: selectedAccount.mobile || buyer.mobile || \"\",\r\n              company,\r\n              buyer,\r\n              consignee: consigneeDifferent ? consignee : buyer,\r\n              invMeta,\r\n              lines,\r\n              computed,\r\n              discountPct,\r\n              advance,\r\n              paymentMode,\r\n              payments: {\r\n                splitEnabled,\r\n                split1: splitEnabled\r\n                  ? {\r\n                      amount: n(split1.amount),\r\n                      mode: split1.mode,\r\n                      ref: split1.ref,\r\n                    }\r\n                  : null,\r\n                split2: splitEnabled\r\n                  ? {\r\n                      amount: n(split2.amount),\r\n                      mode: split2.mode,\r\n                      ref: split2.ref,\r\n                    }\r\n                  : null,\r\n                paidNow,\r\n                balance: balanceAfterSplits,\r\n              },\r\n              createdAt: new Date().toISOString(),\r\n            };\r\n            const arr = JSON.parse(\r\n              localStorage.getItem(\"bills.v2\") || \"[]\"\r\n            );\r\n            arr.push(bill);\r\n            localStorage.setItem(\"bills.v2\", JSON.stringify(arr));\r\n\r\n            // 3) Export + Print\r\n            exportExcel();\r\n            printNow();\r\n          }}\r\n        >\r\n          Save\r\n        </button>\r\n\r\n        <button className=\"btn primary\" onClick={printNow}>\r\n          Print\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}